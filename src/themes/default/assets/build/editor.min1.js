!function t(e,n,i){function a(r,s){if(!n[r]){if(!e[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};e[r][0].call(u.exports,function(t){var n=e[r][1][t];return a(n?n:t)},u,u.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t,e,n){!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof e&&e.exports?e.exports=n():t.resemble=n()}(this,function(){"use strict";function t(t,e){return(Math.abs(t.r-e.r)+Math.abs(t.g-e.g)+Math.abs(t.b-e.b))/3}var e=1,n={red:255,green:0,blue:255,alpha:255},i={flat:function(t,e){return{r:n.red,g:n.green,b:n.blue,a:n.alpha}},movement:function(t,e){return{r:(e.r*(n.red/255)+n.red)/2,g:(e.g*(n.green/255)+n.green)/2,b:(e.b*(n.blue/255)+n.blue)/2,a:e.a}},flatDifferenceIntensity:function(e,i){return{r:n.red,g:n.green,b:n.blue,a:t(e,i)}},movementDifferenceIntensity:function(e,i){var a=t(e,i)/255*.8;return{r:(1-a)*(i.r*(n.red/255))+a*n.red,g:(1-a)*(i.g*(n.green/255))+a*n.green,b:(1-a)*(i.b*(n.blue/255))+a*n.blue,a:i.a}}},a=i.flat,o=1200,r=/^https?:\/\//,s="undefined"!=typeof window?window.document:{},l=new RegExp("^https?://"+s.domain),c=function(t){function n(){var t,e=T.length;for(t=0;e>t;t++)"function"==typeof T[t]&&T[t](N)}function i(t,e,n){var i,a;for(i=0;t>i;i++)for(a=0;e>a;a++)n(i,a)}function c(t,e,a){var o=0,r=0,s=0,l=0,c=0;i(a,e,function(n,i){var a=4*(n*e+i),u=t[a],h=t[a+1],d=t[a+2],f=p(u,h,d);o++,r+=u/255*100,s+=h/255*100,l+=d/255*100,c+=f/255*100}),N.red=Math.floor(r/o),N.green=Math.floor(s/o),N.blue=Math.floor(l/o),N.brightness=Math.floor(c/o),n()}function u(t,e){var n,i=new Image;"string"==typeof t&&t.length>6&&":"===t.charAt(4)&&"/"!==t.charAt(5)||r.test(t)&&!l.test(t)&&i.setAttribute("crossorigin","anonymous"),i.onerror=function(){i.onerror=null,A.push({error:"Image load error."}),e()},i.onload=function(){i.onload=null;var t,n=s.createElement("canvas");F&&1==A.length&&(i.width=A[0].width,i.height=A[0].height);var a=i.width,o=i.height;n.width=a,n.height=o,n.getContext("2d").drawImage(i,0,0,a,o),t=n.getContext("2d").getImageData(0,0,a,o),A.push(t),e(t,a,o)},"string"==typeof t?(i.src=t,i.complete&&i.naturalWidth>0&&i.onload()):"undefined"!=typeof t.data&&"number"==typeof t.width&&"number"==typeof t.height?(A.push(t),e(t,t.width,t.height)):(n=new FileReader,n.onload=function(t){i.src=t.target.result},n.readAsDataURL(t))}function h(t,e,n){var i=Math.abs(t-e);return"undefined"==typeof t?!1:"undefined"==typeof e?!1:t===e?!0:i<V[n]?!0:!1}function d(t,e){var n=h(t.a,e.a,"alpha"),i=h(t.brightness,e.brightness,"minBrightness");return i&&n}function p(t,e,n){return.3*t+.59*e+.11*n}function f(t,e){var n=t.r===e.r,i=t.g===e.g,a=t.b===e.b;return n&&i&&a}function m(t,e){var n=h(t.r,e.r,"red"),i=h(t.g,e.g,"green"),a=h(t.b,e.b,"blue"),o=h(t.a,e.a,"alpha");return n&&i&&a&&o}function g(t,e){return Math.abs(t.brightness-e.brightness)>V.maxBrightness}function v(t,e,n){t/=255,e/=255,n/=255;var i,a,o=Math.max(t,e,n),r=Math.min(t,e,n);if(o==r)i=0;else{switch(a=o-r,o){case t:i=(e-n)/a+(n>e?6:0);break;case e:i=(n-t)/a+2;break;case n:i=(t-e)/a+4}i/=6}return i}function b(t,e,n,i,a,o){var r,s,l,c,u=1,h=0,d=0,p=0;for(E(t),l=-1*u;u>=l;l++)for(c=-1*u;u>=c;c++)if(0===l&&0===c);else{if(r=4*((i+c)*o+(a+l)),s=x(e,r,n),null===s)continue;if(k(s),E(s),g(t,s)&&h++,f(t,s)&&p++,Math.abs(s.h-t.h)>.3&&d++,d>1||h>1)return!0}return 2>p?!0:!1}function y(t,e,n,i){var o=a(n,i);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]=o.a}function _(t,n,i){t[n]=i.r,t[n+1]=i.g,t[n+2]=i.b,t[n+3]=i.a*e}function w(t,n,i){t[n]=i.brightness,t[n+1]=i.brightness,t[n+2]=i.brightness,t[n+3]=i.a*e}function x(t,e,n){var i,a,o,r,s;return i=t[e],"undefined"!=typeof i?(a=t[e+1],o=t[e+2],s=t[e+3],r={r:i,g:a,b:o,a:s}):null}function k(t){t.brightness=p(t.r,t.g,t.b)}function E(t){t.h=v(t.r,t.g,t.b)}function I(t,e,n,a){var r=s.createElement("canvas"),l=t.data,c=e.data;r.width=n,r.height=a;var u,h=r.getContext("2d"),p=h.createImageData(n,a),f=p.data,g=0,v={top:a,left:n,bottom:0,right:0},E=function(t,e){v.left=Math.min(t,v.left),v.right=Math.max(t,v.right),v.top=Math.min(e,v.top),v.bottom=Math.max(e,v.bottom)},I=Date.now();o&&D&&(n>o||a>o)&&(u=6),i(a,n,function(t,e){if(!u||t%u!==0&&e%u!==0){var i=4*(t*n+e),a=x(l,i,1),o=x(c,i,2);if(null!==a&&null!==o)return z?(k(a),k(o),void(d(a,o)?w(f,i,o):(y(f,i,a,o),g++,E(e,t)))):void(m(a,o)?_(f,i,a,o):D&&(k(a),k(o),b(a,l,1,t,e,n)||b(o,c,2,t,e,n))&&d(a,o)?w(f,i,o):(y(f,i,a,o),g++,E(e,t)))}}),N.rawMisMatchPercentage=g/(a*n)*100,N.misMatchPercentage=N.rawMisMatchPercentage.toFixed(2),N.diffBounds=v,N.analysisTime=Date.now()-I,N.getImageDataUrl=function(t){var e=0;return t&&(e=C(t,h,r)),h.putImageData(p,0,e),r.toDataURL("image/png")}}function C(t,e,n){var i=2;e.font="12px sans-serif";var a=e.measureText(t).width+2*i,o=22;return a>n.width&&(n.width=a),n.height+=o,e.fillStyle="#666",e.fillRect(0,0,n.width,o-4),e.fillStyle="#fff",e.fillRect(0,o-4,n.width,4),e.fillStyle="#fff",e.textBaseline="top",e.font="12px sans-serif",e.fillText(t,i,1),o}function S(t,e,n){var i,a;return t.height<n||t.width<e?(i=s.createElement("canvas"),i.width=e,i.height=n,a=i.getContext("2d"),a.putImageData(t,0,0),a.getImageData(0,0,e,n)):t}function $(t,e){function i(){var t,e;if(2===A.length){if(A[0].error||A[1].error)return N={},N.error=A[0].error?A[0].error:A[1].error,void n();t=A[0].width>A[1].width?A[0].width:A[1].width,e=A[0].height>A[1].height?A[0].height:A[1].height,A[0].width===A[1].width&&A[0].height===A[1].height?N.isSameDimensions=!0:N.isSameDimensions=!1,N.dimensionDifference={width:A[0].width-A[1].width,height:A[0].height-A[1].height},I(S(A[0],t,e),S(A[1],t,e),t,e),n()}}A=[],u(t,i),u(e,i)}function M(e){var n,i="function"==typeof e;i||(n=e);var a={scaleToSameSize:function(){return F=!0,i&&e(),a},useOriginalSize:function(){return F=!1,i&&e(),a},ignoreNothing:function(){return V.red=0,V.green=0,V.blue=0,V.alpha=0,V.minBrightness=0,V.maxBrightness=255,D=!1,z=!1,i&&e(),a},ignoreAntialiasing:function(){return V.red=32,V.green=32,V.blue=32,V.alpha=32,V.minBrightness=64,V.maxBrightness=96,D=!0,z=!1,i&&e(),a},ignoreColors:function(){return V.alpha=16,V.minBrightness=16,V.maxBrightness=240,D=!1,z=!0,i&&e(),a},repaint:function(){return i&&e(),a},onComplete:function(e){T.push(e);var i=function(){$(t,n)};return i(),M(i)}};return a}var N={},A=[],T=[],V={red:16,green:16,blue:16,alpha:16,minBrightness:16,maxBrightness:240},D=!1,z=!1,F=!1;return{onComplete:function(e){T.push(e),u(t,function(t,e,n){c(t.data,e,n)})},compareTo:function(t){return M(t)}}};return c.outputSettings=function(t){var r,s;if(t.errorColor)for(r in t.errorColor)n[r]=t.errorColor[r]===s?n[r]:t.errorColor[r];return t.errorType&&i[t.errorType]&&(a=i[t.errorType]),e=isNaN(Number(t.transparency))?e:t.transparency,t.largeImageThreshold!==s&&(o=t.largeImageThreshold),this},c})},{}],2:[function(t,e,n){!function(){function t(e,i){if(e=e?e:"",i=i||{},e instanceof t)return e;if(!(this instanceof t))return new t(e,i);var a=n(e);this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=P(100*this._a)/100,this._format=i.format||a.format,this._gradientType=i.gradientType,this._r<1&&(this._r=P(this._r)),this._g<1&&(this._g=P(this._g)),this._b<1&&(this._b=P(this._b)),this._ok=a.ok,this._tc_id=B++}function n(t){var e={r:0,g:0,b:0},n=1,a=!1,r=!1;return"string"==typeof t&&(t=D(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=i(t.r,t.g,t.b),a=!0,r="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=A(t.s),t.v=A(t.v),e=s(t.h,t.s,t.v),a=!0,r="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=A(t.s),t.l=A(t.l),e=o(t.h,t.s,t.l),a=!0,r="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=E(n),{ok:a,format:t.format||r,r:O(255,R(e.r,0)),g:O(255,R(e.g,0)),b:O(255,R(e.b,0)),a:n}}function i(t,e,n){return{r:255*I(t,255),g:255*I(e,255),b:255*I(n,255)}}function a(t,e,n){t=I(t,255),e=I(e,255),n=I(n,255);var i,a,o=R(t,e,n),r=O(t,e,n),s=(o+r)/2;if(o==r)i=a=0;else{var l=o-r;switch(a=s>.5?l/(2-o-r):l/(o+r),o){case t:i=(e-n)/l+(n>e?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:a,l:s}}function o(t,e,n){function i(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+(e-t)*(2/3-n)*6:t}var a,o,r;if(t=I(t,360),e=I(e,100),n=I(n,100),0===e)a=o=r=n;else{var s=.5>n?n*(1+e):n+e-n*e,l=2*n-s;a=i(l,s,t+1/3),o=i(l,s,t),r=i(l,s,t-1/3)}return{r:255*a,g:255*o,b:255*r}}function r(t,e,n){t=I(t,255),e=I(e,255),n=I(n,255);var i,a,o=R(t,e,n),r=O(t,e,n),s=o,l=o-r;if(a=0===o?0:l/o,o==r)i=0;else{switch(o){case t:i=(e-n)/l+(n>e?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:a,v:s}}function s(t,e,n){t=6*I(t,360),e=I(e,100),n=I(n,100);var i=K.floor(t),a=t-i,o=n*(1-e),r=n*(1-a*e),s=n*(1-(1-a)*e),l=i%6,c=[n,r,o,o,s,n][l],u=[s,n,n,r,o,o][l],h=[o,o,s,n,n,r][l];return{r:255*c,g:255*u,b:255*h}}function l(t,e,n,i){var a=[N(P(t).toString(16)),N(P(e).toString(16)),N(P(n).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function c(t,e,n,i){var a=[N(T(i)),N(P(t).toString(16)),N(P(e).toString(16)),N(P(n).toString(16))];return a.join("")}function u(e,n){n=0===n?0:n||10;var i=t(e).toHsl();return i.s-=n/100,i.s=C(i.s),t(i)}function h(e,n){n=0===n?0:n||10;var i=t(e).toHsl();return i.s+=n/100,i.s=C(i.s),t(i)}function d(e){return t(e).desaturate(100)}function p(e,n){n=0===n?0:n||10;var i=t(e).toHsl();return i.l+=n/100,i.l=C(i.l),t(i)}function f(e,n){n=0===n?0:n||10;var i=t(e).toRgb();return i.r=R(0,O(255,i.r-P(255*-(n/100)))),i.g=R(0,O(255,i.g-P(255*-(n/100)))),i.b=R(0,O(255,i.b-P(255*-(n/100)))),t(i)}function m(e,n){n=0===n?0:n||10;var i=t(e).toHsl();return i.l-=n/100,i.l=C(i.l),t(i)}function g(e,n){var i=t(e).toHsl(),a=(P(i.h)+n)%360;return i.h=0>a?360+a:a,t(i)}function v(e){var n=t(e).toHsl();return n.h=(n.h+180)%360,t(n)}function b(e){var n=t(e).toHsl(),i=n.h;return[t(e),t({h:(i+120)%360,s:n.s,l:n.l}),t({h:(i+240)%360,s:n.s,l:n.l})]}function y(e){var n=t(e).toHsl(),i=n.h;return[t(e),t({h:(i+90)%360,s:n.s,l:n.l}),t({h:(i+180)%360,s:n.s,l:n.l}),t({h:(i+270)%360,s:n.s,l:n.l})]}function _(e){var n=t(e).toHsl(),i=n.h;return[t(e),t({h:(i+72)%360,s:n.s,l:n.l}),t({h:(i+216)%360,s:n.s,l:n.l})]}function w(e,n,i){n=n||6,i=i||30;var a=t(e).toHsl(),o=360/i,r=[t(e)];for(a.h=(a.h-(o*n>>1)+720)%360;--n;)a.h=(a.h+o)%360,r.push(t(a));return r}function x(e,n){n=n||6;for(var i=t(e).toHsv(),a=i.h,o=i.s,r=i.v,s=[],l=1/n;n--;)s.push(t({h:a,s:o,v:r})),r=(r+l)%1;return s}function k(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function E(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function I(t,e){$(t)&&(t="100%");var n=M(t);return t=O(e,R(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),K.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function C(t){return O(1,R(0,t))}function S(t){return parseInt(t,16)}function $(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function M(t){return"string"==typeof t&&-1!=t.indexOf("%")}function N(t){return 1==t.length?"0"+t:""+t}function A(t){return 1>=t&&(t=100*t+"%"),t}function T(t){return Math.round(255*parseFloat(t)).toString(16)}function V(t){return S(t)/255}function D(t){t=t.replace(F,"").replace(L,"").toLowerCase();var e=!1;if(U[t])t=U[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=G.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=G.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=G.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=G.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=G.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=G.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=G.hex8.exec(t))?{a:V(n[1]),r:S(n[2]),g:S(n[3]),b:S(n[4]),format:e?"name":"hex8"}:(n=G.hex6.exec(t))?{r:S(n[1]),g:S(n[2]),b:S(n[3]),format:e?"name":"hex"}:(n=G.hex3.exec(t))?{r:S(n[1]+""+n[1]),g:S(n[2]+""+n[2]),b:S(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function z(t){var e,n;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA"),"small"!==n&&"large"!==n&&(n="small"),{level:e,size:n}}var F=/^\s+/,L=/\s+$/,B=0,K=Math,P=K.round,O=K.min,R=K.max,H=K.random;t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,i,a,o,r=this.toRgb();return t=r.r/255,e=r.g/255,n=r.b/255,i=.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4),a=.03928>=e?e/12.92:Math.pow((e+.055)/1.055,2.4),o=.03928>=n?n/12.92:Math.pow((n+.055)/1.055,2.4),.2126*i+.7152*a+.0722*o},setAlpha:function(t){return this._a=E(t),this._roundA=P(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=P(360*t.h),n=P(100*t.s),i=P(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+i+"%)":"hsva("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=a(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=a(this._r,this._g,this._b),e=P(360*t.h),n=P(100*t.s),i=P(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+i+"%)":"hsla("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return l(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return c(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:P(this._r),g:P(this._g),b:P(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+P(this._r)+", "+P(this._g)+", "+P(this._b)+")":"rgba("+P(this._r)+", "+P(this._g)+", "+P(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:P(100*I(this._r,255))+"%",g:P(100*I(this._g,255))+"%",b:P(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+P(100*I(this._r,255))+"%, "+P(100*I(this._g,255))+"%, "+P(100*I(this._b,255))+"%)":"rgba("+P(100*I(this._r,255))+"%, "+P(100*I(this._g,255))+"%, "+P(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:j[l(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+c(this._r,this._g,this._b,this._a),i=n,a=this._gradientType?"GradientType = 1, ":"";if(e){var o=t(e);i=o.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+n+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!e&&i&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return a?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(m,arguments)},desaturate:function(){return this._applyModification(u,arguments)},saturate:function(){return this._applyModification(h,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(g,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(v,arguments)},monochromatic:function(){return this._applyCombination(x,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(y,arguments)}},t.fromRatio=function(e,n){if("object"==typeof e){var i={};for(var a in e)e.hasOwnProperty(a)&&("a"===a?i[a]=e[a]:i[a]=A(e[a]));e=i}return t(e,n)},t.equals=function(e,n){return e&&n?t(e).toRgbString()==t(n).toRgbString():!1},t.random=function(){return t.fromRatio({r:H(),g:H(),b:H()})},t.mix=function(e,n,i){i=0===i?0:i||50;var a,o=t(e).toRgb(),r=t(n).toRgb(),s=i/100,l=2*s-1,c=r.a-o.a;a=l*c==-1?l:(l+c)/(1+l*c),a=(a+1)/2;var u=1-a,h={r:r.r*a+o.r*u,g:r.g*a+o.g*u,b:r.b*a+o.b*u,a:r.a*s+o.a*(1-s)};return t(h)},t.readability=function(e,n){var i=t(e),a=t(n);return(Math.max(i.getLuminance(),a.getLuminance())+.05)/(Math.min(i.getLuminance(),a.getLuminance())+.05)},t.isReadable=function(e,n,i){var a,o,r=t.readability(e,n);switch(o=!1,a=z(i),a.level+a.size){case"AAsmall":case"AAAlarge":o=r>=4.5;break;case"AAlarge":o=r>=3;break;case"AAAsmall":o=r>=7}return o},t.mostReadable=function(e,n,i){var a,o,r,s,l=null,c=0;i=i||{},o=i.includeFallbackColors,r=i.level,s=i.size;for(var u=0;u<n.length;u++)a=t.readability(e,n[u]),a>c&&(c=a,l=t(n[u]));return t.isReadable(e,l,{level:r,size:s})||!o?l:(i.includeFallbackColors=!1,t.mostReadable(e,["#fff","#000"],i))};var U=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},j=t.hexNames=k(U),G=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",a="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof e&&e.exports?e.exports=t:"function"==typeof define&&define.amd?define(function(){return t}):window.tinycolor=t}()},{}],3:[function(t,e,n){var i=t("./facade/design/design");e.exports=function(){function t(){function t(t,n){var i=$("#"+n.id)[0];i&&e(i,t)}i.on("image.create.optimize_resolution",_.partial(t,!0)),i.on("image.create.resize_external",_.partial(t,!0)),i.on("image.create.source.url",_.partial(t,!1)),i.on("image.create.optimus_resolution",_.partial(t,!1)),i.on("image.update.optimize_resolution",_.partial(t,!0)),i.on("image.update.resize_external",_.partial(t,!0)),i.on("image.update.source.url",_.partial(t,!1)),i.on("image.update.optimus_resolution",_.partial(t,!1))}function e(t,e){function i(){var t=r.attr("id")+"-loader";l=$("<div>").attr("id",t).addClass("svg-loader").append($("<div>").addClass("animation")).appendTo("#content"),r.data("svg-loader",l),r.on("change, move",o),s[r.attr("id")]=r}var r=$(t),l=a(r);return e?(l||i(),void o.call(t)):void n(r)}function n(t){var e=a(t);t.removeData("svg-loader"),t.off("change, move",o),e&&e.remove(),s=_.omit(s,t.attr("id"))}function a(t){return t.data("svg-loader")}function o(){var t=this;if(INKIVE.C.IS_MOBILE){var e=a($(t));e.css("display","none"),l(t)}else r(t)}function r(t){function e(){var t=$("#canvasBackground").offset();s=t.top,l=t.left}function n(){var e=$(t).attr("transform"),n=/translate\((-?[\d|.]+),(-?[\d|.]+)\)/g;e&&e.replace(n,function(t,e,n){s+=parseInt(n)*c,l+=parseInt(e)*c})}function i(){s+=u.y*c,l+=u.x*c}function o(){var t=5,e=-28;r.children(".animation").css({top:0+t,left:u.width*c+e})}var r=a($(t));if(t&&r){r.css("display","block");var s=0,l=0,c=INKIVE.EditorFacade.handle("zoom","get"),u=svgedit.utilities.getBBox(t);e(),n(),i(),r.css({top:s,left:l,width:u.width*c,height:u.height*c});var h=svgedit.utilities.getRotationAngle(t);h&&r.css("transform","rotate("+h+"deg)"),o()}}var s={},l=_.debounce(r,600);return{toggle:e,initialize:t,show:function(t){e(t,!0)},hide:function(t){e(t,!1)},hideAll:function(){_.each(s,n)}}}()},{"./facade/design/design":19}],4:[function(t,e,n){function i(t,e){if(!_.contains(s,e)&&t){if(!_.isFunction(t)){var n=o[e];t=function(){this.trackEvent(n)}}this[e]=_.partial(a,t,r.prototype[e])}}function a(t,e){var n=_.rest(arguments,2);t.apply(this,n),e.apply(this,n)}var o,r,s=["eventCategory","eventAction","eventLabel","eventValue","fieldsObject"];e.exports=function(t,e){r=e,o=t;var n={trackEvent:function(e){var n={hitType:"event"};_.each(s,function(e){t[e]&&(n[e]=t[e])}),INKIVE.C.IS_DEV||"undefined"!=typeof ga&&ga("send",_.extend(n,e)),INKIVE.C.IS_DEV&&console.log(_.extend(n,e))}};return _.each(o,i,n),e.extend?e.extend(n):_.extend({},e,n)}},{}],5:[function(t,e,n){INKIVE.C.IS_DEV||window.addEventListener("error",function(t){var e=t.filename+" ["+t.lineno+"]: "+t.message;ga("send","exception",{exDescription:e})},!1)},{}],6:[function(t,e,n){function i(){this.version=t("./version"),this.util=INKIVE.Helpers,_.bindAll(this,"propagate")}function a(t,e){var n=t.match(/(\w+)\.get\.svg_(\d+)/)?t:r.camelize(t);n=s.androidMethodName(n),e=s.androidParameters(_.extend({cmd:n},{params:e})),INKIVE.C.IS_DEV&&console.log("Calling Android "+n+", version "+l.version.get()+(l.version.isLowerThan("1.0.3")?" (lower than 1.0.3)":"(greater than 1.0.2)")),l.version.isLowerThan("1.0.3")?Android[n].apply(window.Android,e):Android.trigger(JSON.stringify(e))}function o(t,e){var n=t.match(/(\w+)\.get\.svg_(\d+)/)?t:r.camelize(t);n=s.iosMethodName(n),INKIVE.C.IS_DEV&&console.log("Calling iOS "+n),c.Trigger(s.iosParameters(_.extend({cmd:n},{params:e})))}var r=t("../utils/humps"),s=t("./legacy-support");i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=function(){function e(){var e=this.propagate,n=t("../factory/shapes");this.factories={shapes:{get:function(){n.get.apply(n,arguments).then(_.partial(e,"factory","shapes_data"))},getCategories:function(){n.getCategories().then(_.partial(e,"factory","shapes_categories"))}}}}function n(){var e=t("../facade/project/project");e.on("all",_.partial(this.propagate,"project")),this.project={call:e.handle}}function i(){var e=t("../facade/design/design");e.on("all",_.partial(this.propagate,"design")),this.design={set:e.set,create:e.create,call:function(){var t=e.handle.apply(e,arguments);return window.Android?void l.propagate("design","call",t):JSON.stringify(t)},get:function(t,n){var i=e.get.apply(e,arguments);if(!window.Android)return JSON.stringify(i);var a="get";l.version.isLowerThan("1.1.3")||(a+="."+t,a+=n?"."+n:""),l.propagate("design",a,i)}}}function a(){var e=t("../utils/advice"),n=t("../facade/editor/editor"),i=t("../factory/images");e.on("all",_.partial(this.propagate,"editor.advice")),n.on("all",_.partial(this.propagate,"editor")),this.editor={setImagesData:_.bind(i.setImagesData,i),call:function(){var t=n.handle.apply(n,arguments);return window.Android?void l.propagate("editor","call",t):JSON.stringify(t)},get:function(t,e){var i=n.get.apply(n,arguments);if(!window.Android)return JSON.stringify(i);var a="get";l.version.isLowerThan("1.1.3")||(a+="."+t,a+=e?"."+e:""),l.propagate("editor",a,i)}}}function o(){function e(t,n){var a=_.isObject(t);a?_.each(t,function(t,i){e(t,n?n+"."+i:i)}):i[n]=t}var n=t("./support.json"),i={};window.Android?(e(n.element),this.getSupported=function(){l.propagate("supported","get",JSON.stringify({element:i,fonts:INKIVE.C.FONT_LIST}))}):this.supported=JSON.stringify(_.extend(n,{fonts:INKIVE.C.FONT_LIST}))}s.supportsDesignFacade(this)&&i.call(this),s.supportsEditorFacade(this)&&a.call(this),s.supportsProjectFacade(this)&&n.call(this),e.call(this),o.call(this),s.events(this)},i.prototype.propagate=function(t,e,n){INKIVE.C.IS_DEV&&console.log("Bridge triggering: "+t+"."+e,n),this.callBoth(t+"."+e,n)},i.prototype.callBoth=function(t,e){return INKIVE.C.IS_DEV&&console.log("AppBridge: call"),INKIVE.C.IS_MOBILE_APP?(window.Android&&a(t,e),window.Android||o(t,e),!0):!1},i.prototype.callIOS=function(t,e){var n=INKIVE.C.IS_MOBILE_APP&&!window.Android;return n&&o(t,e),n},i.prototype.callAndroid=function(t,e){var n=INKIVE.C.IS_MOBILE_APP&&window.Android;return n&&a(t,e),n};var l=new i;e.exports=l;var c={Trigger:function(t){var e=$('<iframe src="inkive://www.awesome.com/notyourbusiness.php?event='+encodeURIComponent(JSON.stringify(t))+'" width="0" height="0" border="0" style="display:none;" ></iframe>').appendTo("body");setTimeout(function(){e.remove()},1e3)}}},{"../facade/design/design":19,"../facade/editor/editor":45,"../facade/project/project":56,"../factory/images":66,"../factory/shapes":80,"../utils/advice":318,"../utils/humps":323,"./legacy-support":8,"./support.json":9,"./version":10}],7:[function(t,e,n){function i(t,e){var n=e.match(/Check$/)||e.match(/CheckOnce$/);if(!n){var i=o[e+"Check"],s=o[e+"CheckOnce"];s?s.call(this)&&(this[e]=t):i?this[e]=_.partial(a,i,t,r.prototype[e]):this[e]=t}}function a(t,e,n){var i=t.call(this);i&&e.apply(this,_.rest(arguments,3)),i||n&&n.apply(this,_.rest(arguments,3))}var o,r;e.exports=function(e,n){if(INKIVE.C.IS_MOBILE_APP){r=n,o=e;var a={appBridge:t("./bridge")};return _.each(o,i,a),n.extend?n.extend(a):_.extend({},n,a)}return n}},{"./bridge":6}],8:[function(t,e,n){function i(e,n){var i=t("./bridge"),a=_.where(e,{funcName:n});return _.any(a,function(t){return i.version.isLowerThan(t.usedBefore)?(console.log("We will use: "+t.oldName),n=t.oldName,!0):void 0}),n}function a(e,n){var i=t("./bridge"),a=_.where(e,{funcName:n.cmd});return _.any(a,function(t){return i.version.isLowerThan(t.usedBefore)?(n=t.map(n),!0):void 0}),n}var o={android:[],ios:[{funcName:"sendFacebookCredentials",oldName:"auth_facebook",usedBefore:"1.1.2"},{funcName:"sendInstagramCredentials",oldName:"auth_instagram",usedBefore:"1.1.2"},{funcName:"editorLoaded",oldName:"editor_loaded",usedBefore:"1.1.2"},{funcName:"showTeam",oldName:"show_team",usedBefore:"1.1.2"},{funcName:"catchFile",oldName:"catch_file",usedBefore:"1.1.2"},{funcName:"closeEditor",oldName:"close_overlay",usedBefore:"1.1.2"},{funcName:"shareWithFb",oldName:"share_with_fb",usedBefore:"1.1.2"},{funcName:"design.template.update",oldName:"design.template.updated",usedBefore:"1.2"},{funcName:"design.template.update.designed",oldName:"design.template.updated.designed",usedBefore:"1.2"}]},r={ios:[{funcName:"openInNewWindow",usedBefore:"1.1.2",map:function(t){return{cmd:t.cmd,url:t.params.url}}},{funcName:"editor_loaded",usedBefore:"1.1.2",map:function(t){return{cmd:t.cmd,book_id:t.params.book_id}}}],android:[{funcName:"catchFile",usedBefore:"1.0.3",map:function(t){return[t.params.url]}},{funcName:"photoUpload",usedBefore:"1.0.3",map:function(t){return[t.params.size_name]}},{funcName:"editorLoaded",usedBefore:"1.0.3",map:function(t){return[t.params.book_id]}},{funcName:"showTeam",usedBefore:"1.0.3",map:function(t){return[t.params.x,t.params.y]}}]};e.exports={androidMethodName:_.partial(i,o.android),iosMethodName:_.partial(i,o.ios),androidParameters:_.partial(a,r.android),iosParameters:_.partial(a,r.ios),supportsDesignFacade:function(t){return window.Android&&t.version.isGreaterThan("1.0.2")||!window.Android&&t.version.isGreaterThan("1.1.1")},supportsEditorFacade:function(t){return window.Android&&!t.version.isLowerThan("1.1")||!window.Android&&!t.version.isLowerThan("1.2")},supportsProjectFacade:function(t){return window.Android&&!t.version.isLowerThan("1.1")||!window.Android&&!t.version.isLowerThan("1.2")},events:function(t){var e=(window.Android&&t.version.isLowerThan("1.0.4")||!window.Android&&t.version.isLowerThan("1.1.2"),$("#ik-editor"));t.on=_.bind(e.on,e),t.off=_.bind(e.off,e),t.once=_.bind(e.one,e),t.trigger=_.bind(e.trigger,e)}}},{"./bridge":6}],9:[function(t,e,n){e.exports={element:{"default":{duplicate:!0,remove:!0,unlock:!0,lock:!0,deselect:!0,rotate:!0,opacity:!0,resize:!0,send:{forward:!0,backward:!0}},text:{content:!0,fontfamily:!0,fontsize:!0,color:!0,bold:!0,italic:!0,underline:!0,bullets:!0,align:{left:!0,center:!0,right:!0,full:!0},spacing:{line:!0,word:!0,letter:!0},link:!1,unlink:!1},image:{crop:!0,filter:!0,lock_image:!0,unlock_image:!0,link:!1,unlink:!1},sticker:{fill:{color:!0},stroke:{color:!1,width:!1},flip:{horizontal:!0,vertical:!0},link:!1,unlink:!1},group:{ungroup:!0,link:!1,unlink:!1},multiselect:{duplicate:!0,remove:!0,group:!0},shape:{fill:{color:!0},stroke:{color:!0,width:!0},flip:{horizontal:!0,vertical:!0},image_box:!0,link:!1,unlink:!1}}}},{}],10:[function(t,e,n){function i(t,e){if(typeof t+typeof e!="stringstring")return!1;for(var n=t.split("."),i=e.split("."),a=0,o=Math.max(n.length,i.length);o>a;a++){if(n[a]&&!i[a]&&parseInt(n[a])>0||parseInt(n[a])>parseInt(i[a]))return 1;if(i[a]&&!n[a]&&parseInt(i[a])>0||parseInt(n[a])<parseInt(i[a]))return-1}return 0}var a,o=t("../utils/cookie-storage");e.exports={isEqual:function(t){return a=a||o.get("ver"),0===i(t,a)},isLowerThan:function(t){return a=a||o.get("ver"),i(t,a)>0},isGreaterThan:function(t){return a=a||o.get("ver"),
i(t,a)<0},get:function(){return a||o.get("ver")}}},{"../utils/cookie-storage":321}],11:[function(t,e,n){function i(){this.handlers={}}var a=t("../../utils/humps");i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=function(){_.bindAll(this,"propagate","handle"),this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,_.each(this.handlers,function(t,e){t.initialize(),t.on("all",_.partial(this.propagate,e))},this)},i.prototype.handle=function(t,e,n){function i(t,e){this.handlers[t]&&_.isFunction(this.handlers[t][o])&&(e||this.handlers[t][o](n),e&&this.handlers[t][o](e,n))}var o=a.camelize(t);if(_.isString(t)&&_.isFunction(this[o]))return this[o](e);if(e){if(o=a.camelize(e),_.isString(t)&&this.handlers[t]&&_.isFunction(this.handlers[t][o]))return this.handlers[t][o](n);if(_.isString(t)&&_.isFunction(this[o]))return this[o](t)}if(_.isString(e)||n){var r=$("#"+t)[0],s=this.handlers[t]?t:this.getType(r);return i.call(this,s,r)}n=e;var l=_.toArray(this.canvas.getSelectedElems());_.each(l,function(t){i.call(this,this.getType(t),t)},this),this.canvas.selectOnly(l)},i.prototype.propagate=function(t,e,n){this.trigger(t+"."+e,n)},i.prototype.getType=function(t){return t?$(t).is(".textarea")?"text":$(t).is(".sticker")?"sticker":$(t).is(".group")?"group":"image"===t.nodeName?$(t).parent().is(".clipperImage")?"imageclipper":"image":"shape":void 0},i.prototype.trigger=function(t,e){if(INKIVE.C.IS_DEV){var n=new Date;n=n.getHours()+":"+n.getMinutes()+":"+n.getSeconds(),console.log(n+": "+t,e)}Backbone.Events.trigger.apply(this,arguments)},e.exports=i},{"../../utils/humps":323}],12:[function(t,e,n){function i(){}e.exports=i,i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=function(){this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,this.mandatory=[],this.defaults={position:{x:100,y:100},rotation:0,size:{width:100,height:100},opacity:1},_.bindAll(this,"create","getDefinedData")},i.prototype.getDefinedData=function(t,e){for(var n,i=e.split("."),a=this.defaults;i.length>0;)n=i.shift(),"undefined"!=typeof t&&(t=t[n]),"undefined"!=typeof a&&(a=a[n]);return"undefined"==typeof t?a:t}},{}],13:[function(t,e,n){function i(){}var a=t("./element");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),_.bindAll(this,"updateContent"),_.extend(this.defaults,{content:null})},i.prototype.updateContent=function(t,e){var n=Base64.decode(e.content),i=INKIVE.Helpers.getStickerFromString(n,e.sticker_id);if(i){var a=t.getAttribute("id");i.classList=_(t.classList).without("selected").join(" "),this.editor.replaceElement(t,i);var o=new svgedit.history.BatchCommand("Paste elements");o.addSubCommand(new svgedit.history.InsertElementCommand(i)),this.canvas.undoMgr.addCommandToHistory(o),this.trigger("delete",a);var r=i.getAttribute("id");this.trigger("",r),this.trigger("content",r,{content:e.content})}}},{"./element":12}],14:[function(t,e,n){function i(){}e.exports=i,i.prototype=_.extend({},Backbone.Events),i.prototype.constructor=i,i.prototype.initialize=function(){var t=INKIVE.Tool.getInstance().editor;this.canvas=t.canvas},i.prototype.create=function(){this.canvas.groupSelectedElements();var t=this.canvas.getSelectedElems()[0];this.trigger("",t.getAttribute("id"))}},{}],15:[function(t,e,n){function i(){}var a=t("./abstract/element"),o=t("../setters/image"),r=t("../../editor/editor"),s=t("../../../factory/images");e.exports=i,i.prototype=_.extend(new a,o.prototype),i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.mandatory=["source.url"],_.extend(this.defaults,{placeholder:!0,source:{url:INKIVE.C.BASE_URL+"assets/img/placeholders/imageplaceholder_new.svg",smart_load:!0,external_resize:!1}})},i.prototype.create=function(t){function e(){n&&this.resizeExternalSearchFoto(element,t),!n&&this.getDefinedData(t,"source.smart_load")&&this.onVersionData(element,t),this.trigger("",element.getAttribute("id"))}var n=this.getDefinedData(t,"source.external_resize"),i=this.getDefinedData(t,"placeholder");if(element=this.canvas.addElement("image",this.getAddData(t)),i){var a=element.getAttribute("id");r.once("image.rename."+a,_.bind(function(t){element=$("#"+t.id)[0],e.call(this)},this)),r.handle(a,"crop",{quiet:!0,scale:1})}else e.call(this)},i.prototype.onVersionData=function(t,e){s.storeImageData(e.source.url),o.prototype.onVersionData.apply(this,arguments)},i.prototype.getSize=function(t,e){return{width:this.getDefinedData(e,"size.width"),height:this.getDefinedData(e,"size.height")}},i.prototype.getAddData=function(t){var e=_.bind(this.getDefinedData,this,t);return{url:e("source.url"),x:e("position.x"),y:e("position.y"),width:e("size.width"),height:e("size.height")}}},{"../../../factory/images":66,"../../editor/editor":45,"../setters/image":38,"./abstract/element":12}],16:[function(t,e,n){function i(){}var a=t("./abstract/graphic"),o=t("../../editor/editor"),r=t("../../../factory/shapes"),s=t("../setters/abstract/element");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),_.extend(this.defaults,{shape_id:null})},i.prototype.create=function(t){t.content&&this._create(t),t.shape_id&&this.load(t)},i.prototype.load=function(t){var e=t.shape_id.split("_");r.get(e[0],e[1]).then(_.bind(function(e){t.content=e.path,this._create(t)},this))},i.prototype._create=function(t){var e=this.canvas.addSvgElementFromJson({element:"path",curStyles:!0,attr:this.getAddData(t)});this.setSize(e,t.size?t:{size:{width:this.getDefinedData(t,"size.width"),height:this.getDefinedData(t,"size.height")}}),this.setPosition(e,{position:{x:this.getDefinedData(t,"position.x"),y:this.getDefinedData(t,"position.y")}}),this.trigger("",e.getAttribute("id"))},i.prototype.setSize=s.prototype.updateSize,i.prototype.setPosition=function(t,e){var n=e.position,i=t.getBBox(),a=o.handle("zoom","get");this.canvas.clearSelection(),this.canvas.selectOnly([t]),this.canvas.moveSelectedElements((n.x-i.x)*a,(n.y-i.y)*a)},i.prototype.getAddData=function(t){return{d:t.content,id:this.canvas.getNextId(),opacity:this.getDefinedData(t,"opacity")}}},{"../../../factory/shapes":80,"../../editor/editor":45,"../setters/abstract/element":33,"./abstract/graphic":13}],17:[function(t,e,n){function i(){}var a=t("./abstract/graphic");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.mandatory=["sticker_id"],_.extend(this.defaults,{sticker_id:null,thumb_src:INKIVE.C.BASE_URL+"assets/img/placeholders/imageplaceholder_new.svg"})},i.prototype.create=function(t){var e=this.canvas.addElement("sticker",this.getAddData(t));t.content||this.fetchContent(e,t),t.content&&this.updateContent(e,t),this.trigger("",e.getAttribute("id"))},i.prototype.fetchContent=function(t,e){var n=_.partial(this.updateContent,t);INKIVE.Helpers.api("search/sticker","GET",{id:e.sticker_id},function(t){n(_.extend(e,{content:t.content}))})},i.prototype.getAddData=function(t){var e=_.bind(this.getDefinedData,this,t);return{x:e("position.x"),y:e("position.y"),url:e("thumb_src"),width:e("size.width"),height:e("size.height"),favouiritesId:t.sticker_id}}},{"./abstract/graphic":13}],18:[function(t,e,n){function i(){}var a=t("./abstract/element");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.mandatory=["text"],_.extend(this.defaults,{content:null,font:{family:"Lato",size:"21",weight:null,style:null},decoration:null})},i.prototype.create=function(t){var e=this.canvas.addElement("textarea",this.getAddData(t));this.trigger("",e.getAttribute("id"))},i.prototype.getAddData=function(t){var e=_.bind(this.getDefinedData,this,t);return{x:e("position.x"),y:e("position.y"),width:e("size.width"),text:{font_size:e("font.size"),font_family:e("font.family"),font_weight:e("font.weight"),font_style:e("font.style"),text_decoration:e("decoration"),textContent:e("content")}}}},{"./abstract/element":12}],19:[function(t,e,n){function i(){}var a=t("./facade");i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),_.bindAll(this,"set","get","create")},i.prototype["delete"]=function(t){t&&this.preSelect(t);var e=this.canvas.getSelectedElems();e.length&&this.canvas.deleteSelectedElements()},i.prototype.duplicate=function(t){t&&this.preSelect(t);var e=this.canvas.getSelectedElems();e.length&&this.canvas.cloneSelectedElements(20,20)},i.prototype.sendForward=function(t){t&&this.preSelect(t);var e=this.canvas.getSelectedElems();e.length&&this.canvas.moveUpDownSelected("Up")},i.prototype.sendBackward=function(t){t&&this.preSelect(t);var e=this.canvas.getSelectedElems();e.length&&this.canvas.moveUpDownSelected("Down")},i.prototype.preSelect=function(t){var e=$("#"+t)[0];this.canvas.selectOnly([e])},e.exports=new i},{"./facade":20}],20:[function(t,e,n){function i(){this.handlers={sticker:t("./handlers/sticker"),shape:t("./handlers/shape"),group:t("./handlers/group")},_.each(o,function(t,e){var n={};_.each(t,function(t,e){n[e]=new t}),this[e]=n},this)}var a=t("../abstract/facade"),o={creators:{sticker:t("./creators/sticker"),shape:t("./creators/shape"),image:t("./creators/image"),group:t("./creators/group"),text:t("./creators/text")},setters:{sticker:t("./setters/sticker"),shape:t("./setters/shape"),image:t("./setters/image"),background:t("./setters/background"),text:t("./setters/text"),group:t("./setters/group"),template:t("./setters/template")},getters:{template:t("./getters/template"),text:t("./getters/text"),image:t("./getters/image"),sticker:t("./getters/sticker"),background:t("./getters/background"),group:t("./getters/group"),shape:t("./getters/shape")}};i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),_.invoke(this.getters,"initialize"),_.each(this.setters,function(t,e){t.initialize(),t.on("all",_.partial(this.propagate,e+".update"))},this),_.each(this.creators,function(t,e){t.initialize(),t.on("all",_.partial(this.propagate,e+".create"))},this)},i.prototype.get=function(t,e){var n=$("#"+t)[0],i=this.getters[t]?t:this.getType(n);if(this.getters[i]){var a=n?this.getters[i].get(n,e):this.getters[i].get(e);return _.extend(a,{type:i})}},i.prototype.create=function(t,e){return this.creators[t]?this.creators[t].create(e):void 0},i.prototype.set=function(t,e){function n(t,n){this.setters[t]&&(n||this.setters[t].set(e),n&&this.setters[t].set(n,e))}var i=!_.isString(t)&&!e;if(i){e=t;var a=_.toArray(this.canvas.getSelectedElems());_.each(a,function(t){n.call(this,this.getType(t),t)},this),this.canvas.selectOnly(a)}else{var o=$("#"+t)[0],r=this.setters[t]?t:this.getType(o);n.call(this,r,o)}},i.prototype.propagate=function(t,e,n,i){n&&(i=_.extend(i||{},{id:n}),this.trigger(n+(e?"."+e:""),i)),this.trigger(t+(e?"."+e:""),i)},e.exports=i},{"../abstract/facade":11,"./creators/group":14,"./creators/image":15,"./creators/shape":16,"./creators/sticker":17,"./creators/text":18,"./getters/background":23,"./getters/group":24,"./getters/image":25,"./getters/shape":26,"./getters/sticker":27,"./getters/template":28,"./getters/text":29,"./handlers/group":30,"./handlers/shape":31,"./handlers/sticker":32,"./setters/background":36,"./setters/group":37,"./setters/image":38,"./setters/shape":39,"./setters/sticker":40,"./setters/template":41,"./setters/text":42}],21:[function(t,e,n){function i(){}var a=t("./getter");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,this.structure={id:null,z_index:null,position:{x:null,y:null},rotation:null,size:{width:null,height:null},opacity:null,locked:null}},i.prototype.getId=function(){return this.element.getAttribute("id")},i.prototype.getRotation=function(){return this.canvas.getRotationAngle(this.element)},i.prototype.getOpacity=function(){var t=parseFloat(this.element.getAttribute("opacity"));return _.isNaN(t)?1:t},i.prototype.getPositionX=function(){return this.bb=this.bb||this.element.getBBox(),this.bb.x},i.prototype.getPositionY=function(){return this.bb=this.bb||this.element.getBBox(),this.bb.y},i.prototype.getSizeWidth=function(){return this.bb=this.bb||this.element.getBBox(),this.bb.width},i.prototype.getSizeHeight=function(){return this.bb=this.bb||this.element.getBBox(),this.bb.height},i.prototype.getLocked=function(){return $(this.element).hasClass("locked")}},{"./getter":22}],22:[function(t,e,n){function i(){}var a=t("../../../../utils/humps");e.exports=i,i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=function(){this.structure={}},i.prototype.get=function(t,e){function n(t){return t.split("..").length>1}function i(t){return!n(t)}this.element=t,this.bb=this.element&&this.element.getBBox(),e=e||"",this.data={},this.collections={},this.processData={};var a=this.getChainAttributes(e),o=_.bind(this.processModels,this,e);return _.each(_.filter(a,n),this.processCollections,this),_.each(_.filter(a,i),o,this),this.addCollectionResults(e),this.data},i.prototype.processCollections=function(t){function e(){var t="get_"+i.replace(/\./g,"_"),e=a.camelize(t);this.collections[i]={},this.processData[i]=this[e]?this[e]():[],_.each(this.processData[i],function(t,e){this.collections[i][e]={}},this)}var n=t.split(".."),i=n[0],o=n[1];this.collections[i]||e.call(this);var r=this.collections[i],s=a.camelize("get_"+i.replace(/\./g,"_")+"_"+o.replace(/\./g,"_")),l=a.camelize("get_"+o.replace(/\./g,"_"));_.each(this.processData[i],function(t,e){if(this[s]||t[l]){var t=t[l]?t[l](e):this[s](t,e);this.addDataResult(o,t,r[e])}},this)},i.prototype.addCollectionResults=function(t){var e=new RegExp(t+"[.]?");_.each(this.collections,function(t,n){this.addDataResult(n.replace(e,""),t)},this)},i.prototype.processModels=function(t,e){var n="get_"+e.replace(/\./g,"_"),i=a.camelize(n),o=new RegExp(t+"[.]?");this[i]&&this.addDataResult(e.replace(o,""),this[i]())},i.prototype.addDataResult=function(t,e,n){var i,a=_.compact(t.split("..")[0].split(".")),o=n||this.data;if(!a.length)return void(n?n=e:this.data=e);for(;a.length>1;)i=a.shift(),o[i]||(o[i]={}),o=o[i];o[a.shift()]=e},i.prototype.getChainAttributes=function(t,e){e=e||this.getChainEnd(t);var n=[];return"undefined"!=typeof e&&!_.isObject(e)&&n.push(t),_.each(e,function(i,a){t&&(a=t+"."+(_.isArray(e)?"":a)),i?n=_.union(n,this.getChainAttributes(a,i)):n.push(a)},this),n},i.prototype.getChainEnd=function(t){for(var e,n=_.compact(t.split(".")),i=this.structure;n.length>0;){if(e=n.shift(),"undefined"==typeof i)return;i=i[e]}return i}},{"../../../../utils/humps":323}],23:[function(t,e,n){function i(){}var a=t("./abstract/getter"),o=t("../../../../../bower_components/tinycolor/tinycolor");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.structure={color:null,source:null,background_id:null}},i.prototype.get=function(t){return a.prototype.get.call(this,$("#svgcontent > .background")[0],t)},i.prototype.getColor=function(){var t=$(this.element).find("rect")[0],e=o(t?t.getAttribute("fill"):"");return e.isValid()&&e.getAlpha()?e.toString():null},i.prototype.getSource=function(){var t=$(this.element).find("image")[0];return t?t.getAttribute("xlink:href"):null},i.prototype.getBackgroundId=function(){var t=$(this.element).find("image")[0];if(!t)return null;var e=t.getAttribute("class");if(e){var n=e.match(/favourites-background-image-id-(\d+)/);return n&&n[1]}}},{"../../../../../bower_components/tinycolor/tinycolor":2,"./abstract/getter":22}],24:[function(t,e,n){function i(){}var a=t("./abstract/element"),o=t("../../abstract/facade");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){var t=INKIVE.Tool.getInstance().editor;this.canvas=t.canvas,this.structure={id:null,position:{x:null,y:null},size:{width:null,height:null},elements:null,rotation:null,opacity:null,locked:null}},i.prototype.getElements=function(){return _.map($(this.element).children(),function(t){return{id:t.getAttribute("id"),type:this.getType(t)}},this)},i.prototype.getType=o.prototype.getType},{"../../abstract/facade":11,"./abstract/element":21}],25:[function(t,e,n){function i(){}var a=t("./abstract/element"),o=t("./shape");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.structure=_.extend(this.structure,{source:{url:null},locked_image:null,filter:{},crop_area:[{position:{x:null,y:null},size:{width:null,height:null},type:null}]})},i.prototype.getSourceUrl=function(){return this.element.getAttribute("xlink:href")},i.prototype.getLockedImage=function(){return $(this.element).hasClass("locked-image")},i.prototype.getCropArea=function(){var t,e={},n=this.element.getAttribute("clip-path");return n?(t=n.match(/url\(\"?([^\"\)]*)\"?\)/)[1],$(t).children(".layoutClipper").each(function(t,n){e[t]=new o,e[t].element=n}),e):e}},{"./abstract/element":21,"./shape":26}],26:[function(t,e,n){function i(){}var a=t("./abstract/element"),o=(t("./text"),t("../../../../../bower_components/tinycolor/tinycolor"));e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.structure=_.extend(this.structure,{type:null,fill:{color:null},stroke:{color:null,width:null,dasharray:null,linejoin:null,linecap:null}})},i.prototype.getType=function(){return this.element.nodeName},i.prototype.getFillColor=function(t){t=_.isElement(t)?t:this.element;var e=o(t.getAttribute("fill"));return e.isValid()&&e.getAlpha()?e.toString():null},i.prototype.getStrokeColor=function(){if(this.element.getAttribute("stroke")||this.element.getAttribute("stroke-width")){var t=o(this.element.getAttribute("stroke")||"#000");if(t.isValid()&&t.getAlpha())return t.toString()}},i.prototype.getStrokeWidth=function(){return this.element.getAttribute("stroke")?parseInt(this.element.getAttribute("stroke-width"))||1:void 0},i.prototype.getStrokeDasharray=function(){return this.element.getAttribute("stroke-dasharray")},i.prototype.getStrokeLinejoin=function(){return this.element.getAttribute("stroke-linejoin")},i.prototype.getStrokeLinecap=function(){return this.element.getAttribute("stroke-linecap")}},{"../../../../../bower_components/tinycolor/tinycolor":2,"./abstract/element":21,"./text":29}],27:[function(t,e,n){function i(){}var a=t("./abstract/element"),o=t("./text"),r=t("./shape");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.supportedSubElements=["image","ellipse","line","rect","text","polygon","circle","ellipse","path","g"],this.structure=_.extend(this.structure,{texts:[{content:null,decoration:null,color:null,anchor:null,font:{family:null,weight:null,style:null}}],shapes:[{type:null,fill:{color:null},stroke:{color:null,width:null,dasharray:null}}]})},i.prototype.getTexts=function(){return _.map($(this.element).find(".textarea"),function(t){var e=new o;return e.element=t,e.textarea=(new INKIVE.Text.Textarea).setDOM(t),e.text=e.textarea.text,e})},i.prototype.getShapes=function(){var t={};return _.each(this.getElements(),function(e,n){t[n]=new r,t[n].element=e}),t},i.prototype.getElementsWithColor=function(t){function e(e,a){var o=$(e).closest("g")[0],r=o&&$.contains(t,o)&&o.getAttribute("fill"),s=!r&&_.contains(i,e.tagName);(e.getAttribute("fill")||s)&&(n[a]=e)}t=t||this.element;var n={},i=["path","line","polygon","rect","circle","ellipse"];return _.each(this.getElements(t),e),n},i.prototype.getElements=function(t){t=t||this.element;var e=[t];return _.each($(t).children(),function(t){if(_.contains(this.supportedSubElements,t.tagName)){var n="g"===t.tagName,i=$(t).hasClass("textarea");n&&!i?e=_.union(e,this.getElements(t)):e.push(t)}},this),e}},{"./abstract/element":21,"./shape":26,"./text":29}],28:[function(t,e,n){function i(){}var a=t("./abstract/getter");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,this.structure={size:{width:null,height:null},format:{id:null},grid:{index_in_set:null,number_of_photos:null},designed:{id:null}}},i.prototype.get=function(t,e){return e?a.prototype.get.call(this,t,e):a.prototype.get.call(this,$("#svgcontent")[0],t)},i.prototype.getSizeWidth=function(){return this.canvas.contentW},i.prototype.getSizeHeight=function(){return this.canvas.contentH},i.prototype.getDesignedId=function(){return this.getClassExpData(/layout-id-(\d+)/)},i.prototype.getFormatId=function(){return this.getClassExpData(/format-id-(\d+)/)},i.prototype.getGridIndexInSet=function(){return this.getClassExpData(/grid-id-[\d+]-(\d+)/)},i.prototype.getGridNumberOfPhotos=function(){return this.getClassExpData(/grid-id-(\d+)-[\d+]/)},i.prototype.getClassExpData=function(t){var e,n=$(this.element).children("g.main");return _.any(n.attr("class").split(" "),function(n){var i=n.match(t);return i?e=i[1]:void 0}),e}},{"./abstract/getter":22}],29:[function(t,e,n){function i(){}var a=t("./abstract/element");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(){a.prototype.initialize.call(this),this.structure=_.extend(this.structure,{color:null,anchor:null,content:null,decoration:null,bullet_points:null,font:{family:null,size:null,weight:null,style:null},spacing:{letter:null,word:null,line:null}})},i.prototype.get=function(t){return this.textarea=(new INKIVE.Text.Textarea).setDOM(t),this.text=this.textarea.text,a.prototype.get.apply(this,arguments)},i.prototype.getSpacingLetter=function(){return this.text.letter_spacing},i.prototype.getSpacingWord=function(){return this.text.word_spacing},i.prototype.getSpacingLine=function(){return this.text.line_spacing},i.prototype.getFontFamily=function(){return this.text.font_family},i.prototype.getFontSize=function(){return this.text.font_size},i.prototype.getFontWeight=function(){return this.text.font_weight},i.prototype.getFontStyle=function(){return this.text.font_style},i.prototype.getDecoration=function(){return this.text.text_decoration},i.prototype.getAnchor=function(){return this.text.text_anchor},i.prototype.getColor=function(){return this.text.fill},i.prototype.getBulletPoints=function(){return this.text.bullets},i.prototype.getContent=function(){var t=new RegExp(String.fromCharCode(160),"g");return this.text.textContent.replace(t," ")}},{"./abstract/element":21}],30:[function(t,e,n){e.exports=_.extend({initialize:function(){var t=INKIVE.Tool.getInstance();this.canvas=t.editor.canvas},ungroup:function(t){this.canvas.selectOnly([t]),this.canvas.ungroupSelectedElement()}},Backbone.Events)},{}],31:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas},flipVertical:function(t){this.canvas.selectOnly([t]),this.canvas.setFlip("v")},flipHorizontal:function(t){this.canvas.selectOnly([t]),this.canvas.setFlip("h")},convertToImageBox:function(t){var e=this.canvas.getBBox(t),n=this.canvas.copyElem(t);n.removeAttribute("stroke"),n.removeAttribute("stroke-width"),n.removeAttribute("stroke-dasharray"),n.removeAttribute("stroke-linejoin"),n.removeAttribute("stroke-linecap"),n.removeAttribute("stroke-opacity"),n.removeAttribute("fill"),n.setAttribute("fill-opacity","1");var i=new svgedit.history.BatchCommand("Convert to imagebox");i.addSubCommand(new svgedit.history.RemoveElementCommand(t,t.nextSibling,t.parentNode)),svgedit.history.UndoManager.prototype.toggleUndoStackLock(!0),this.canvas.deleteSelectedElements(),svgedit.history.UndoManager.prototype.toggleUndoStackLock(!1),n.removeAttribute("id");var a=this.canvas.runExtensions("addLayoutBox",{elem:n,clipPathBB:e});i.addSubCommand(new svgedit.history.InsertElementCommand(a)),this.canvas.undoMgr.addCommandToHistory(i),INKIVE.Tool.autoSave(n)}},Backbone.Events)},{}],32:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas},flipVertical:function(t){this.canvas.selectOnly([t]),this.canvas.setFlip("v")},flipHorizontal:function(t){this.canvas.selectOnly([t]),this.canvas.setFlip("h")}},Backbone.Events)},{}],33:[function(t,e,n){function i(){this.handledAttributes=["position","rotation","opacity","size","locked"]}var a=t("../../../../utils/humps"),o=t("../../../editor/editor");e.exports=i,i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=function(){this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,_.bindAll(this,"set")},i.prototype.set=function(t,e){_.each(e,function(n,i){if(_.contains(this.handledAttributes,i)){var o=a.camelize("update_"+i);this[o](t,e)}},this),this.trigger("",t.getAttribute("id"),e)},i.prototype.selectElement=function(t){var e=_.compact(_.toArray(this.canvas.getSelectedElems()));(1!==e.length||e[0]!==t)&&(this.canvas.clearSelection(),this.canvas.selectOnly([t]))},i.prototype.updatePosition=function(t,e){var n=e.position,i=t.getBBox(),a=o.handle("zoom","get");this.selectElement(t),this.canvas.moveSelectedElements((n.x-i.x)*a,(n.y-i.y)*a),this.trigger("position",t.getAttribute("id"),{position:n})},i.prototype.updateRotation=function(t,e){this.selectElement(t),this.canvas.setRotationAngle(e.rotation),this.trigger("rotation",t.getAttribute("id"),{rotation:e.rotation})},i.prototype.updateOpacity=function(t,e){this.updateAttributeNoUndo(t,"opacity",e.opacity),this.trigger("opacity",t.getAttribute("id"),{opacity:e.opacity})},i.prototype.updateLocked=function(t,e){$(t).toggleClass("locked",e.locked),this.trigger("locked",t.getAttribute("id"),{locked:e.locked})},i.prototype.updateSize=function(t,e){var n=e.size;if(n.width||n.height){var i=$("#svgroot").get(0),a=t.getBBox(),o=i.createSVGTransform(),r=i.createSVGTransform(),s=i.createSVGTransform(),l=svgedit.transformlist.getTransformList(t);if(!n.width||!n.height){var c=a.width/a.height;n.width||(n.width=n.height*c),n.height||(n.height=n.width/c)}var u=a.x+a.width/2,h=a.y+a.height/2;o.setTranslate(u,h),r.setScale(n.width/a.width,n.height/a.height),s.setTranslate(-u,-h),l.appendItem(o),l.appendItem(r),l.appendItem(s),svgedit.recalculate.recalculateDimensions(t,a)}},i.prototype.updateAttributeNoUndo=function(t,e,n){this.canvas.undoMgr.beginUndoableChange(e,[t]),this.canvas.changeSelectedAttributeNoUndo(e,n,[t]);var i=this.canvas.undoMgr.finishUndoableChange();i.isEmpty()||this.canvas.undoMgr.addCommandToHistory(i)}},{"../../../../utils/humps":323,"../../../editor/editor":45}],34:[function(t,e,n){function i(){}var a=t("./element");e.exports=i,i.prototype=new a,i.prototype.constructor=i},{"./element":33}],35:[function(t,e,n){var i=t("../../creators/sticker");e.exports={setCheckOnce:function(){return!window.Android&&this.appBridge.version.isEqual("1.1.3")},set:function(t){this.stickerCreator||(this.stickerCreator=new i,this.stickerCreator.initialize()),this.stickerCreator.create(t)}}},{"../../creators/sticker":17}],36:[function(t,e,n){function i(){this.handledAttributes=["color","source"]}var a=t("../../../utils/humps"),o=t("./abstract/element"),r=t("../../../factory/images"),s=t("../../editor/editor");e.exports=i,i.prototype=new o,i.prototype.constructor=i,i.prototype.set=function(t){_.each(t,function(e,n){if(_.contains(this.handledAttributes,n)){var i=a.camelize("update_"+n);this[i](t)}},this),this.trigger("",null,t)},i.prototype.updateSource=function(t){var e=this.editor.replaceBackground({type:"image",data:t.source,favouiritesId:t.background_id});this.updateResolution(e,t),this.trigger("source",null,{source:t.source})},i.prototype.updateColor=function(t){this.editor.replaceBackground({type:"color",data:t.color});this.trigger("color",null,{color:t.color})},i.prototype.updateResolution=function(t,e){function n(){var t=s.handle("zoom","get");return{width:this.canvas.contentW*t,height:this.canvas.contentH*t}}r.smartLoad(e.source,n.call(this),_.bind(function(n,i){var a=e.source===e.source;a&&n===INKIVE.C.Status.success&&(e.source=i.src,svgedit.utilities.assignAttributes(t,{"xlink:href":e.source}),this.trigger("source",null,{source:e.source}))},this))}},{"../../../factory/images":66,"../../../utils/humps":323,"../../editor/editor":45,"./abstract/element":33}],37:[function(t,e,n){function i(){this.handledAttributes=["rotation","opacity","locked"]}var a=t("./abstract/element");e.exports=i,i.prototype=new a,i.prototype.constructor=i},{"./abstract/element":33}],38:[function(t,e,n){function i(){this.handledAttributes=_.union(["source","locked_image"],this.handledAttributes)}var a=t("./abstract/element"),o=t("../../editor/editor"),r=t("../../../factory/images");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.updateSourceLock=function(t,e){$(t.getAttribute("id")).toggleClass("locked-image",e.source_lock),this.trigger("source_lock",t.getAttribute("id"),{source_lock:e.source_lock})},i.prototype.updateSource=function(t,e){var n=e.source.external_resize,i="undefined"==typeof e.source.smart_load?!0:e.source.smart_load;n&&this.resizeExternalSearchFoto(t,e),n||(i||this.updateSourceUrl(t,e),i&&this.onVersionData(t,e)),this.trigger("source",t.getAttribute("id"),{source_lock:e.source_lock})},i.prototype.updateLockedImage=function(t,e){$(t).toggleClass("locked-image",e.locked_image),this.trigger("locked_image",t.getAttribute("id"),{locked_image:e.locked_image})},i.prototype.updateSourceUrl=function(t,e){var n="undefined"==typeof e.source.smart_load?!0:e.source.smart_load;if(t.getAttribute("xlink:href")==e.source.url)return void this.trigger("optimus_resolution",t.getAttribute("id"));if(svgedit.utilities.assignAttributes(t,{"xlink:href":e.source.url}),n||e.source.external_resize){var i=new Image;i.onload=_.bind(this._onImage,this,t,e,i),i.src=e.source.url}this.trigger("source.url",t.getAttribute("id"),{source:{url:e.source.url}})},i.prototype._onImage=function(t,e,n){function i(){var e=c>u?{width:l.height*c,height:l.height}:{width:l.width,height:l.width/c};this.updateSize(t,{size:e}),this.selectElement(t),o.handle(t.getAttribute("id"),"crop",{quiet:!0,clip_path:l,scale:1}),this.canvas.clearSelection()}function a(){var e=c>u?{width:l.width,height:l.width/c}:{width:l.height*c,height:l.height};this.updateSize(t,{size:e})}var r=svgedit.utilities.getClipPath(t),s=r&&r.childNodes[0],l=s?s.getBBox():t.getBBox(),c=n.width/n.height,u=l.width/l.height;e.keep_box_size||a.call(this),e.keep_box_size&&i.call(this)},i.prototype.onVersionData=function(t,e){var n=this.getSize(t,e);this.trigger("optimize_resolution",t.getAttribute("id")),r.smartLoad(e.source.url,n,_.bind(function(n,i){var a=n===INKIVE.C.Status.success||e.source.url;e.source.url=n===INKIVE.C.Status.success?i.src:e.source.url,a&&this.updateSourceUrl(t,e)},this))},i.prototype.getSize=function(t,e){return{width:e.size?e.width:t.getAttribute("width"),height:e.size?e.height:t.getAttribute("height")}},i.prototype.resizeExternalSearchFoto=function(t,e){function n(){var n=this.getSize(t,e),i="https://s3.amazonaws.com/thumb/",a=r.getRightSizeUrl(i,n),o=_.last(_.compact(a.split("/")))||"web";return"thumb"===o&&(o="mobile"),"original"===o&&(o="largweb"),o}var i=n.call(this),a={book_id:INKIVE.C.BOOK.id,photo_url:r.getOriginalUrl(e.source.url),platform:i},o=INKIVE.C.BASE_URL+"inkive/resizeexternalsearchphoto";$(t).addClass("resizing"),this.trigger("resize_external",t.getAttribute("id")),$.api(o,"POST",a,_.bind(function(n){if("success"===n.STATUS){var a={thumb:n.MESSAGE.replace("/"+i+"/","/thumb/"),original:n.MESSAGE.replace("/"+i+"/","/original/")};a[i]=n.MESSAGE,e.source.url=n.MESSAGE,r.addImageData(a,r.defaultAmazonDataNames)}this.onVersionData(t,e),$(t).removeClass("resizing")},this))}},{"../../../factory/images":66,"../../editor/editor":45,"./abstract/element":33}],39:[function(t,e,n){function i(){
this.handledAttributes=_.union(["fill","stroke"],this.handledAttributes)}var a=t("./abstract/graphic");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.updateFill=function(t,e){this.updateAttributeNoUndo(t,"fill",e.fill.color),this.trigger("fill",t.getAttribute("id"),{fill:e.fill})},i.prototype.updateStroke=function(t,e){var n=e.stroke;"undefined"!=typeof n.color&&this.updateAttributeNoUndo(t,"stroke",n.color),"undefined"!=typeof n.width&&this.updateAttributeNoUndo(t,"stroke-width",n.width),"undefined"!=typeof n.dasharray&&this.updateAttributeNoUndo(t,"stroke-dasharray",n.dasharray),"undefined"!=typeof n.linejoin&&this.updateAttributeNoUndo(t,"stroke-linejoin",n.linejoin),"undefined"!=typeof n.linecap&&this.updateAttributeNoUndo(t,"stroke-linecap",n.linecap),this.trigger("stroke",t.getAttribute("id"),{stroke:e.stroke})}},{"./abstract/graphic":34}],40:[function(t,e,n){function i(){this.handledAttributes=_.union(["texts","shapes"],this.handledAttributes),this.supportedSubElements=["image","ellipse","line","rect","text","polygon","circle","ellipse","path","g"]}var a=t("./abstract/graphic"),o=t("./shape"),r=t("./text"),s=t("../getters/sticker"),l=t("../../../app/decorate");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.updateTexts=function(t,e){var n=new r,i=$(t).find(".textarea");n.initialize(),_.each(e.texts,function(t,e){n.set(i[e],t)}),this.trigger("texts",t.getAttribute("id"),{texts:e.texts})},i.prototype.updateShapes=function(t,e){var n=new o,i=this.getElements(t);n.initialize(),_.each(e.shapes,function(t,e){if(i[e]){var a=this.getElementsWithColor(i[e]);_.each(a,function(e){n.set(e,t)})}},this),this.trigger("shapes",t.getAttribute("id"),{shapes:e.shapes})},i.prototype.getElements=s.prototype.getElements,i.prototype.getElementsWithColor=s.prototype.getElementsWithColor,i.prototype=l(t("./app/sticker"),i.prototype)},{"../../../app/decorate":7,"../getters/sticker":27,"./abstract/graphic":34,"./app/sticker":35,"./shape":39,"./text":42}],41:[function(t,e,n){function i(){this.handledAttributes=["size.width","size.height","size.unit","grid.index_in_set","grid.number_of_photos","designed.id","designed.content"]}var a=t("./abstract/element"),o=(t("../../../factory/images"),t("../../../facade/editor/editor"));e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.set=function(t){var e=t.designed&&(t.designed.id||t.designed.content),n=t.grid&&t.grid.index_in_set&&t.grid.number_of_photos,i=n||e;e&&this.setDesignedTemplate(t),n&&this.setGridTemplate(t),i||t.size&&this.updateSize(t),this.trigger("",null,t)},i.prototype.setDesignedTemplate=function(t){function e(e){t.format={id:e.format_id},t.designed.id=t.designed.id||t.designed.content.id,t.keep_stage_size||(t.size={width:e.format_width,height:e.format_height},this.updateSize(t)),this.onSVGData(t,{defs:Base64.decode(e.defs),content:Base64.decode(e.content),background:Base64.decode(e.background)},e),this.trigger("designed",null,{designed:t.designed})}t.designed.content?e.call(this,t.designed.content):INKIVE.Helpers.api("search/layout","GET",{id:t.designed.id},_.bind(e,this))},i.prototype.setGridTemplate=function(t){var e=INKIVE.Helpers.convertUnitsToPixels,n=INKIVE.C.BASE_URL+"grid/fetch/"+t.grid.index_in_set,i=t.size?t.size.unit?e(t.size.width,t.size.unit):parseInt(t.size.width):this.canvas.contentW,a=t.size?t.size.unit?e(t.size.height,t.size.unit):parseInt(t.size.height):this.canvas.contentHeight,o={width:i,height:a,number_of_photos:t.grid.number_of_photos};INKIVE.Helpers.sendCmd(n,o,_.bind(function(e){var n=o.width==this.canvas.contentW&&o.height==this.canvas.contentH;e=$.parseJSON(e),n||this.updateSize(t),"SUCCESS"===e.STATUS&&this.onSVGData(t,{defs:e.MESSAGE.defs,content:e.MESSAGE.svg}),this.trigger("grid",null,{grid:t.grid})},this))},i.prototype.updateSize=function(t){function e(){var t=$("#svgcontent > g.main")[0];if(t){var e=t.classList;_.each(_.compact(e),function(e){e.match(/format-id-[\d+]/)&&t.classList.remove(e),e.match(/layout-id-[\d+]/)&&t.classList.remove(e)})}}var n=INKIVE.Helpers.convertUnitsToPixels,i=t.size.unit?n(t.size.width,t.size.unit):parseInt(t.size.width),a=t.size.unit?n(t.size.height,t.size.unit):parseInt(t.size.height),r=this.canvas.contentW,s=this.canvas.contentH;(i!=r||a!=s)&&(this.canvas.contentW=i,this.canvas.contentH=a,e(),o.handle("zoom","fit"),this.trigger("size",null,{size:t.size}))},i.prototype.onSVGData=function(t,e,n){function i(e){t.designed&&t.designed.id&&e.addClass("layout-id-"+t.designed.id),t.format&&t.format.id&&e.addClass("format-id-"+t.format.id),t.grid&&t.grid.index_in_set&&t.grid.number_of_photos&&e.addClass("grid-id-"+t.grid.number_of_photos+"-"+t.grid.index_in_set)}function a(){var t=INKIVE.Helpers.convertUnitsToPixels;INKIVE.Helpers.converterLayoutSizeChange(this.canvas.contentW,this.canvas.contentH,t(n.format_width,n.unit),t(n.format_height,n.unit))}function o(t){t.firstChild&&o(t.firstChild),t.nextSibling&&o(t.nextSibling),3===t.nodeType&&t.nodeValue.match(/(\r\n|\r|\n)+/g)&&t.remove()}this.editor.addElement("layout",$.extend({keep:t.setCurrentPage},e)),t.keep_stage_size||i($("#svgcontent > g.main")),o($("#svgcontent")[0]),INKIVE.Helpers.converterCurrentPage(),t.keep_stage_size&&a.call(this)}},{"../../../facade/editor/editor":45,"../../../factory/images":66,"./abstract/element":33}],42:[function(t,e,n){function i(){this.handledAttributes=_.union(["content","font","spacing","decoration","color","anchor","bullet_points"],this.handledAttributes)}var a=t("./abstract/element");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.set=function(t){this.textarea=(new INKIVE.Text.Textarea).setDOM(t),a.prototype.set.apply(this,arguments),this.textarea.render(this.canvas)},i.prototype.updateSpacing=function(e,n){var i="undefined"!=typeof n.decoration&&"underline"!==n.decoration,a="underline"===this.textarea.text.text_decoration&&!i;n=n.spacing,a&&(n.letter||n.word)&&t("../../../utils/advice").show("spacing-and-underline"),"undefined"==typeof n.letter||a&&n.letter||(this.textarea.text.setValues({letter_spacing:n.letter}),this.trigger("spacing.letter",e.getAttribute("id"),n.letter)),"undefined"==typeof n.word||a&&n.word||(this.textarea.text.setValues({word_spacing:n.word}),this.trigger("spacing.word",e.getAttribute("id"),n.word)),"undefined"!=typeof n.line&&(this.textarea.text.setValues({line_spacing:n.line}),this.trigger("spacing.line",e.getAttribute("id"),n.line)),this.trigger("spacing",e.getAttribute("id"),n)},i.prototype.updateFont=function(t,e){e=e.font,"undefined"!=typeof e.family&&(this.textarea.text.setValues({font_family:e.family}),this.trigger("font.family",t.getAttribute("id"),e.family)),"undefined"!=typeof e.size&&(this.textarea.text.setValues({font_size:e.size}),this.trigger("font.size",t.getAttribute("id"),e.size)),"undefined"!=typeof e.weight&&(this.textarea.text.setValues({font_weight:e.weight}),this.trigger("font.weight",t.getAttribute("id"),e.weight)),"undefined"!=typeof e.style&&(this.textarea.text.setValues({font_style:e.style}),this.trigger("font_style",t.getAttribute("id"),e.style)),this.trigger("font",t.getAttribute("id"),e)},i.prototype.updateBulletPoints=function(t,e){var n="start"==this.textarea.text.text_anchor;n||this.updateAnchor(t,{anchor:"start"}),this.textarea.text.setValues({bullets:e.bullet_points}),this.trigger("bullet_points",t.getAttribute("id"),e.bullet_points)},i.prototype.updateContent=function(t,e){this.textarea.text.setValues({textContent:e.content.replace(" ",String.fromCharCode(160))}),this.trigger("content",t.getAttribute("id"),e.content)},i.prototype.updateDecoration=function(e,n){var i=n.spacing,a=i&&"undefined"!=typeof i.letter&&!i.letter,o=i&&"undefined"!=typeof i.word&&!i.word,r=this.textarea.text.letter_spacing&&!a||this.textarea.text.word_spacing&&!o;r&&"underline"===n.decoration?t("../../../utils/advice").show("spacing-and-underline"):(this.textarea.text.setValues({text_decoration:n.decoration}),this.trigger("decoration",e.getAttribute("id"),n.decoration))},i.prototype.updateAnchor=function(t,e){this.textarea.text.setValues({text_anchor:e.anchor}),this.trigger("anchor",t.getAttribute("id"),e.anchor)},i.prototype.updateColor=function(t,e){this.textarea.text.setValues({fill:e.color}),this.trigger("color",t.getAttribute("id"),e.color)}},{"../../../utils/advice":318,"./abstract/element":33}],43:[function(t,e,n){e.exports={_close:function(){function t(){INKIVE.Modal.togglePageLoader(!1),this.appBridge.callBoth("close_editor")}INKIVE.Helpers.api("inkive/close","GET",{scrapbook:INKIVE.C.BOOK.id},_.bind(t,this))}}},{}],44:[function(t,e,n){e.exports={_onSavedCheckOnce:function(){return!window.Android&&!this.appBridge.version.isLowerThan("2.2.1")||window.Android&&!this.appBridge.version.isLowerThan("2.1")},_onSaved:function(t,e,n){t.quiet||INKIVE.Modal.togglePageLoader(!1),n?(e.resolve(),this.trigger("saved")):(e.reject(),this.trigger("403"))}}},{}],45:[function(t,e,n){function i(){this.handlers={align:t("./handlers/align"),zoom:t("./handlers/zoom"),page:t("./handlers/page"),cache:t("./handlers/cache"),history:t("./handlers/history"),image:t("./handlers/image"),download:t("./handlers/download"),tool_mode:t("./handlers/tool-mode")},this.getters={page:t("./getters/page")}}var a=t("../abstract/facade"),o=t("../../app/decorate"),r=t("../design/getters/sticker");i.prototype=new a,i.prototype.constructor=i,i.prototype.initialize=function(t){a.prototype.initialize.call(this),this.handlers.zoom.curConfig=t,_.bindAll(this,"get","close","deselectAll","_close","_doubleTap"),this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.initSelectEvent(),this.editor.gesture.on("double_click",this._doubleTap)},i.prototype.initSelectEvent=function(){function t(t,i){i=_.compact(i),e(this.selectedElements,i)||(n.runExtensions("selectedChanged",{elems:i}),this._select(i))}function e(t,e){return t&&e.length===t.length&&_.all(e,function(e){return _.any(t,function(t){return e.getAttribute("id")===t.getAttribute("id")})})}var n=this.canvas;n.bind("editor.sub_selected",_.bind(function(t,e){this._select(e)},this)),n.bind("editor.selected",_.bind(t,this)),n.bind("editor.elem_selected",_.bind(function(){this.selectedElements=[],t.apply(this,arguments)},this))},i.prototype.get=function(t,e){return this.getters[t]?this.getters[t].get(e):void 0},i.prototype.deselectAll=function(){this.selectedElements=[],this.canvas.clearSelection()},i.prototype.close=function(){var t=this.editor.getSvgString(),e=Base64.decode(INKIVE.C.BOOK.name).trim().toLowerCase();if(INKIVE.EditorModeManager.isMode("logo")||INKIVE.C.IS_MOBILE_APP||"new project"!=e&&""!=e){var n=!INKIVE.Helpers.areEqual(t,this.handle("cache","get"));n||this._close(),n&&this.handlers.page.save().then(this._close)}else $('.tool-menu li:not(.active) a[role="tab"][href="#tabSettings"]').trigger("click"),$(".tool-content #tabSettings .accordion-section-title:not(.active)").trigger("click"),$(".tool-content #tabSettings #ik-project-name").select().focus(),this.canvas.call("advice.show","project-name")},i.prototype.convertToImageBox=function(){var t=this.canvas.getSelectedElems()[0],e=this.canvas.getBBox(t),n=["stroke","stroke-width","stroke-dasharray","stroke-linejoin","stroke-linecap","stroke-opacity","fill"],i=this.canvas.copyElem(t);_.each(n,i.removeAttribute,i),i.setAttribute("fill-opacity","1");var a=new svgedit.history.BatchCommand("Convert to imagebox");a.addSubCommand(new svgedit.history.RemoveElementCommand(t,t.nextSibling,t.parentNode)),svgedit.history.UndoManager.prototype.toggleUndoStackLock(!0),this.canvas.deleteSelectedElements(),svgedit.history.UndoManager.prototype.toggleUndoStackLock(!1),i.removeAttribute("id");var o=this.canvas.runExtensions("addLayoutBox",{elem:i,clipPathBB:e});a.addSubCommand(new svgedit.history.InsertElementCommand(o)),this.canvas.undoMgr.addCommandToHistory(a),INKIVE.Tool.autoSave(i)},i.prototype._close=function(){INKIVE.Modal.togglePageLoader(!0),INKIVE.Helpers.api("inkive/close","GET",{scrapbook:INKIVE.C.BOOK.id},function(){INKIVE.Modal.togglePageLoader(!1),window.location=INKIVE.EditorModeManager.isMode("logo")?BASE_URL+"library":BASE_URL})},i.prototype._select=function(e){function n(t,e){var n,i=this.getType(t);if("sticker"===i){var a=new r;a.element=t,_.any(a.getTexts(),function(t,i){return t.element===e?n={type:"text",index:i}:void 0})}return n}var i=t("../design/design");this.selectedElements=_.compact(_.map(e,function(t){return $(t).is(".subelement")?$(t).closest(".element")[0]:t})),this.trigger("select",_.compact(_.map(e,_.bind(function(t){if(t){if($(t).is(".subelement")){var e=t;t=$(t).closest(".element")[0];var a=n.call(this,t,e)}return t&&_.extend(i.get(t.getAttribute("id")),{inner_element:a})}},this))))},i.prototype._doubleTap=function(e){var n=t("../design/design"),i=this.canvas.getSelectedElems();this.trigger("double_tap",_.map(i,_.bind(function(t){var i,a=this.getType(t);if("sticker"===a){var o=$(e.target).closest("g.textarea")[0];if(o){var s=new r;s.element=t,_.any(s.getTexts(),function(t,e){return t.element===o?i={type:"text",index:e}:void 0})}}return _.extend(n.get(t.getAttribute("id")),{inner_element:i})},this)))},e.exports=o(t("./app/editor"),new i)},{"../../app/decorate":7,"../abstract/facade":11,"../design/design":19,"../design/getters/sticker":27,"./app/editor":43,"./getters/page":46,"./handlers/align":47,"./handlers/cache":48,"./handlers/download":49,"./handlers/history":50,"./handlers/image":51,"./handlers/page":52,"./handlers/tool-mode":53,"./handlers/zoom":54}],46:[function(t,e,n){e.exports={get:function(t){return"current"===t?parseInt(INKIVE.Tool._current_page_id):"total"===t?parseInt(INKIVE.C.BOOK.num_pages):void 0}}},{}],47:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas,this.svgroot=$("#svgroot").get(0)},verticalMiddle:function(){this.doAlign(function(t,e){return{x:0,y:t.y+t.height/2-(e.y+e.height/2)}})},horizontalMiddle:function(t){this.doAlign(function(t,e){return{x:t.x+t.width/2-(e.x+e.width/2),y:0}})},left:function(){this.doAlign(function(t,e){return{x:t.x-e.x,y:0}})},right:function(){this.doAlign(function(t,e){return{x:t.x+t.width-(e.x+e.width),y:0}})},top:function(){this.doAlign(function(t,e){return{x:0,y:t.y-e.y}})},bottom:function(){this.doAlign(function(t,e){return{x:0,y:t.y+t.height-(e.y+e.height)}})},doAlign:function(t){var e=this,n=this.canvas.getSelectedElems();if(n){var i,a=n.length;if(a>2)a--,i=this.getBBox(n[a]);else{i=svgedit.utilities.getBBox($("#canvasBackground").get(0));var o=Math.min(.1*i.width,.1*i.height),r=this.getBBox(n[0]);(r.height+o>i.height||r.width+o>i.width)&&(o=0),i.x+=o,i.y+=o,i.width-=2*o,i.height-=2*o}for(var s=0;a>s;s++){var l=this.getBBox(n[s]);e.setPosition(n[s],t(i,l))}this.canvas.runExtensions("clear",{})}},getBBox:function(t){var e=this.canvas.getZoom(),n=INKIVE.Helpers.getSelectedCoordinates(t);return{x:n.x1/e,y:n.y1/e,width:(n.x2-n.x1)/e,height:(n.y3-n.y1)/e}},setPosition:function(t,e){var n=this.svgroot.createSVGTransform(),i=svgedit.transformlist.getTransformList(t);n.setTranslate(e.x,e.y),i.appendItem(n),svgedit.recalculate.recalculateDimensions(t),this.canvas.selectorManager.requestSelector(t).resize()}},Backbone.Events)},{}],48:[function(t,e,n){var i={};e.exports=_.extend({initialize:function(){},clear:function(){i={}},set:function(t){t.page_number=t.page_number||INKIVE.Tool._current_page_id,i[t.page_number]=t.data},get:function(t){return t=t||{page_number:INKIVE.Tool._current_page_id},i[t.page_number]},remove:function(t){var e={};t=t||{page_number:INKIVE.Tool._current_page_id},_.each(i,function(n,i){if(i!=t.page_number){var a=i>t.page_number?parseInt(i)-1:i;e[a]=n}}),i=e},add:function(t){var e={};t=t||{page_number:INKIVE.Tool._current_page_id},_.each(i,function(n,i){var a=i>=t.page_number?parseInt(i)+1:i;e[a]=n}),i=e}},Backbone.Events)},{}],49:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas},pdf:function(){return this.displayModal("pdf")},jpeg:function(){return this.displayModal("jpeg")},png:function(){return this.displayModal("png")},displayModal:function(t){var e=_.bind(this._download,this),n=INKIVE.TranslateHelper.translate,i=new INKIVE.ModalDownload({format:t,contentW:this.canvas.contentW,contentH:this.canvas.contentH}),a=INKIVE.Modal.modalWindow(i.getFormHtml(),{width:600,headerIcon:"icon-cloud-download",headerTitle:n("modal.title.download_format",{format:t.toUpperCase()}),buttons:[{title:n("modal.buttons.download"),onClick:function(){e($(this),a,i)}}]})},_download:function(t,e,n){function i(n){n?(e.close(),INKIVE.C.IS_MOBILE&&a.onMobileBackMenu()):t.removeClass("disabled"),o.close()}var a=this.tool;t.addClass("disabled");var o=INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_bold",{message:"modal.alert.preparing_file"}),{skip:!1,loader:!0});INKIVE.EditorFacade.handle("page","save").then(function(){n.download(i)})}},Backbone.Events)},{}],50:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.canvas=this.tool.editor.canvas},undo:function(){this.canvas.undoMgr.undo()},redo:function(){this.canvas.undoMgr.redo()}},Backbone.Events)},{}],51:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas},filter:function(t){$("<div>").filterpicker({$svgImageElement:$(t)}).trigger("click")},crop:function(e,n){if(n=n||{},$(e).hasClass("layoutBox"))n.clip_path&&this._resizeClipPaht(e,n);else{e=this._convertToLayoutBox(e,n),this.canvas.call("advice.show","convert-to-layout-box");var i=10,a=setInterval(function(){$("symbol#arrow circle").attr("fill",i%2?"#ffdd17":"#ffffff"),i--||clearInterval(a)},400);this.canvas.addToSelection([e],!0)}if(!n.quiet){var o=t("../editor"),r=o.handle("zoom","get");_.defer(_.bind(function(){this._fitZoomToImageSize(o,e),this.canvas.runExtensions("showLayoutClipper",{layout:e,callback:_.partial(o.handle,"zoom","set",{zoom:r})})},this))}},_resizeClipPaht:function(t,e){var n=svgedit.utilities.getClipPath(t),i=n.childNodes[0];i.setAttribute("x",e.clip_path.x),i.setAttribute("y",e.clip_path.y),i.setAttribute("width",e.clip_path.width),i.setAttribute("height",e.clip_path.height)},_convertToLayoutBox:function(t,e){var n=this.canvas.getBBox(t),i=e.clip_path||n,a=t.getAttribute("id"),o=t.getAttribute("xlink:href"),r=this.canvas.addSvgElementFromJson({element:"rect",curStyles:!1,attr:{x:i.x,y:i.y,id:this.canvas.getNextId(),width:i.width,height:i.height}});svgedit.history.UndoManager.prototype.toggleUndoStackLock(!0),$(t).remove(),svgedit.history.UndoManager.prototype.toggleUndoStackLock(!1),t=this.canvas.runExtensions("addLayoutBox",{elem:r,clipPathBB:i,"xlink:href":o});var s=e.scale||1.2,l=n.width*s,c=n.height*s;return this.trigger("rename."+a,{id:t.getAttribute("id")}),t.setAttribute("width",l),t.setAttribute("height",c),t.setAttribute("x",n.x-(l-n.width)/2),t.setAttribute("y",n.y-(c-n.height)/2),$(t).addClass("layoutBox"),t},_fitZoomToImageSize:function(t,e){function n(){var t=e.getBoundingClientRect(),n=$("#svgcanvas")[0].getBoundingClientRect();return t.width<n.width&&t.height<n.height}var i=svgedit.utilities.getBBox(e);n()||t.handle("zoom","fit",svgedit.utilities.getBBox(e)),i&&t.handle("zoom","center",{x:i.x+i.height/2,y:i.y+i.width/2})}},Backbone.Events)},{"../editor":45}],52:[function(t,e,n){var i=t("../../../app/decorate"),a=t("../../../ui/editor-mode-manager");e.exports=i(t("../app/page"),_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas},unload:function(e){var n=t("../editor");e=e||{},e.page_number=e.page_number||INKIVE.Tool._current_page_id,e.remove_from_cache&&n.handle("cache","remove",e.page_number),INKIVE.Tool._current_page_id==e.page_number&&(INKIVE.Tool._current_page_id=0)},moveTo:function(t){function e(){this._moveTo(t.page_number).then(function(){t.quiet||INKIVE.Modal.togglePageLoader(!1),a.resolve()})}var n=INKIVE.Tool._current_page_id,i=n&&t.save!==!1,a=$.Deferred();return this.canvas.clearSelection(),t.page_number==n?(INKIVE.C.IS_MOBILE&&$("#pages-panel").height()&&this.tool.onMobileBackMenu(),a.resolve(),a.promise()):(t.quiet||INKIVE.Modal.togglePageLoader(!0),i||e.call(this),i&&this.save({quiet:!0}).then(_.bind(e,this)),a.promise())},save:function(t){t=t||{quiet:!1};var e=$.Deferred(),n=this.editor.getSvgString(),i=this.canvas.getCurrentDrawing().getCurrentLayer(),o=_.contains(["template","sticker","banner","placeholder"],a.getMode());return o?(t.quiet||INKIVE.Modal.togglePageLoader(!0),this.tool.save(null,function(){t.quiet||INKIVE.Modal.togglePageLoader(!1),e.resolve()}),e.promise()):INKIVE.Helpers.areEqual(n,INKIVE.EditorFacade.handle("cache","get"))||i&&"clipperImage"==i.getAttribute("class")?(e.resolve(),this.trigger("already_saved"),this.editor.canvas.call("advice.show","already-saved"),e.promise()):(t.quiet||INKIVE.Modal.togglePageLoader(!0),this.trigger("saving"),this.tool.savePage(t.quiet,_.bind(this._onSaved,this,t,e)),e.promise())},_onSaved:function(t,e,n){t.quiet||INKIVE.Modal.togglePageLoader(!1),n?(e.resolve(),this.trigger("saved")):(INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_default",{message:"modal.alert.save",try_again:!0})),e.reject())},_moveTo:function(t){var e=$.Deferred();return this.tool.load(t,_.bind(function(t){this.trigger("move_to"),INKIVE.C.IS_MOBILE&&this.tool.updateCurrentPageInfo(),INKIVE.C.IS_MOBILE&&$("#pages-panel").height()&&this.tool.onMobileBackMenu(),e.resolve()},this)),e.promise()}},Backbone.Events))},{"../../../app/decorate":7,"../../../ui/editor-mode-manager":102,"../app/page":44,"../editor":45}],53:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor},select:function(){this.editor.setMode("select")},fhpath:function(){this.editor.setMode("fhpath")},square:function(){this.editor.setMode("square")},rect:function(){this.editor.setMode("rect")},circle:function(){this.editor.setMode("circle")},ellipse:function(){this.editor.setMode("ellipse")},line:function(){this.editor.setMode("line")}},Backbone.Events)},{}],54:[function(t,e,n){e.exports=_.extend({initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas,this.zoomIncrement=.05,this.zoomLowLimit=.3,this.zoomHightLimit=4},get:function(){return this.canvas.getZoom()},set:function(t){t&&this.canvas.setZoom(t.zoom)},fit:function(t){t=t||{width:this.canvas.contentW,height:this.canvas.contentH};var e=$(this.curConfig.workarea).width(),n=$(this.curConfig.workarea).height(),i=INKIVE.C.IS_MOBILE?5:90,a=parseFloat(t.width)+i,o=parseFloat(t.height)+i,r=e/a,s=n/o,l=r>s?s:r;this.canvas.setZoom(this.getForcedZoomLimits(l))},center:function(t){var e=this.canvas.getZoom(),n={top:t.y*e,left:t.x*e},i={top:$(this.curConfig.workarea).height()/2,left:$(this.curConfig.workarea).width()/2},a=$("#ik-editor > .antiscroll-inner");a.scrollTop(n.top-i.top),a.scrollLeft(n.left-i.left)},original:function(){this.canvas.setZoom(1)},"in":function(){var t=this.canvas.getZoom(),e=this.getZoomProportions();t+=this.zoomIncrement*e.avg*t,this.canvas.setZoom(this.getForcedZoomLimits(t,e))},out:function(){var t=this.canvas.getZoom(),e=this.getZoomProportions();t-=this.zoomIncrement*e.avg*t,this.canvas.setZoom(this.getForcedZoomLimits(t,e))},getForcedZoomLimits:function(t,e){e=e||this.getZoomProportions();var n=this.zoomIncrement*e.avg*this.canvas.getZoom();return e.avg*t>=this.zoomHightLimit?t-=n:e.hight*t<=this.zoomLowLimit&&1>t&&(t+=n),t},getZoomProportions:function(){var t=$(this.curConfig.workarea).width(),e=$(this.curConfig.workarea).height(),n=this.canvas.contentW/t,i=this.canvas.contentH/e;return{low:i>n?n:i,hight:n>i?n:i,avg:(n+i)/2}}},Backbone.Events)},{}],55:[function(t,e,n){var i=t("../../editor/editor"),a=t("../../design/design");e.exports=_.extend({initialize:function(){_.bindAll(this,"_onAdd","add","_onRemove","remove"),this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor},remove:function(t){var e=$.Deferred(),n={page:t.page_number||INKIVE.Tool._current_page_id,scrapbookId:INKIVE.C.BOOK.id},i=_.partial(this._onRemove,t,e),a=_.partial(INKIVE.Helpers.api,"page/page","DELETE",n,i);return this.editor.canvas.clearSelection(),INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_span",{text:1==INKIVE.C.BOOK.num_pages?INKIVE.TranslateHelper.translate("modal.alert.can_delete_last"):INKIVE.TranslateHelper.translate("modal.alert.delete_page",{page_number:t.page_number,is_current_page:INKIVE.Tool._current_page_id==t.page_number})}),{callback:[a,function(){e.reject()}]}),e.promise()},_onRemove:function(t,e,n){n&&"success"==n.status?1!=INKIVE.C.BOOK.num_pages||INKIVE.C.IS_MOBILE_APP?(INKIVE.C.BOOK.num_pages--,this.trigger("removed",t),INKIVE.Tool._current_page_id==t.page_number?i.handle("page","move_to",{page_number:t.page_number+1>=INKIVE.C.BOOK.num_pages?1:t.page_number+1}).then(function(){e.resolve()}):e.resolve()):window.location=INKIVE.EditorModeManager.isMode("logo")?BASE_URL+"library":BASE_URL:e.reject()},add:function(t){var e=$.Deferred(),n=this.editor.canvas;t=_.extend({page_number:parseInt(INKIVE.C.BOOK.num_pages)+1,size:{width:n.contentW,height:n.contentH}},t);var i=INKIVE.C.BASE_URL+"inkiveeditor/addPage/"+INKIVE.C.BOOK.id+"/"+t.page_number;return n.clearSelection(),INKIVE.Modal.togglePageLoader(!0),$.get(i,null,_.partial(this._onAdd,t,e)),e.promise()},_onAdd:function(t,e,n){INKIVE.Modal.togglePageLoader(!1),n=$.parseJSON(n),"success"==n.status?(INKIVE.C.BOOK.num_pages++,i.handle("cache","clear"),this.trigger("added",t),i.handle("page","move_to",{page_number:n.data.now}).then(_.debounce(function(){a.set("template",{size:t.size}),e.resolve()},0))):e.reject()}},Backbone.Events)},{"../../design/design":19,"../../editor/editor":45}],56:[function(t,e,n){function i(){this.handlers={design:t("./handlers/design")}}var a=t("../abstract/facade");i.prototype=new a,i.prototype.constructor=i,e.exports=new i},{"../abstract/facade":11,"./handlers/design":55}],57:[function(t,e,n){function i(t,e){var n=e.match(/Check$/)||e.match(/CheckOnce$/);if(!n){var i=o[e+"Check"],s=o[e+"CheckOnce"];s?s.call(this)&&(this[e]=t):i?this[e]=_.partial(a,i,t,r.prototype[e]):this[e]=t}}function a(t,e,n){var i=t.call(this);i&&e.apply(this,_.rest(arguments,3)),i||n&&n.apply(this,_.rest(arguments,3))}var o,r;e.exports=function(e,n){if("3"==INKIVE.C.BOOK.book_type){r=n,o=e;var a={restrictionsFacade:t("./restrictions")};return _.each(o,i,a),n.extend?n.extend(a):_.extend({},n,a)}return n}},{"./restrictions":62}],58:[function(t,e,n){function i(){}var a=t("../../factory/user-info");t("./menu-actions.json");i.prototype.initialize=function(){var t=$.Deferred();return a.get().then(_.bind(function(e){var n={username:e.user_token,password:e.user_hash};this.loadDesignInfo(n).then(_.bind(this.loadTemplatePermissions,this,n)).then(t.resolve)},this)),t.promise()},i.prototype.loadDesignInfo=function(t){var e=Backbone.Model.extend({url:INKIVE.C.DESYGNER_BUSINESS+"api/brand/designs/"+INKIVE.C.BOOK.encodedId}),n=new e;return n.credentials=t,n.fetch()},i.prototype.loadTemplatePermissions=function(t,e){var n=INKIVE.C.DESYGNER_BUSINESS+"api/brand/permission/",i=Backbone.Model.extend({url:n+"templatepermissions/"+e.template}),a=Backbone.Collection.extend({url:n+"elementpermissions?me&template="+e.template});return this.templatePermissions=new i,this.elementsPermissions=new a,this.templatePermissions.credentials=t,this.elementsPermissions.credentials=t,$.when(this.templatePermissions.fetch(),this.elementsPermissions.fetch())},i.prototype.constructor=i,e.exports=i},{"../../factory/user-info":81,"./menu-actions.json":61}],59:[function(t,e,n){e.exports={initialize:function(t){this.permissionsFactory=t}}},{}],60:[function(t,e,n){e.exports={initialize:function(t){this.canvas=INKIVE.Tool.getInstance().editor.canvas,this.permissionsFactory=t},restrictMovement:function(t,e,n){var i=e[0];return i?{x:i.horizontal?n.x:0,y:i.vertical?n.y:0}:n},restrictMargin:function(t,e,n){var i=e[0];if(!i)return"undefined"!=typeof n.x?n.y:n.x;var a=i.size,o=svgedit.utilities.getBBox(t),r=n.x,s=n.y;return o.x+n.x<a?r=a-o.x:o.x+o.width+n.x>this.canvas.contentW-a&&(r=this.canvas.contentW-a-o.x-o.width),o.y+n.y<a?s=a-o.y:o.y+o.height+n.y>this.canvas.contentH-a&&(s=this.canvas.contentH-a-o.y-o.height),{x:r,y:s}}}},{}],61:[function(t,e,n){e.exports={text:{TEXT_EDITING:["text_change_content"],INCREASE:["text_size"],DECREASE:["text_size"],UNLOCK:["text_position"],DUPLICATE:["text_duplication"],REMOVE:["text_deletion"],TEXT_FONTFAMILY:["text_font_family"],TEXT_FONTSIZE:["text_font_size"],OPACITY:["text_opacity"],FILL_COLOR:["text_colour"],TEXT_BOLD:["text_decoration"],TEXT_ITALIC:["text_decoration"],TEXT_UNDERLINE:["text_decoration"],TEXT_CASE:["text_change_content"],TEXT_BULLETS:["text_decoration"],TEXT_ALIGN:["text_alignment"],LOCK:["text_position"],ORDER:["text_z_index"],ROTATE_LEFT:["text_rotation"],ROTATE_RIGHT:["text_rotation"],TEXT_TYPING:["text_change_content"],ALIGNMENT:["text_position"],TEXT_SPACING:["text_spacing"]},image:{INCREASE:["image_size"],DECREASE:["image_size"],UNLOCK:["image_position"],DUPLICATE:["image_duplication"],REMOVE:["image_deletion"],IMAGE_REPOSITION:["image_crop"],IMAGE_FILTER:["image_filter"],OPACITY:["image_opacity"],LOCK:["image_position"],LOCK_IMAGE:["image_replace"],UNLOCK_IMAGE:["image_replace"],ORDER:["image_z_index"],ROTATE_LEFT:["image_rotation"],ROTATE_RIGHT:["image_rotation"],ALIGNMENT:["image_position"]},vector:{INCREASE:["vector_size"],DECREASE:["vector_size"],UNLOCK:["vector_position"],DUPLICATE:["vector_duplication"],REMOVE:["vector_deletion"],OPACITY:["vector_opacity"],FILL_COLOR:["vector_colour"],STROKE_COLOR:["vector_stroke"],STROKE:["vector_stroke"],FLIP_H:["vector_rotation"],FLIP_V:["vector_rotation"],LOCK:["vector_position"],ORDER:["vector_z_index"],ROTATE_LEFT:["vector_rotation"],ROTATE_RIGHT:["vector_rotation"],ALIGNMENT:["vector_position"]},"default":{INCREASE:["element_size"],DECREASE:["element_size"],UNLOCK:["element_position"],DUPLICATE:["element_duplication"],REMOVE:["element_deletion"],GROUP_UNGROUP:["element_ungrouping"],OPACITY:["element_opacity"],LOCK:["element_position"],ORDER:["element_z_index"],ROTATE_LEFT:["element_rotation"],ROTATE_RIGHT:["element_rotation"],ALIGNMENT:["element_position"],GROUP_GROUP:["element_grouping"],IMAGE_BOX:["image_content"],FILL_COLOR:["element_colour"],STROKE_COLOR:["vector_stroke"],STROKE:["vector_stroke"],FLIP_H:["element_rotation"],FLIP_V:["element_rotation"]}}},{}],62:[function(t,e,n){function i(){this.initialized=!1,this.handlers={vector:t("./handlers/vector"),text:t("./handlers/text")}}var a=t("./factory"),o=t("./menu-actions.json");i.prototype.initialize=function(){_.bindAll(this,"canChange","isFunctionalityAllowed","isActionAllowed","applyRestriction","_getElementRestrictions"),this.initialized=!0;var t=this.handlers,e=this.factory=new a,n=this.factory.initialize();return n.then(function(){_(t).each(function(t){t.initialize(e)})}),n},i.prototype.applyPreLoadRestrictions=function(t){return this.initialized?t:t},i.prototype.applyPostLoadRestrictions=function(t){return this.initialized?t:t},i.prototype.isFunctionalityAllowed=function(t){return this.initialized?this.factory.templatePermissions.get(t):!0},i.prototype.filterMenuOptions=function(t,e){if(!this.initialized)return e;var n=this.getType(t);return _(e).filter(function(e){return this.isActionAllowed(o[n][e],t)},this)},i.prototype.applyRestriction=function(t,e,n){if(!this.initialized)return n;var i=this.getType(t),a="restrict"+e.charAt(0).toUpperCase()+e.slice(1),o=this._getElementRestrictions(t.getAttribute("id"),e);return this.handlers[i]&&this.handlers[i][a]?this.handlers[i][a](t,o,n):(console.warn("Restriction handler not found: "+i+" > "+a),n)},i.prototype.canChange=function(t,e){var e=this.getType(t)+"_"+e;
return this.isActionAllowed(e,t)},i.prototype.isActionAllowed=function(t,e){function n(t){return _.any(t,function(t){return _.any(a,function(e){return"undefined"!=typeof e[t]})})}function i(t){return _.any(a,function(e){return _.every(t,function(t){return"undefined"==typeof e[t]||e[t]})})}if(!this.initialized||!e)return!0;t=_.isArray(t)?t:[t];var a=this._getElementRestrictions(e.getAttribute("id"));return n.call(this,t)?i(t):_.every(t,function(t){return this.factory.templatePermissions.get(t)},this)},i.prototype.getType=function(t){return t?$(t).is(".group")?"element":$(t).is(".textarea")?"text":$(t).is(".sticker")?"vector":$(t).is("image")?"image":"vector":void 0},i.prototype._getElementRestrictions=function(t,e){return e=e||"basic",_.chain(this.factory.elementsPermissions.filter({element_id:t})).map(function(t){return JSON.parse(t.get("restrictions"))[e]}).compact().value()},i.prototype.constructor=i,e.exports=new i},{"./factory":58,"./handlers/text":59,"./handlers/vector":60,"./menu-actions.json":61}],63:[function(t,e,n){function i(){this.baseUrl=INKIVE.C.BASE_URL+"api/"}e.exports=i,i.prototype=_.extend({},Backbone.Events),i.prototype.api=function(t,e,n){n=n||e?"POST":"GET";var i=$.Deferred();return $.ajax({type:n,url:this.baseUrl+t,data:e,success:function(t){i.resolve(t)},error:function(){i.reject("API call error")}}),i.promise()},i.prototype.init=function(){function t(t){return _.isArray(t)?_.toArray($.extend(!0,{},t)):$.extend(!0,{},t)}var e=$.Deferred();return this.data?e.resolve(t(this.data)):this.api(this.resource).then(_.bind(function(n){this.data=n,e.resolve(t(n))},this),function(t){e.reject(t+" | API Init error")}),e.promise()}},{}],64:[function(t,e,n){function i(t){var e=$('<style type="text/css">');_.each(t,function(t){e.append(c({family:t.data.family,sources:_(t.data.sources).indexBy("type")}))}),$("head").prepend(e)}function a(t,e){return _.map(e,function(e){return{family:e.data.family,support:{b:!0,bi:!0,i:!0,w:{}},customOwner:t.data.user_id}})}function o(t,e){var n={};e&&_.each(e,function(t){var e=t.data.family;n[e]=n[e]||0,n[e]++});var i=_.map(t,function(t,e){return{family:e,support:t}});return _.sortBy(i,function(t){return-(n[t.family]||0)})}var r,s=t("./library"),l=t("./user-info"),c=t("./library/font-template.hbs");e.exports={initialize:function(){l.get().then(function(t){var e=_(t.roles).contains("ROLE_LIBRARY"),n=_(t.roles).contains("ROLE_INDEPENDENT");if(e)if(n){var l=s.get("texts"),c=s.get("fonts");$.when(c,l).then(function(e,n){i(e),r=_.union(a(t,e),o(INKIVE.C.FONT_LIST,n))})}else s.get("texts").then(function(t,e){r=o(INKIVE.C.FONT_LIST,e)});else r=o(INKIVE.C.FONT_LIST)})},get:function(){return r}}},{"./library":67,"./library/font-template.hbs":70,"./user-info":81}],65:[function(t,e,n){function i(){this.resource="management/formatgroups"}var a=t("./api");i.prototype=new a,i.prototype.init=_.memoize(a.prototype.init),i.prototype.getGroup=function(t){var e=$.Deferred();return this.getGroups([t]).then(function(t){e.resolve(t[0])},function(t){e.reject(t+" | Formats GetGroup error")}),e.promise()},i.prototype.getGroups=function(t){var e=$.Deferred();return this.init().then(function(n){t?e.resolve(_.filter(n,function(e){return _.any(t,function(t){return t==e.key})})):e.resolve(n)},function(t){e.reject(t+" | Formats GetGroups error")}),e.promise()},i.prototype.getFormat=function(t){var e=$.Deferred();return this.getFormats([t]).then(function(t){e.resolve(t[0])},function(t){e.reject(t+" | Formats GetFormat error")}),e.promise()},i.prototype.getFormats=function(t){var e=$.Deferred();return this.init().then(function(n){var i=_.flatten(_.map(n,function(t){return t.data}));t?e.resolve(_.filter(i,function(e){return _.any(t,function(t){return t==e.string_id||t==e.id})})):e.resolve(i)},function(t){e.reject(t+" | Formats GetFormats error")}),e.promise()},i.prototype.getFormatsBasedOnSize=function(t){var e=$.Deferred();return this.getFormats().then(function(n){var i=INKIVE.Helpers.convertUnitsToPixels;e.resolve(_.filter(n,function(e){var n=i(e.width,e.unit),a=i(e.height,e.unit);return t.width===n&&t.height===a}))},function(t){e.reject(t+" | Formats GetFormatsBasedOnSize error")}),e.promise()},i.prototype.getCurrentFormat=function(t){function e(){var t=$("#svgcontent > g.main").attr("class");return t?(t=_.find(t.split(" "),function(t){return t.match(/format-id-[\d+]/)}),t?t.split("-")[2]:null):null}var n=$.Deferred(),i=INKIVE.Tool.getInstance(),a=i.editor.canvas,o=e()||INKIVE.Helpers.getFragmentParam("filter"),t={width:a.contentW,height:a.contentH},r=INKIVE.Helpers.convertUnitsToPixels;return o?$.when(this.getFormat(o),this.getFormatsBasedOnSize(t)).then(function(e,i){if(e){var a=r(e.width,e.unit),o=r(e.height,e.unit);n.resolve(a==t.width&&o==t.height?e:i[0])}else n.resolve(i[0])}):this.getFormatsBasedOnSize(t).then(function(t){n.resolve(t[0])}),n.promise()},e.exports=new i},{"./api":63}],66:[function(t,e,n){function i(){this.imagesData={}}i.prototype={convertFormats:["/thumb/","/mobile/","/tab/","/web/","/largeweb/","/original/"],defaultAmazonDataNames:{name:"name",thumb:"thumb",mobile:"mobile",tab:"tab",web:"web",largeweb:"largeweb",original:"original"},defaultAmazonVersionDataNames:{name:"name",thumb:"version.thumb",mobile:"version.mobile",tab:"version.tab",web:"version.web",largeweb:"version.largeweb",original:"version.original"},defaultAPIDataNames:{name:"name",thumb:"src",mobile:"src_mobile",tab:"src_tab",web:"src_web",largeweb:"src_big",original:"src_big"},getFacebookPhotos:function(t,e){this.sendCommand("load/photos/facebook",t,_.bind(function(t){if(t=$.parseJSON(t),INKIVE.Helpers.isResponseExists(t)){var n=this.setFacebookImagesData(t);e(!0,n,t)}else e(!1)},this))},setFacebookImagesData:function(t){var e={};return _.each(t,function(t){_.extend(e,this.setImagesData(t.data,"fb"))},this),e},getDropboxPhotos:function(t,e){this.fetchGenericData("load/photos/dropbox",t,e,"db")},getGooglePhotos:function(t,e){this.fetchGenericData("load/photos/google",t,e,"go")},getFlickerPhotos:function(t,e){this.fetchGenericData("load/photos/flickr",t,e,"fl")},getInstagramPhotos:function(t,e){this.fetchGenericData("load/photos/instagram",t,e,"in")},fetchGenericData:function(t,e,n,i){this.sendCommand(t,e,_.bind(function(t){if(t=$.parseJSON(t),INKIVE.Helpers.isResponseExists(t)){var e=this.setImagesData(t,i);n(!0,e,t)}else n(!1)},this))},getOriginalUrl:function(t){function e(){var e=null!==t.match(/^((http|https):\/\/s3.amazonaws.com)/);return e?(_.each(n,function(e){t=t.replace(e,"/original/")}),t):null}if(t){if(this.imagesData[t])return t;var n=this.convertFormats,i=_.find(this.imagesData,function(e){return _.contains(e.version,t)});return i?i.version.original:e()}},getVersionUrl:function(t,e){if(t){var n=_.find(this.imagesData,function(e){return _.contains(e.version,t)});if(n)return n.version[e];var i=null!==t.match(/^((http|https):\/\/s3.amazonaws.com)/);return i&&_.each(this.convertFormats,function(n){t=t.replace(n,"/"+e+"/")}),t}},getRightSizeUrl:function(e,n){function i(){function t(t){var e=this.getAttribute(a,o[t]+"_height"),n=this.getAttribute(a,o[t]+"_width");return e&&n?{name:t,width:parseInt(n),height:parseInt(e)}:void 0}var n=[{name:"thumb",width:168,height:168},{name:"mobile",width:499,height:499},{name:"tab",width:800,height:800},{name:"web",width:1200,height:1200},{name:"largeweb",width:2500,height:2500},{name:"original",width:1/0,height:1/0}],i=this.getOriginalUrl(e)||e,a=this.getImageOriginalData(i);if(a){var o=this.imagesData[i].attributesNames,r=_.compact(_.map(["thumb","mobile","tab","web","largeweb"],t,this));if(r.length)return r.push({name:"original",width:1/0,height:1/0}),r}return n}var a=t("../facade/editor/editor"),o=a.handle("zoom","get"),r=i.call(this),s=n.width*o,l=n.height*o,c=_.find(r,function(t){return s<t.width&&l<t.height});return c?this.getVersionUrl(e,c.name):e},getImageDataFromData:function(t,e){var n=this.getAttribute(t,e.original),i=this.imagesData[n]||{};return{name:this.getAttribute(t,e.name),stored:i.stored||!1,originalData:t,attributesNames:e,version:{web:this.getAttribute(t,e.web),tab:this.getAttribute(t,e.tab),thumb:this.getAttribute(t,e.thumb),mobile:this.getAttribute(t,e.mobile),largeweb:this.getAttribute(t,e.largeweb),original:n}}},getAttribute:function(t,e){if(t&&e){for(var n=e.split("."),i=t;i&&n[0];)i=i[n.shift()];return i}},getImageOriginalData:function(t){var e=this.getOriginalUrl(t),n=this.imagesData[e];return n&&n.originalData},getImageOriginalSizeData:function(t,e){function n(){s||(clearInterval(u),s=!0,l.onload=l.onerror=$.noop,e({width:c?l.naturalWidth:l.width,height:c?l.naturalHeight:l.height}),l.src="")}function i(){var t=l.naturalWidth||l.width>50;t&&n()}var a=this.getOriginalUrl(t),o=this.imagesData[a];if(o){var r=o.originalData;if(r.original_width&&r.original_height)return void e({width:parseFloat(r.original_width),height:parseFloat(r.original_height)})}var s,l=new Image,c="naturalWidth"in l,u=setInterval(i,100);l.onload=n,l.src=a},storeImageData:function(t){var e=this.getOriginalUrl(t),n=this.imagesData[e];if(n&&!n.stored&&n.loadType){var i={scrapbookId:INKIVE.C.BOOK.id,images:JSON.stringify(n.originalData),loadType:n.loadType};this.sendCommand("inkiveeditor/storeImageData",i,function(){n.stored=!0})}},setImagesData:function(t,e,n){var i={};return n=n?n:e?this.defaultAPIDataNames:this.defaultAmazonDataNames,_.each(t,function(t){var a=this.getImageDataFromData(t,n);e&&(a.loadType=e);var o=a.version.original;i[o]=this.imagesData[o]=a},this),i},addImageData:function(t,e){e=e||this.defaultAmazonVersionDataNames;var n=this.getImageDataFromData(t,e),i=n.version.original;this.imagesData[i]=n},smartLoad:function(t,e,n){function i(){r++,a>=r?_.delay(_.bind(function(){s.src=a>r?l:this.getOriginalUrl(t)},this),o):n(INKIVE.C.Status.timeout,s)}var a=4,o=5e3,r=0,s=new Image,l=this.getRightSizeUrl(t,e);s.onerror=_.bind(i,this),s.onload=_.partial(n,INKIVE.C.Status.success,s),s.src=l},sendCommand:function(t,e,n){console.warn("Images Factory: Called old sendCmd: "+t),$.ajax({url:INKIVE.C.BASE_URL+t,type:"POST",data:e,dataType:"json",complete:function(t){n(t.responseText)}})}},e.exports=new i},{"../facade/editor/editor":45}],67:[function(t,e,n){function i(){_.bindAll(this,"initialize","get","_collectionFetch","cacheClear"),this.collections={},this.cache={}}var a=t("./user-info"),o={colors:t("./library/color-model"),texts:t("./library/text-model"),images:t("./library/image-model"),logos:t("./library/logo-model"),fonts:t("./library/font-model")};i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=_.memoize(function(){var t=$.Deferred();return a.get().then(_.bind(function(e){this.credentials={username:e.user_token,password:e.user_hash},t.resolve()},this)),t.promise()}),i.prototype.get=function(t,e){var n=$.Deferred();return this.initialize().then(_.partial(this._collectionFetch,t)).then(_.bind(function(){var i=e?this.collections[t].filter(function(t){var n=t.get("data");return _.all(e,function(e,i){return n[i]===e||t.get(i)===e})}):this.collections[t].toArray();n.resolve(_(i).map(function(t){return t.toJSON()}))},this)),n.promise()},i.prototype.cacheClear=function(t){this.cache=_(this.cache).omit(t)},i.prototype._collectionFetch=function(t){return this.cache[t]?this.cache[t]:(this.collections[t]||this._initCollection(t),this.cache[t]=this.collections[t].fetch(),this.cache[t])},i.prototype._initCollection=function(t){var e=Backbone.Collection.extend({model:o[t],url:INKIVE.C.DESYGNER_BUSINESS+"api/library/"+t});this.collections[t]=new e,this.collections[t].credentials=this.credentials},e.exports=new i},{"./library/color-model":68,"./library/font-model":69,"./library/image-model":71,"./library/logo-model":72,"./library/text-model":73,"./user-info":81}],68:[function(t,e,n){var i=t("../../../../bower_components/tinycolor/tinycolor");e.exports=Backbone.Model.extend({url:function(){return this.id?"api/library/colors/"+this.id:"api/library/colors"},parse:function(t){var e=parseInt(t.data.color_code/65536),n=parseInt((t.data.color_code-65536*e)/256),a=parseInt(t.data.color_code-65536*e-256*n),o=i("rgb("+a+","+n+","+e+")");return t.data.color_code=o.toHexString(),t.data.is_dark=o.isDark(),t},getServerModel:function(){var t=_(this.attributes).clone(),e=i(t.data.color_code).toRgb();return t.data=_(t.data).omit("is_dark"),t.data.color_code=65536*e.b+256*e.g+e.r,t},sync:function(){this.toJSON=this.getServerModel;var t=Backbone.sync.apply(this,arguments);return this.toJSON=Backbone.Model.prototype.toJSON,t}})},{"../../../../bower_components/tinycolor/tinycolor":2}],69:[function(t,e,n){e.exports=Backbone.Model.extend({url:function(){return this.id?"api/library/fonts/"+this.id:"api/library/fonts"}})},{}],70:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="\n        ";return r=null!=(r=n.woff2||(null!=e?e.woff2:e))?r:c,s={name:"woff2",hash:{},fn:t.program(2,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.woff2||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n        ",r=null!=(r=n.woff||(null!=e?e.woff:e))?r:c,s={name:"woff",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.woff||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n        ",r=null!=(r=n.svg||(null!=e?e.svg:e))?r:c,s={name:"svg",hash:{},fn:t.program(6,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.svg||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n        ",r=null!=(r=n.otf||(null!=e?e.otf:e))?r:c,s={name:"otf",hash:{},fn:t.program(8,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.otf||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n        ",r=null!=(r=n.ttf||(null!=e?e.ttf:e))?r:c,s={name:"ttf",hash:{},fn:t.program(10,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.ttf||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"\n    "},2:function(t,e,n,i,a){var o;return",url('"+t.escapeExpression((o=null!=(o=n.source||(null!=e?e.source:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"source",hash:{},data:a}):o))+"') format('woff2')"},4:function(t,e,n,i,a){var o;return",url('"+t.escapeExpression((o=null!=(o=n.source||(null!=e?e.source:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"source",hash:{},data:a}):o))+"') format('woff')"},6:function(t,e,n,i,a){var o;return",url('"+t.escapeExpression((o=null!=(o=n.source||(null!=e?e.source:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"source",hash:{},data:a}):o))+"') format('svg')"},8:function(t,e,n,i,a){var o;return",url('"+t.escapeExpression((o=null!=(o=n.source||(null!=e?e.source:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"source",hash:{},data:a}):o))+"') format('opentype')"},10:function(t,e,n,i,a){var o;return",url('"+t.escapeExpression((o=null!=(o=n.source||(null!=e?e.source:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"source",hash:{},data:a}):o))+"') format('truetype')"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h="@font-face {\n    font-family: '"+t.escapeExpression((r=null!=(r=n.family||(null!=e?e.family:e))?r:c,typeof r===u?r.call(l,{name:"family",hash:{},data:a}):r))+"';\n    src: local('☺')";return r=null!=(r=n.sources||(null!=e?e.sources:e))?r:c,s={name:"sources",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.sources||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(h+=o),h+";\n}\n"},useData:!0})},{"hbsfy/runtime":375}],71:[function(t,e,n){var i=t("../images");e.exports=Backbone.Model.extend({url:function(){return this.id?"api/library/images/"+this.id:"api/library/images"},parse:function(t){var e=t.data.source;return t.data.tab=e.replace("/original/","/tab/"),t.data.web=e.replace("/original/","/web/"),t.data.thumb=e.replace("/original/","/thumb/"),t.data.mobile=e.replace("/original/","/mobile/"),t.data.largeweb=e.replace("/original/","/largeweb/"),t.data.original=e,i.setImagesData({version:{src:t.data.thumb,src_web:t.data.web,src_tab:t.data.tab,src_mobile:t.data.mobile,src_big:t.data.largeweb,src_original:e}},"library"),t}})},{"../images":66}],72:[function(t,e,n){var i=t("../images");e.exports=Backbone.Model.extend({url:function(){return this.id?"api/library/logos/"+this.id:"api/library/logos"},parse:function(t){var e=t.data.source;return t.data.tab=e.replace("/original/","/tab/"),t.data.web=e.replace("/original/","/web/"),t.data.thumb=e.replace("/original/","/thumb/"),t.data.mobile=e.replace("/original/","/mobile/"),t.data.largeweb=e.replace("/original/","/largeweb/"),t.data.original=e,i.setImagesData({version:{src:t.data.thumb,src_web:t.data.web,src_tab:t.data.tab,src_mobile:t.data.mobile,src_big:t.data.largeweb,src_original:e}},"library"),t}})},{"../images":66}],73:[function(t,e,n){var i=t("./color-model");e.exports=Backbone.Model.extend({url:function(){return this.id?"api/library/texts/"+this.id:"api/library/texts"},parse:i.prototype.parse,getServerModel:i.prototype.getServerModel,sync:i.prototype.sync})},{"./color-model":68}],74:[function(t,e,n){function i(){this.data={},this.defaultSize=110,_.bindAll(this,"get","remove"),o.on("page.saved",_.bind(function(){this.remove(INKIVE.Tool._current_page_id)},this)),r.on("design.removed",_.bind(function(t){for(var e=INKIVE.C.BOOK.num_pages+1,n=parseInt(t.page_number);e>=n;n++)this.remove(n)},this))}function a(t){t=t.split(" ");var e=new Date;return INKIVE.C.BASE_URL+"design/displaythumbnail/"+t[0]+"/"+t[1]+"/"+t[2]+"?"+e.getTime()}var o=t("../facade/editor/editor"),r=t("../facade/project/project");i.prototype=_.extend({},Backbone.Events),i.prototype.get=function(t,e,n){var i=this.getId.apply(this,arguments);return this.data[i]=this.data[i]||a(i),this.data[i]},i.prototype.remove=function(t,e){var n={};e=e||INKIVE.C.BOOK.id,_.each(this.data,function(i,a){var o=a.split(" "),r=o[0]==e,s=o[1]==t||"undefined"==typeof t;r&&s?this.notify.call(this,o[1],o[2],o[0]):n[a]=i},this),this.data=n},i.prototype.notify=function(t,e,n){var i=this.getId.apply(this,arguments).split(" ");this.trigger("update",{bookId:i[0],pageNumber:i[1],size:i[2]}),this.trigger("update."+i[0],{bookId:i[0],size:i[2]}),this.trigger("update."+i[0]+" "+i[1],{size:i[2]}),this.trigger("update."+i[0]+" "+i[1]+" "+i[2])},i.prototype.getId=function(t,e,n){return e=e||this.defaultSize,t=t||INKIVE.Tool._current_page_id,n=n||INKIVE.C.BOOK.id,n+" "+t+" "+e},e.exports=new i},{"../facade/editor/editor":45,"../facade/project/project":56}],75:[function(t,e,n){function i(){_.bindAll(this,"initialize","get","_collectionFetch","saveTemplateRestrictions"),this.collections={},this.cache={},this.debouncedSaveElementRestrictions=_.debounce(this.saveElementRestrictions,5e3),this.debouncedSaveTemplateRestrictions=_.debounce(this.saveTemplateRestrictions,5e3)}var a,o=t("./user-info"),r={groups:t("./restrictions/group-model"),"permission/templatepermissions":t("./restrictions/templatepermissions-model"),"permission/elementpermissions":t("./restrictions/elementpermissions-model")};i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=_.memoize(function(){var t=$.Deferred();return o.get().then(_.bind(function(e){this.credentials={username:e.user_token,password:e.user_hash};var n="api/brand/templates/"+INKIVE.C.BOOK.encodedId,i=Backbone.Model.extend({url:INKIVE.C.DESYGNER_BUSINESS+n}),o=new i;o.credentials=this.credentials,o.fetch().then(_.bind(function(e){e?(a=e,this._collectionFetch("permission/templatepermissions").then(t.resolve)):t.reject("Access not granted")},this))},this)),t.promise()}),i.prototype.cacheClear=function(t){this.cache=_(this.cache).omit(t)},i.prototype.setTemplateRestriction=function(t,e,n){function i(){var e=$.Deferred(),n=this.collections["permission/templatepermissions"].find(function(e){return e.get("group")==t});return n&&e.resolve(n),n||o.call(this,e),e.promise()}function o(e){var n=this.collections["permission/templatepermissions"].create(_.extend(_.omit(r.template,"id"),{group:parseInt(t),template:a.id}));n.on("change:id",_.bind(e.resolve,this,n))}var r=this.getGroupDefaults(t),s=$.Deferred();return r||s.reject(),r&&i.call(this).then(_.bind(function(t){t.set(e,n),this.debouncedSaveTemplateRestrictions(t),s.resolve()},this)),s.promise()},i.prototype.setElementRestriction=function(t,e,n){function i(){var n=$.Deferred(),i=this.collections["permission/elementpermissions"].find(function(n){return n.get("group")==t&&n.get("element_id")==e});return i&&n.resolve(i),i||o.call(this,n),n.promise()}function o(i){var o=this.collections["permission/elementpermissions"].create({element_id:e,template:a.id,group:parseInt(t),restrictions:n});o.on("change:id",_.bind(i.resolve,this,o))}var r=$.Deferred();return i.call(this).then(_.bind(function(t){t.set("restrictions",n),this.debouncedSaveElementRestrictions(t),r.resolve()},this)),r.promise()},i.prototype.saveElementRestrictions=function(t){function e(){this.collections["permission/elementpermissions"].each(function(e){e!=t&&e.get("element_id")==i&&e.get("group")==n&&_.defer(e.destroy)})}var n=t.get("group"),i=t.get("element_id"),a=t.get("restrictions")&&_.size(JSON.parse(t.get("restrictions")));e.call(this),a||t.destroy(),a&&t.save()},i.prototype.getGroupDefaults=function(t){var e=this.collections.groups.find(function(e){return e.id==t});return e&&e.get("permissions")},i.prototype.saveTemplateRestrictions=function(t){function e(){this.collections["permission/templatepermissions"].each(function(e){e.get("group")==i&&e!=t&&_.defer(e.destroy)})}function n(e){return!_.chain(e).omit("id","group","static").any(function(e,n){return t.get(n)!=e}).value()}var i=t.get("group"),a=this.getGroupDefaults(i),o=n(a.template);e.call(this),o&&!t.get("sticky")&&t.destroy(),o||t.save()},i.prototype.remove=function(t,e){var n=_.partial(this._collectionFetch,t);this.initialize().then(n).then(_.bind(function(){var n=this.collections[t].find(function(t){return t.id==e});n&&n.destroy()},this))},i.prototype.get=function(t){var e=$.Deferred(),n=_.partial(this._collectionFetch,t);return this.initialize().then(n).then(_.bind(function(){e.resolve(this.collections[t].toJSON())},this)),e.promise()},i.prototype._collectionFetch=function(t){return this.cache[t]?this.cache[t]:(this.collections[t]||this._initCollection(t),this.cache[t]=this.collections[t].fetch())},i.prototype._initCollection=function(t,e){e=e||"?template="+a.id;var n=Backbone.Collection.extend({model:r[t],url:INKIVE.C.DESYGNER_BUSINESS+"api/brand/"+t+e});this.collections[t]=new n,this.collections[t].credentials=this.credentials},e.exports=new i},{"./restrictions/elementpermissions-model":76,"./restrictions/group-model":77,"./restrictions/templatepermissions-model":78,"./user-info":81}],76:[function(t,e,n){e.exports=Backbone.Model.extend({url:function(){return INKIVE.C.DESYGNER_BUSINESS+(this.id?"api/brand/permission/elementpermissions/"+this.id:"api/brand/permission/elementpermissions")}})},{}],77:[function(t,e,n){e.exports=Backbone.Model.extend({url:function(){return INKIVE.C.DESYGNER_BUSINESS+(this.id?"api/brand/groups/"+this.id:"api/brand/groups")}})},{}],78:[function(t,e,n){e.exports=Backbone.Model.extend({url:function(){return INKIVE.C.DESYGNER_BUSINESS+(this.id?"api/brand/permission/templatepermissions/"+this.id:"api/brand/permission/templatepermissions")}})},{}],79:[function(t,e,n){function i(){this.resource="inkiveeditor/updateSettings",this.baseUrl=INKIVE.C.BASE_URL}var a=t("./api");i.prototype=new a,i.prototype.set=function(t){var e=$.Deferred();return this.data?e.resolve(this.data):this.api(this.resource,{idInkive:INKIVE.C.BOOK.id,data:_.map(t,function(t,e){return{name:e,value:t}})}).then(_.bind(function(){var n=["name","description"];_.each(t,function(t,e){INKIVE.C.BOOK[e]=_.contains(n,e)?Base64.encode(t):t}),this.trigger("update"),e.resolve()},this),function(t){e.reject(t+" | API Init error")}),e.promise()},e.exports=new i},{"./api":63}],80:[function(t,e,n){function i(){_.bindAll(this,"initialize","getCategories","get"),this.categories=[{key:"basic",icon:"fa fa-square-o"},{key:"animal",icon:"fa fa-bug"},{key:"arrow",icon:"fa fa-arrows"},{key:"dialog_balloon",icon:"fa fa-comments-o"},{key:"electronics",icon:"fa fa-microphone"},{key:"flowchart",icon:"fa fa-sitemap"},{key:"game",icon:"fa fa-gamepad"},{key:"math",icon:"fa fa-superscript"},{key:"misc",icon:"fa fa-fire-extinguisher"},{key:"music",icon:"fa fa-music"},{key:"object",icon:"fa fa-lightbulb-o"},{key:"symbol",icon:"fa fa-plus-square-o"},{key:"web",icon:"fa fa-rss"}]}var a=t("../modules/shapelib/basic.json");i.prototype=_.extend({},Backbone.Events),i.prototype.initialize=_.memoize(function(){var t=$.Deferred(),e=INKIVE.TranslateHelper.translate;return INKIVE.TranslateHelper.load().then(_.bind(function(){this.data={basic:this.mapResult("basic",a)},_.each(this.categories,function(t){t.name=e("shapes.category."+t.key)}),t.resolve()},this)),t.promise()}),i.prototype.getCategories=function(){var t=$.Deferred();return this.initialize().then(_.bind(function(){t.resolve(this.categories)},this)),t.promise()},i.prototype.get=function(t,e){var n=$.Deferred();return t="undefined"==typeof t?0:t,this.getCategories().then(_.bind(function(i){var a=i[t]||_.find(i,{key:t});this._getCategory(a).then(function(t){var i="undefined"==typeof e;if(i&&n.resolve(t),!i){var a=t[e]||_.find(t,{key:e});n.resolve(a)}})},this)),n.promise()},i.prototype._getCategory=function(t){var e=$.Deferred(),n=INKIVE.C.BASE_URL+"assets/js/editor/modules/shapelib/"+t.key+".json";return this.data[t.key]&&e.resolve(this.data[t.key]),this.data[t.key]||$.getJSON(n,_.bind(function(n){this.data[t.key]=this.mapResult(t.key,n),e.resolve(this.data[t.key])},this)),e.promise()},i.prototype.mapResult=function(t,e){var n=INKIVE.TranslateHelper.translate;return _.map(e.data,function(i){return _.extend({fill:e.fill||!1,size:e.size||300,name:n("shapes.names."+t+"."+i.key)},i)})},e.exports=new i},{"../modules/shapelib/basic.json":89}],81:[function(t,e,n){function i(){var t=$.Deferred();return $.getJSON(INKIVE.C.BASE_URL+"api/user/current",_.bind(function(e){t.resolve(e)},this)),t.promise()}var a;e.exports={get:function(t){return a&&!t?a:a=i()}}},{}],82:[function(t,e,n){function i(){var e=t("./ui/tool-menu/images/view"),n=t("./ui/tool-menu/text/view"),i=t("./ui/tool-menu/import/view"),a=t("./ui/tool-menu/customize/view"),o=t("./ui/tool-menu/templates/view"),r=t("./ui/tool-menu/settings/view"),s=t("./ui/tool-menu/admin/view"),l=t("./ui/tool-menu/library/view");if(window.INKIVE.Tabs={},window.INKIVE.Tabs.images=new e({el:"#tabImages"}),window.INKIVE.Tabs.text=new n({el:"#tabText"}),window.INKIVE.Tabs["import"]=new i({el:"#tabImport"}),window.INKIVE.Tabs.extra=new a({el:"#tabExtra"}),window.INKIVE.Tabs.layouts=new o({el:"#tabLayouts"}),window.INKIVE.Tabs.settings=new r({el:"#tabSettings"}),window.INKIVE.Tabs.admin=new s({el:"#tabAdmin"}),window.INKIVE.Tabs.library=new l({el:"#tabLibrary"}),$("#tabRestrictions").length){var c=t("./ui/tool-menu/restrictions/view");window.INKIVE.RestrictionsFactory=t("./factory/restrictions"),window.INKIVE.Tabs.restrictions=new c({el:"#tabRestrictions"})}}function a(){window.INKIVE.Tool=window.INKIVE.Tool||{},window.INKIVE.Helpers=window.INKIVE.Helpers||{},window.INKIVE.Helpers.mobileVersion=t("./app/version"),window.INKIVE.Helpers.cookieStorage=t("./utils/cookie-storage"),window.INKIVE.Helpers.imagesSanitize=t("./utils/images-sanitize"),window.INKIVE.SVGElementLoading=t("./SVGElementLoading"),INKIVE.C.IS_MOBILE_APP&&(window.AppBridge=t("./app/bridge")),t("./utils/ellipsis")(),t("./utils/backbone-mixin");var e=INKIVE.Tool.getInstance();e.editor.on("initialize",function(){var n=t("./utils/advice");n.initialize(e.editor.canvas)})}function o(){var e=t("../../translations/translate-helper");return window.INKIVE.TranslateHelper=new e("editor",INKIVE.C.BASE_URL+"assets/build/translations/client/",INKIVE.C.BUILD),_.bindAll(window.INKIVE.TranslateHelper,"translate"),INKIVE.TranslateHelper.load()}function r(){window.INKIVE.ModalHelp=t("./modal/help"),window.INKIVE.ModalAddPage=t("./modal/add-page"),window.INKIVE.ModalShareEmail=t("./modal/share-email"),window.INKIVE.ModalShareEmbed=t("./modal/share-embed"),window.INKIVE.ModalFriends=t("./modal/friends"),window.INKIVE.ModalDownload=t("./modal/download")}function s(){window.INKIVE.SVGPlaceholderImage=t("./thumb/placeholder")}function l(){t("./ui/filterpicker");var e=INKIVE.C.MODE.IS_DESYGNER&&!INKIVE.C.IS_MOBILE,n=t("./ui/stage-dnd");e&&n.init()}function c(){var e=t("hbsfy/runtime");window.INKIVE.TemplatesHelper=t("./ui/templates/templates-helper"),e.registerHelper("Desygner",function(t){return INKIVE.C.MODE.IS_DESYGNER?t.fn(this):t.inverse(this)}),e.registerHelper("Photobooky",function(t){return INKIVE.C.MODE.IS_DESYGNER?t.inverse(this):t.fn(this)}),e.registerHelper("Mobile",function(t){return INKIVE.C.IS_MOBILE?t.fn(this):t.inverse(this)}),e.registerHelper("Desktop",function(t){return INKIVE.C.IS_MOBILE?t.inverse(this):t.fn(this)}),e.registerHelper("low",function(t){return t.toLowerCase()}),e.registerHelper("upp",function(t){return t.toUpperCase()}),e.registerHelper("route",function(t){return INKIVE.C.BASE_URL+t}),e.registerHelper("eq",function(t,e,n){return t==e?n.fn(this):n.inverse(this)}),e.registerHelper("if_eq",function(t,e,n){return t==e?n.fn(this):n.inverse(this)}),e.registerHelper("math",function(t,e,n,i){return t=parseFloat(t),n=parseFloat(n),{"+":t+n,"-":t-n,"*":t*n,"/":t/n,"%":t%n}[e]})}$(function(){var e=o();c(),r(),l(),s(),a(),i(),t("./analytics/error-track"),e.done(function(){t("./utils/translate-constants")(window.INKIVE.TranslateHelper.translate),window.INKIVE.Menus={};var e=t("./ui/top-submenu/view"),n=t("./ui/bottom-submenu/view"),i=t("./ui/mobile-tool-menu/view");new e({el:"#header"}),new i({el:"#mobile-tool-menu"}),window.INKIVE.Menus.bottomSubmenu=new n({el:"#bottom-submenu"})}),window.INKIVE.DesignFacade=t("./facade/design/design"),window.INKIVE.EditorFacade=t("./facade/editor/editor"),window.INKIVE.ProjectFacade=t("./facade/project/project"),window.INKIVE.RestrictionsFacade=t("./facade/restrictions/restrictions"),window.INKIVE.EditorModeManager=t("./ui/editor-mode-manager"),window.INKIVE.SettingsFactory=t("./factory/settings"),window.INKIVE.ImagesFactory=t("./factory/images"),window.INKIVE.PageThumbnailFactory=t("./factory/page-thumbnail"),window.INKIVE.LibraryFactory=t("./factory/library"),window.INKIVE.UserInfoFactory=t("./factory/user-info"),window.INKIVE.FontsFactory=t("./factory/fonts"),INKIVE.FontsFactory.initialize()})},{"../../translations/translate-helper":328,"./SVGElementLoading":3,"./analytics/error-track":5,"./app/bridge":6,"./app/version":10,"./facade/design/design":19,"./facade/editor/editor":45,"./facade/project/project":56,"./facade/restrictions/restrictions":62,"./factory/fonts":64,"./factory/images":66,"./factory/library":67,"./factory/page-thumbnail":74,"./factory/restrictions":75,"./factory/settings":79,"./factory/user-info":81,"./modal/add-page":83,"./modal/download":84,"./modal/friends":85,"./modal/help":86,"./modal/share-email":87,"./modal/share-embed":88,"./thumb/placeholder":90,"./ui/bottom-submenu/view":101,"./ui/editor-mode-manager":102,"./ui/filterpicker":110,"./ui/mobile-tool-menu/view":111,"./ui/stage-dnd":112,"./ui/templates/templates-helper":148,"./ui/tool-menu/admin/view":165,"./ui/tool-menu/customize/view":236,"./ui/tool-menu/images/view":252,"./ui/tool-menu/import/view":262,"./ui/tool-menu/library/view":274,"./ui/tool-menu/restrictions/view":292,"./ui/tool-menu/settings/view":294,"./ui/tool-menu/templates/view":302,"./ui/tool-menu/text/view":307,"./ui/top-submenu/view":317,"./utils/advice":318,"./utils/backbone-mixin":320,"./utils/cookie-storage":321,"./utils/ellipsis":322,"./utils/images-sanitize":324,"./utils/translate-constants":326,"hbsfy/runtime":375}],83:[function(t,e,n){var i=t("../ui/templates/modal/add-page.hbs");e.exports=ModalAddPage=function(t){this.opts=$.extend({baseUrl:INKIVE.C.BASE_URL,staticUrl:INKIVE.C.STATIC_URL},t),this.$wrapper=$(this.opts.wrapper?this.opts.wrapper:'<div style="padding-top: 10px;"></div>'),
this.$wrapper.append(i())},ModalAddPage.prototype={constructor:INKIVE.ModalAddPage,getFormHtml:function(){return this.$wrapper},saveForm:function(t){t&&t(!0)}}},{"../ui/templates/modal/add-page.hbs":124}],84:[function(t,e,n){var i=(t("../app/version"),t("../ui/templates/modal/download.hbs"));e.exports=ModalDownload=function(t){function e(){function t(){n.$wrapper.find("#quality-section").addClass("disabled")}function e(){n.$wrapper.find("[type=checkbox]").iCheck({checkboxClass:"icheckbox_square-yellow"}),n.$wrapper.find("[type=radio]").iCheck({radioClass:"iradio_square-yellow"}),n.$wrapper.find(".ui-dropdown .input-icon").on("click",function(t){$(t.target).parents(".ui-dropdown").find("ul").toggle()}),n.$wrapper.find("a.quality").on("click",function(){n.$wrapper.find("a.quality").removeClass("active"),$(this).addClass("active")})}function i(t,e){var i="."+t+"Dimensions",a=e&&c>e?e:c,o=e&&c>e?parseInt(e/h):u;n.$wrapper.find(i+'[data-type="width"]').val(a),n.$wrapper.find(i+'[data-type="height"]').val(o)}function a(t){var e="is"+s(t),i="."+t+"Dimensions";n.$wrapper.find('[type=checkbox][name="'+e+'"]').on("ifToggled",function(t){n.$wrapper.find(i).toggleClass("disabled")})}function o(t){t+="Dimensions",n.$wrapper.find("."+t).change(function(e){r($(this),t)})}function r(t,e){var i=parseInt(t.val()),a=t.attr("data-type");16>i&&(i=16),i>3e3&&(i=3e3);var o="width"==a?i:parseInt(i/h),r="width"!=a?i:parseInt(i/h);n.$wrapper.find("."+e+'[data-type="width"]').val(o),n.$wrapper.find("."+e+'[data-type="height"]').val(r)}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}var l=["thumb","web","mobile"],c=n.opts.contentW,u=n.opts.contentH;737==c&&521==u&&(c=842,u=595);var h=c/u;"png"==n.opts.format&&t(),e(),i("rangeCurrent"),i("thumb",110),i("mobile",600),i("web",800),_.each(l,a),_.each(_.union(["rangeCurrent"],l),o)}var n=this;this.opts=$.extend({format:null,contentW:null,contentH:null,baseUrl:INKIVE.C.BASE_URL,staticUrl:INKIVE.C.STATIC_URL},t),this.$wrapper=$(this.opts.wrapper?$(this.opts.wrapper):$('<div class="tool-content"></div>')),this.$wrapper.append(i({display_zip_option:INKIVE.C.IS_MOBILE_APP&&!window.Android,display_extended_options:"pdf"!=n.opts.format})),e()},ModalDownload.prototype={constructor:ModalDownload,getFormHtml:function(){return this.$wrapper},download:function(t){INKIVE.Helpers.downloadProcedure(this.$wrapper,this.opts,t)}}},{"../app/version":10,"../ui/templates/modal/download.hbs":135}],85:[function(t,e,n){var i=t("../../user-search/index"),a={container:t("../ui/templates/modal/friends.hbs"),item:t("../ui/templates/modal/friends/item.hbs"),loading:t("../ui/templates/modal/friends/loading.hbs"),noResults:t("../ui/templates/modal/friends/no-results.hbs")};e.exports=ModalFriends=function(t){function e(){r.$wrapper.append(a.container()),r.$wrapper.find("#search").focus()}function n(){function t(){d.find("li:visible .btn-add-request").first().click()}function e(t,e){t.length>0?(d.find('.media-heading:not(:contains("'+t+'"))').closest("li").hide(),d.find('.media-heading:contains("'+t+'")').closest("li").show()):d.find("li").show();var n=e&&t.length>2;o(n)}function n(t){d.append(a.item(t))}function o(t){var e=r.$wrapper.find(".antiscroll-wrap"),n=d.find("li").first().height(),i=d.find("li:visible").length;e.height(i>5?5*n:n*(i||1)),t&&l(),t||r.$wrapper.find(".info-message").remove(),t||i||s(),e.antiscroll({autoHide:!1,width:e.width(),height:e.height()}),r.$wrapper.trigger("contentChanged")}function s(){var t=r.$wrapper.find(".info-message");t.length||d.before(a.noResults())}function l(){r.$wrapper.find(".info-message").remove();var t=r.$wrapper.find(".antiscroll-wrap");t.after(a.loading())}function c(){r.$wrapper.on("itemAdded itemRemoved","#search",function(t){var e=t.item;if(e){var n=d.find('li[data-id="'+e.id+'"]'),i=n.find(".btn-add-request");n.hasClass("grayscale")?(n.removeClass("grayscale"),i.html("Drop user")):(n.addClass("grayscale"),i.html("Add user"))}h.tagsinput("input").val(""),d.find("li").show(),o()}),r.$wrapper.on("click"," ul.friends li .btn-add-request",function(t){var e=$(this).parent("li").data(),n=$(this).parent("li").find(".media-body").text(),i=n.replace("Facebook","");i=i.replace("Inkive","");var a=$(this).parent("li"),o=a.hasClass("grayscale"),r={id:a.attr("data-id"),name:i,network:e.network};o&&h.tagsinput("add",r),o||h.tagsinput("remove",r)})}var u=INKIVE.Tool.getInstance(),h=r.$wrapper.find("#search"),d=r.$wrapper.find("ul.friends"),p={scrapbook:r.opts.bookId,ink_type:r.opts.type};l(),c(),i({$searchInput:h,api:INKIVE.Helpers.api,baseUrl:r.opts.baseUrl,friendsListParameters:p,facebookToken:u.facebookToken||FB.getAccessToken(),noProfilePicture:r.opts.staticUrl+"img/profile/anonimo.jpg",enter:t,filter:e,appendUser:n,updateFriendScroll:o})}function o(){var t=r.$wrapper.find("#email4inviting"),e=r.$wrapper.find("#inviteFriendComments").parent();t.keyup(function(t){var n=$(this).val().trim(),i=n.length>0&&n.indexOf("@")>0?"slideDown":"slideUp";e[i]("fast",function(){r.$wrapper.trigger("contentChanged")})})}var r=this;this.opts=$.extend({type:null,bookId:INKIVE.C.BOOK.id,bookName:Base64.decode(INKIVE.C.BOOK.name),baseUrl:INKIVE.C.BASE_URL,staticUrl:INKIVE.C.STATIC_URL},t),this.$wrapper=$(this.opts.wrapper?$(this.opts.wrapper):$('<div class="tool-content"></div>')),e(),n(),o()},ModalFriends.prototype={constructor:ModalFriends,getFormHtml:function(){return this.$wrapper},saveForm:function(t){t=t||$.noop;var e=this,n=e.$wrapper.find("#email4inviting").val();if(n){var i={email:n,message:e.$wrapper.find("#inviteFriendComments").val(),scrapbook_id:e.opts.bookId,scrapbook_name:e.opts.bookName,invite_type:"admins"==e.opts.type?2:"inked"==e.opts.type?1:"tagged"==e.opts.type?3:null};$.post(e.opts.baseUrl+"inkive/inkviaemail",i,function(t){e.$wrapper.find("#email4inviting").val(""),console.log("invitation(s) has been sent")}).error(function(t){e.$wrapper.find("#email4inviting").val("")})}for(var a=e.$wrapper.find("#search").tagsinput("items"),o=[],r=0;r<a.length;r++)"facebook"==a[r].network.toLowerCase()&&(o[r]="'"+a[r].id+"'");var s="";o.length>0&&(s="["+o.join(",")+"]"),a.length>0?ModalFriends.addInvolvedUser(e.opts.type,e.opts.bookId,a,function(n){t(n,e.opts.type,a)}):t(!0,e.opts.type,a)}},ModalFriends.addInvolvedUser=function(t,e,n,i,a){a=a||INKIVE.C.BASE_URL,e=e||INKIVE.C.BOOK.id,i=i||$.noop,jQuery.post(a+"inkive/setInked/"+t,{scrapbook:e,users:n},function(t){i(t.success)},"json")},ModalFriends.deleteInvolvedUser=function(t,e,n,i){i=i||INKIVE.C.BASE_URL,e=e||INKIVE.C.BOOK.id,n=n||$.noop;var a={id:t.parents(".userHolder").data("id"),inkive_id:e};$.post(i+"friends/unsetinked",a,function(i){var a=t.parents(".listContainer");t.parents(".userHolder").remove(),a.find(".userHolder").length||(a.parent().addClass("empty"),a.find(".emptyText").show()),n(e)})},ModalFriends.initInvolvedList=function(t,e,n,i,a){a=a||INKIVE.C.BASE_URL,i=i||INKIVE.C.BOOK.id,n=n||$.noop;var o=t.attr("class"),r={type:e,scrapbook:i,currentPage:"mykive"},s=t.find("li:last"),l=t.parent().parent();$.getJSON(a+"inkive/getInked",r).done(function(e){if(t.find("li>:not(a)").parent().remove(),l.find(".spinnerWrapper").hide(),e.success){var a=e.data;if(a.trim().length&&(t.find("li>:not(a)").parent().remove(),t.prepend(e.data),$('li[data-toggle="tooltip"]').tooltip({placement:"top"}),l.removeClass("empty"),l.find(".emptyText").hide()),null!=$(s).attr("data-position")){var r=40*$(s).attr("data-position");"co-creators-list"!=o&&(r+=40),$(t).css("width",r)}$(t).trigger("listupdate",i)}t.find(".thumb-img").unbind("mouseenter"),t.on("mouseenter",".thumb-img",function(t){var e=$(this).parent().find(".thumb-delete");e.length>0&&($(this).fadeOut(),e.fadeIn())}),t.find(".thumb-delete").unbind("mouseleave click"),t.on("mouseleave",".thumb-delete",function(t){$(this).fadeOut(),$(this).parent().find(".thumb-img").fadeIn()}),t.on("click",".thumb-delete",function(t){n($(this))})})}},{"../../user-search/index":327,"../ui/templates/modal/friends.hbs":136,"../ui/templates/modal/friends/item.hbs":137,"../ui/templates/modal/friends/loading.hbs":138,"../ui/templates/modal/friends/no-results.hbs":139}],86:[function(t,e,n){var i=t("../ui/templates/modal/help.hbs");e.exports=ModalHelp=function(t){this.opts=$.extend({userId:INKIVE.C.USER.id,userName:Base64.decode(INKIVE.C.USER.nickname),userEmail:Base64.decode(INKIVE.C.USER.email),baseUrl:INKIVE.C.BASE_URL,staticUrl:INKIVE.C.STATIC_URL},t),this.$wrapper=$(this.opts.wrapper?$.parseHTML(this.opts.wrapper):$.parseHTML('<div class="tool-content"></div>')),this.$wrapper.append(i({user_name:this.opts.userName,user_email:this.opts.userEmail}))},ModalHelp.prototype={constructor:ModalHelp,getFormHtml:function(){return this.$wrapper},saveForm:function(t){var e=(INKIVE.Tool.getInstance(),{email:this.$wrapper.find('[name="name"]').val(),name:this.$wrapper.find('[name="email"]').val(),help:this.$wrapper.find('[name="help"]').val(),scrapbook_id:INKIVE.C.BOOK.id}),n=$("#svgcontent g.main")[0].classList,i=_.find(n,function(t){return 0===t.indexOf("layout-id")});i&&(e.template_id=i.split("-")[2]),INKIVE.Helpers.api("inkive/feedback","POST",e,function(e){t&&t(e.status)})}}},{"../ui/templates/modal/help.hbs":140}],87:[function(t,e,n){var i=t("../ui/templates/modal/share-email.hbs");e.exports=ModalShareEmail=function(t){var e=this;this.opts=$.extend({userId:INKIVE.C.USER.id,userName:Base64.decode(INKIVE.C.USER.nickname),baseUrl:INKIVE.C.BASE_URL,staticUrl:INKIVE.C.STATIC_URL},t),this.$wrapper=$(this.opts.wrapper?$(this.opts.wrapper):$('<div class="tool-content"></div>')),e.$wrapper.append(i({thumb:INKIVE.C.BOOK.thumb,book_name:Base64.decode(INKIVE.C.BOOK.name),book_description:Base64.decode(INKIVE.C.BOOK.description).trimToLength(100),user_name:e.opts.userName}))},ModalShareEmail.prototype={constructor:ModalShareEmail,getFormHtml:function(){return this.$wrapper},saveForm:function(t){t=t||$.noop;var e=INKIVE.C.BASE_URL+"share/sendemail/"+INKIVE.C.BOOK.id,n=this.$wrapper.parents("form").serialize();$.post(e,n,function(e){e.success&&t(!0)},"json").fail(function(){t(!1)}),t(!1)}}},{"../ui/templates/modal/share-email.hbs":141}],88:[function(t,e,n){var i=t("../ui/templates/modal/share-embed.hbs");e.exports=ModalShareEmbed=function(t){function e(){o.$wrapper.append(i({width:INKIVE.C.EMBED.DefaultWidth,height:INKIVE.C.EMBED.DefaultHeight})),o.$wrapper.find("[type=checkbox]").iCheck({checkboxClass:"icheckbox_square-yellow"}),o.$wrapper.find("[name=bookName]").iCheck("check"),o.$wrapper.find("[name=bookViews]").iCheck("check")}function n(){o.$wrapper.find("a.type").on("click",function(){o.$wrapper.find("a.type").removeClass("active"),$(this).addClass("active"),"scroll"==$(this).attr("data-id")?(o.$wrapper.find("#share-embed-checkboxes").slideUp(function(){o.$wrapper.trigger("contentChanged")}),o.$wrapper.find("#share-embed-size-text").html(o.opts.text_size+" (1.5 "+(INKIVE.C.MODE.IS_DESYGNER?"designs":"pages")+" at a time)"),o.$wrapper.find("#share-embed-size a.size:not([data-id=custom])").each(function(t,e){var n=parseInt($(e).attr("data-id")),i=Math.round(n*INKIVE.C.EMBED.W2H*1.5+40);$(e).attr("tag",n+" x "+i)})):(o.$wrapper.find("#share-embed-checkboxes").slideDown(function(){o.$wrapper.trigger("contentChanged")}),o.$wrapper.find("#share-embed-size-text").html(o.opts.text_size),o.$wrapper.find("#share-embed-size a.size:not([data-id=custom])").each(function(t,e){var n=parseInt($(e).attr("data-id")),i=Math.round(n*INKIVE.C.EMBED.W2H);$(e).attr("tag",n+" x "+i)})),a()}),o.$wrapper.find("a.size").on("click",function(){o.$wrapper.find("a.size").removeClass("active"),$(this).addClass("active"),"custom"==$(this).attr("data-id")?($(this).hide(),o.$wrapper.find("#share-embed-custom-sizes").fadeIn()):(o.$wrapper.find("#share-embed-custom-sizes").hide(),o.$wrapper.find("a.size").show()),a()}),o.$wrapper.find("input[name=width]").keyup(function(t){var e=o.$wrapper.find("a.type.active").attr("data-id"),n=parseInt($(this).val())||0;parseInt(o.$wrapper.find("input[name=height]").val());n>INKIVE.C.EMBED.MaxWidth&&($(this).val(INKIVE.C.EMBED.MaxWidth),n=$(this).val()),"scroll"==e?n>Math.round((INKIVE.C.EMBED.DefaultHeight-40)/INKIVE.C.EMBED.W2H*1.5)&&o.$wrapper.find("input[name=height]").val(Math.round(n*INKIVE.C.EMBED.W2H*1.5+40)):o.$wrapper.find("input[name=height]").val(Math.round(n*INKIVE.C.EMBED.W2H)),a()}),o.$wrapper.find("input[name=height]").keyup(function(t){var e=o.$wrapper.find("a.type.active").attr("data-id"),n=parseInt($(this).val())||0;if("scroll"!=e){var i=n/INKIVE.C.EMBED.W2H;i>INKIVE.C.EMBED.MaxWidth&&(i=INKIVE.C.EMBED.MaxWidth,$(this).val(Math.round(i*INKIVE.C.EMBED.W2H))),o.$wrapper.find("input[name=width]").val(Math.round(i))}a()}),o.$wrapper.find("textarea").on("click",function(t){this.select()}),o.$wrapper.find("[type=checkbox]").on("ifToggled",function(){a()}),a()}function a(){var t=o.$wrapper.find("a.type.active").attr("data-id"),e=INKIVE.C.EMBED.DefaultWidth,n=INKIVE.C.EMBED.DefaultHeight,i=o.$wrapper.find("[name=bookName]").is(":checked")?1:0,a=o.$wrapper.find("[name=bookViews]").is(":checked")?1:0,r=o.$wrapper.find("a.size.active");"custom"==r.attr("data-id")?(e=o.$wrapper.find("input[name=width]").val()||e,n=o.$wrapper.find("input[name=height]").val()||n):(e=parseInt(r.attr("data-id")),n="scroll"==t?Math.round(e*INKIVE.C.EMBED.W2H*1.5+40):Math.round(e*INKIVE.C.EMBED.W2H));var s='<iframe src="'+INKIVE.C.BASE_URL.replace("http:","")+"design/embedded/"+INKIVE.C.BOOK.id+"/"+e+"/"+n+"/"+t+"/"+i+"/"+a+'/" width="'+e+'" height="'+n+'" frameborder="0"></iframe>';o.$wrapper.find("textarea[name=code]").val(s)}var o=this;this.opts=t||{},this.$wrapper=$(this.opts.wrapper?$(this.opts.wrapper):$('<div class="tool-content"></div>')),e(),n()},ModalShareEmbed.prototype={constructor:ModalShareEmbed,getFormHtml:function(){return this.$wrapper},saveForm:function(t){t&&t(!0)}}},{"../ui/templates/modal/share-embed.hbs":142}],89:[function(t,e,n){e.exports={data:[{key:"square",path:"M 0 0 L 0 300 L 300 300 L 300 0 L 0 0"},{key:"rectangle",path:"M 0 50 L 0 250 L 300 250 L 300 50 L 0 50"},{key:"circle",path:"M 150 150 m -150, 0 a 150,150 0 1,0 300,0 a 150,150 0 1,0 -300,0"},{key:"ellipse",path:"M0,150a150,100 0 1,0 300,0a150,100 0 1,0 -300,0"},{key:"pentagon",path:"m1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z"},{key:"triangle",path:"m1,280.375l149,-260.75l149,260.75z"},{key:"diamond",path:"m1,150l149,-149l149,149l-149,149l-149,-149z"},{key:"right_triangle",path:"m1,299l0,-298l298,298z"},{key:"donut",path:"m1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z"},{key:"hexagon",path:"m1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z"},{key:"heart",path:"m150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z"},{key:"frame",path:"m0,0l300,0l0,300l-300,0zm35,-265l0,230l230,0l0,-230z"},{key:"septagon1",path:"m0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z"},{key:"heptagon",path:"m1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z"},{key:"decagon",path:"m1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z"},{key:"dodecagon",path:"m1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z"},{key:"star_points_5",path:"m1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z"},{key:"trapezoid",path:"m1,299l55.875,-298l186.25001,0l55.87498,298z"},{key:"arrow_up",path:"m1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z"},{key:"dialog_balloon_1",path:"m0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z"},{key:"arrow_u_turn",path:"m1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z"},{key:"arrow_left_up",path:"m0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z"},{key:"cross",path:"m0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z"},{key:"plaque",path:"m-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z"},{key:"page",path:"m249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234"}]}},{}],90:[function(t,e,n){var i=t("../ui/templates/thumb/placeholder.hbs"),a=function(){function t(t,n){var a=e(n);if(a){var o=a.width>a.height?a.width:a.height,r={x:a.x+(a.width-o)/2,y:a.y+(a.height-o)/2,id:t,size:o,clipId:n,is_vertical:a.width<a.height};return{renderData:r,svgString:i(r)}}}function e(t){var e=n.find("#"+t.trim()+" rect");return 0===e.length?null:{x:parseFloat(e.attr("x")),y:parseFloat(e.attr("y")),width:parseFloat(e.attr("width")),height:parseFloat(e.attr("height"))}}var n;return{render:t,setClipsData:function(t){n=$("<div>").html(t)}}}();e.exports=a},{"../ui/templates/thumb/placeholder.hbs":149}],91:[function(t,e,n){e.exports={eventCategory:"Editor UI | Bottom Menu",eventAction:"page",previousEvent:{eventLabel:"previous"},nextEvent:function(t){var e=$(t.currentTarget).find("i.add").is(":visible");this.trackEvent({eventLabel:e?"add":"next"})}}},{}],92:[function(t,e,n){var i=t("../../../factory/formats");e.exports={eventCategory:"Editor UI | Bottom Menu",eventAction:"size",showResizeEvent:{eventLabel:"display_resize_options"},showResizeMenu:{eventLabel:"display_multi_resize_menu"},doResizeEvent:function(t){var e,n,a,o="",r=this.$el.find("input.custom").is(":checked");r?(e=parseFloat(this.$el.find("input.size.page-width").val()),n=parseFloat(this.$el.find("input.size.page-height").val()),a=this.$el.find("select.unit").val(),o=e+"x"+n+a):this.$el.find("[type=checkbox]:checked").each(function(t,e){i.getFormat($(e).val()).then(_.bind(function(t){o+=t.width+"x"+t.height+t.unit+" "},this))}),this.trackEvent({eventAction:r?"resize_custom":"resize_standar",eventLabel:"from "+this.$el.find(".page-size").text().trim()+" to "+o})}}},{"../../../factory/formats":65}],93:[function(t,e,n){e.exports={eventCategory:"Editor UI | Bottom Menu",eventAction:"zoom",setHundredPercentEvent:{eventLabel:"set_hundred_percent"},setOriginalEvent:{eventLabel:"set_original"},zoomInEvent:{eventLabel:"zoom_in"},zoomOutEvent:{eventLabel:"zoom_out"}}},{}],94:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<li>\n  <a class="btn btn-gray prev" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.prev",{name:"t",hash:{},data:a}))+'"><i class="icon-chevron-left arrow"></i></a>\n</li><li class="page-count">\n  <span data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.current",{name:"t",hash:{},data:a}))+'">0</span>/<span data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.total",{name:"t",hash:{},data:a}))+'">0</span>\n</li><li>\n  <a class="btn btn-gray next"><i class="icon-chevron-right arrow hidden" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.next",{name:"t",hash:{},data:a}))+'"></i><i class="add icon-plus" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.add",{name:"t",hash:{},data:a}))+'"></i></a>\n</li><li class="border-left">\n  <a class="btn btn-gray delete" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.delete",{name:"t",hash:{},data:a}))+'"><i class="icon-bin"></i></a>\n</li><li class="border-left">\n  <a class="btn btn-gray duplicate" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.page.duplicate",{name:"t",hash:{},data:a}))+'"><i class="icon-copy"></i></a>\n</li>\n'},useData:!0})},{"hbsfy/runtime":375}],95:[function(t,e,n){var i=t("./page.hbs"),a=t("../../../analytics/decorate"),o=t("../../../facade/editor/editor"),r=t("../../../facade/project/project");e.exports=a(t("../analytics/page"),Backbone.View.extend({events:{"click a.btn.prev":"previousEvent","click a.btn.next":"nextEvent","click a.btn.delete":"deleteEvent","click a.btn.duplicate":"duplicateEvent"},deleteEvent:function(t){var e=parseInt(INKIVE.Tool._current_page_id);o.handle("page","unload"),r.handle("design","remove",{page_number:e}).then(function(){o.handle("page","move_to",{page_number:INKIVE.C.BOOK.num_pages<e?INKIVE.C.BOOK.num_pages:e})})},duplicateEvent:function(t){var e=parseInt(INKIVE.Tool._current_page_id);INKIVE.Tool.getInstance().copyPage(e)},previousEvent:function(t){var e=parseInt(INKIVE.Tool._current_page_id);o.handle("page","move_to",{page_number:e-1})},nextEvent:function(t){var e=parseInt(INKIVE.Tool._current_page_id),n=$(t.currentTarget).find("i.add").is(":visible");n&&this.addPage(),n||o.handle("page","move_to",{page_number:e+1})},addPage:function(){r.handle("design","add")},initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,_.bindAll(this,"updateCurrentPageInfo"),this.render()},render:function(){this.$el.html(i())},updateCurrentPageInfo:function(){var t=INKIVE.Tool._current_page_id,e=INKIVE.C.BOOK.num_pages,n=this.$el.find(".page-count span"),i=this.$el.find("a.btn.prev"),a=this.$el.find("a.btn.next");n.eq(0).text(t),n.eq(1).text(e),i.toggleClass("disabled",1==t),a.find("i.add").toggleClass("hidden",t!=e),a.find("i.arrow").toggleClass("hidden",t==e)}}))},{"../../../analytics/decorate":4,"../../../facade/editor/editor":45,"../../../facade/project/project":56,"../analytics/page":91,"./page.hbs":94}],96:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a,o,r){var s,l,c,u="        ";return l=null!=(l=n.data||(null!=e?e.data:e))?l:n.helperMissing,c={name:"data",hash:{},fn:t.program(2,a,0,o,r),inverse:t.noop,data:a},s="function"==typeof l?l.call(null!=e?e:{},c):l,n.data||(s=n.blockHelperMissing.call(e,s,c)),null!=s&&(u+=s),u+"\n"},2:function(t,e,n,i,a,o,r){var s;return null!=(s=(n.eq||e&&e.eq||n.helperMissing).call(null!=e?e:{},null!=e?e.id:e,null!=(s=null!=r[2]?r[2].format:r[2])?s.id:s,{name:"eq",hash:{},fn:t.program(3,a,0,o,r),inverse:t.noop,data:a}))?s:""},3:function(t,e,n,i,a,o,r){var s,l=t.escapeExpression,c=null!=e?e:{},u=n.helperMissing,h="function";return'\n        <div class="page-size-group">\n            <div>'+l(t.lambda(null!=r[1]?r[1].name:r[1],e))+": "+l((s=null!=(s=n.name||(null!=e?e.name:e))?s:u,typeof s===h?s.call(c,{name:"name",hash:{},data:a}):s))+"</div>\n            <div><small>"+l((s=null!=(s=n.width||(null!=e?e.width:e))?s:u,typeof s===h?s.call(c,{name:"width",hash:{},data:a}):s))+"x"+l((s=null!=(s=n.height||(null!=e?e.height:e))?s:u,typeof s===h?s.call(c,{name:"height",hash:{},data:a}):s))+l((s=null!=(s=n.unit||(null!=e?e.unit:e))?s:u,typeof s===h?s.call(c,{name:"unit",hash:{},data:a}):s))+"</small></div>\n        </div>\n        "},5:function(t,e,n,i,a){return" checked"},7:function(t,e,n,i,a){return" active"},9:function(t,e,n,i,a){return" disabled"},11:function(t,e,n,i,a,o,r){var s,l,c,u="          ";return l=null!=(l=n.data||(null!=e?e.data:e))?l:n.helperMissing,c={name:"data",hash:{},fn:t.program(12,a,0,o,r),inverse:t.noop,data:a},s="function"==typeof l?l.call(null!=e?e:{},c):l,n.data||(s=n.blockHelperMissing.call(e,s,c)),null!=s&&(u+=s),u+"\n"},12:function(t,e,n,i,a,o,r){var s;return null!=(s=(n.eq||e&&e.eq||n.helperMissing).call(null!=e?e:{},null!=e?e.id:e,null!=(s=null!=r[2]?r[2].format:r[2])?s.id:s,{name:"eq",hash:{},fn:t.noop,inverse:t.program(13,a,0,o,r),data:a}))?s:""},13:function(t,e,n,i,a,o,r){var s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression;return'<div class="checkbox"><input type="checkbox" id="resize_page_id_opt_'+h((s=null!=(s=n.id||(null!=e?e.id:e))?s:c,typeof s===u?s.call(l,{name:"id",hash:{},data:a}):s))+'" value="'+h((s=null!=(s=n.id||(null!=e?e.id:e))?s:c,typeof s===u?s.call(l,{name:"id",hash:{},data:a}):s))+'"><label for="resize_page_id_opt_'+h((s=null!=(s=n.id||(null!=e?e.id:e))?s:c,typeof s===u?s.call(l,{name:"id",hash:{},data:a}):s))+'">'+h(t.lambda(null!=r[1]?r[1].name:r[1],e))+": "+h((s=null!=(s=n.name||(null!=e?e.name:e))?s:c,typeof s===u?s.call(l,{name:"name",hash:{},data:a}):s))+"</label></div>"},15:function(t,e,n,i,a){return"  disabled"},17:function(t,e,n,i,a,o,r){var s;return"<option"+(null!=(s=(n.eq||e&&e.eq||n.helperMissing).call(null!=e?e:{},e,null!=(s=null!=r[1]?r[1].format:r[1])?s.unit:s,{name:"eq",hash:{},fn:t.program(18,a,0,o,r),inverse:t.noop,data:a}))?s:"")+">"+t.escapeExpression(t.lambda(e,e))+"</option>"},18:function(t,e,n,i,a){return" selected"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a,o,r){var s,l,c,u=null!=e?e:{},h=n.helperMissing,d=t.escapeExpression,p=t.lambda,f="function",m=n.blockHelperMissing,g='<li class="page-size" data-popover="tooltip" data-placement="top" data-original-title="'+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.format",{name:"t",hash:{},data:a}))+'">\n  <span>'+d(p(null!=(s=null!=e?e.format:e)?s.width:s,e))+"x"+d(p(null!=(s=null!=e?e.format:e)?s.height:s,e))+d(p(null!=(s=null!=e?e.format:e)?s.unit:s,e))+'</span>\n</li><li>\n  <a class="btn btn-gray resize" style="padding:0 10px" data-popover="tooltip" data-placement="top" data-original-title="'+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.resize_tip",{name:"t",hash:{},data:a}))+'"><i class="icon-photo_size_select_large"></i>'+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.resize",{name:"t",hash:{},data:a}))+'</a>\n</li>\n\n<div class="ui-dropdown-content">\n';return l=null!=(l=n.groups||(null!=e?e.groups:e))?l:h,c={name:"groups",hash:{},fn:t.program(1,a,0,o,r),inverse:t.noop,data:a},s=typeof l===f?l.call(u,c):l,n.groups||(s=m.call(e,s,c)),null!=s&&(g+=s),g+='\n  <div class="page-size-group">\n    <input type="radio" name="page-size" class="format"'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.program(5,a,0,o,r),inverse:t.noop,data:a}))?s:"")+'/>\n\n    <section class="format'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.program(7,a,0,o,r),inverse:t.program(9,a,0,o,r),data:a}))?s:"")+'">\n        <div class="header">'+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.resize_to",{name:"t",hash:{},data:a}))+'</div>\n        <div class="body">\n',l=null!=(l=n.groups||(null!=e?e.groups:e))?l:h,c={name:"groups",hash:{},fn:t.program(11,a,0,o,r),inverse:t.noop,data:a},s=typeof l===f?l.call(u,c):l,n.groups||(s=m.call(e,s,c)),null!=s&&(g+=s),g+='        </div>\n    </section>\n  </div>\n\n  <div class="page-size-group">\n    <input type="radio" name="page-size" class="custom"'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.noop,inverse:t.program(5,a,0,o,r),data:a}))?s:"")+"/>\n    <label>"+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.custom",{name:"t",hash:{},data:a}))+'</label>\n\n    <section>\n      <input type="text" class="size page-width small'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.program(15,a,0,o,r),inverse:t.noop,data:a}))?s:"")+'" placeholder="'+d((n.t||e&&e.t||h).call(u,"common.width",{name:"t",hash:{},data:a}))+'" value="'+d(p(null!=(s=null!=e?e.format:e)?s.width:s,e))+'"/>\n      <span>x</span>\n      <input type="text" class="size page-height small'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.program(15,a,0,o,r),inverse:t.noop,data:a}))?s:"")+'" placeholder="'+d((n.t||e&&e.t||h).call(u,"common.height",{name:"t",hash:{},data:a}))+'" value="'+d(p(null!=(s=null!=e?e.format:e)?s.height:s,e))+'"/>\n      <select class="unit'+(null!=(s=n["if"].call(u,null!=(s=null!=e?e.format:e)?s.id:s,{name:"if",hash:{},fn:t.program(15,a,0,o,r),inverse:t.noop,data:a}))?s:"")+'">\n        ',l=null!=(l=n.units||(null!=e?e.units:e))?l:h,c={name:"units",hash:{},fn:t.program(17,a,0,o,r),inverse:t.noop,data:a},s=typeof l===f?l.call(u,c):l,n.units||(s=m.call(e,s,c)),null!=s&&(g+=s),g+'\n      </select>\n    </section>\n  </div>\n\n  <div>\n    <a class="btn btn-yellow do-resize">\n      '+d((n.t||e&&e.t||h).call(u,"bottom_submenu.size.apply",{name:"t",hash:{},data:a}))+"\n    </a>\n  </div>\n</div>\n"},useData:!0,useDepths:!0})},{"hbsfy/runtime":375}],97:[function(t,e,n){var i=t("./size.hbs"),a=t("../../../facade/design/design"),o=t("../../../facade/editor/editor"),r=t("../../../factory/formats"),s=t("../../../analytics/decorate");e.exports=s(t("../analytics/size"),Backbone.mixin(Backbone.View.extend({events:{"click section.format":"showResizeMenu","click a.btn.resize":"showResizeEvent","click .page-size":"showResizeEvent","ifToggled [type=radio]":"togglePageSizeEvent","change .size":"sizeChangeEvent","change select.unit":"sizeChangeEvent","click .do-resize":"doResizeEvent"},showResizeMenu:function(t){var e=this.$el.find("section.format");e.toggleClass("active")},showResizeEvent:function(t){var e=this.$el.find("a.btn.resize");this.$el.find("[type=checkbox]").iCheck("uncheck");var n=this.$el.find(".ui-dropdown-content"),i=$(window).width()-(e.offset().left+e.outerWidth());n.show().css("right",i)},togglePageSizeEvent:function(t){var e=this.$el.find("input.format"),n=this.$el.find("input.custom"),i=e.is(":checked");this.$el.find("section.format").toggleClass("disabled",!i),this.$el.find("section.format").toggleClass("active",i);var a=n.is(":checked");this.$el.find("input.size").toggleClass("disabled",!a),this.$el.find("select.unit").toggleClass("disabled",!a)},sizeChangeEvent:function(){var t=16,e=3e3,n=INKIVE.Helpers.convertPixelsToUnits,i=INKIVE.Helpers.convertUnitsToPixels,a=this.$el.find("select.unit").val(),o="px"==a;this.$el.find("input.size").each(function(){var r=$(this).val();r=(o?parseInt(r):parseFloat(r))||0;var s=i(r,a);s>e?r=n(e,a):t>s&&(r=n(t,a)),$(this).val(Math.round(100*r)/100)})},doResizeEvent:function(){function t(t){function e(){INKIVE.Modal.toggleLock(!1);var e=['<b style="font-weight: 400">',INKIVE.TranslateHelper.translate("modal.alert.resize_page",{page:t+1,from:l.length,percent:parseInt(100*t/l.length)}),"</b>"];
d=INKIVE.Modal.alertMessage(e.join(""),{skip:!1,loader:!0}),INKIVE.Modal.toggleLock(!0)}d&&d.close(e),d||e()}function e(r){function c(){$("#svgcontent image").each(function(){var t=$(this).data("url");t&&this.setAttribute("xlink:href",t)})}function u(t){function o(){INKIVE.Helpers.converterLayoutSizeChange(INKIVE.Helpers.convertUnitsToPixels(s.width,s.unit),INKIVE.Helpers.convertUnitsToPixels(s.height,s.unit),n,i),e(r+1)}var s=l[r];INKIVE.Tool._current_page_id=t,a.once("template.update.size",o),a.set("template",{size:s})}return c(),l.length<=r?(d&&d.close(),INKIVE.Modal.toggleLock(!1),INKIVE.PageThumbnailFactory.remove(),o.handle("cache","clear"),s&&o.handle("page","save"),void(s||o.handle("page","move_to",{page_number:p}).then(function(){o.handle("cache","clear")}))):(t(r),void INKIVE.Tool.getInstance().copyPage(p,u,!0,!0))}var n=(this.editor.canvas,parseInt(this.editor.canvas.contentW)),i=parseInt(this.editor.canvas.contentH),s=this.$el.find("input.custom").is(":checked"),l=[];if(s){var c=parseFloat(this.$el.find("input.size.page-width").val()),u=parseFloat(this.$el.find("input.size.page-height").val()),h=this.$el.find("select.unit").val();l.push({width:c,height:u,unit:h})}else this.$el.find("[type=checkbox]:checked").each(function(){r.getFormat($(this).val()).then(function(t){l.push(t)})});var d,p=parseInt(INKIVE.Tool._current_page_id);e(0)},initialize:function(){_.bindAll(this,"render","updateCurrentPageInfo"),this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,a.on("template.update.size",this.updateCurrentPageInfo),a.on("template.update.designed",this.updateCurrentPageInfo)},render:function(t,e){var n=_.uniq(_.pluck(_.flatten(_.pluck(e,"data")),"unit"));t=t||{width:parseInt(this.editor.canvas.contentW),height:parseInt(this.editor.canvas.contentH),unit:"px"},this.$el.html(i({format:t,groups:e,units:n})),this.$el.find("[type=checkbox]").iCheck({checkboxClass:"icheckbox_square-yellow"}),this.initDropdown(),INKIVE.Helpers.initTooltips(this.$el),this.trigger("render")},initDropdown:function(){this.$el.find("[type=radio]").iCheck({radioClass:"iradio_square-yellow"})},updateCurrentPageInfo:function(){var t=r.getCurrentFormat(),e=r.getGroups();$.when(t,e).then(this.render)}}),Backbone.Events))},{"../../../analytics/decorate":4,"../../../facade/design/design":19,"../../../facade/editor/editor":45,"../../../factory/formats":65,"../analytics/size":92,"./size.hbs":96}],98:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<li>\n    <a class="btn btn-gray out" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.zoom.out",{name:"t",hash:{},data:a}))+'"><i class="icon-zoomout"></i></a>\n</li><li class="border-left">\n    <a class="btn btn-gray custom" style="padding-left: 10px;width: 70px;" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.zoom.custom",{name:"t",hash:{},data:a}))+'">\n        <span class="percent">100</span>%<i class="icon-chevron-up"></i>\n    </a>\n</li><li class="border-left">\n    <a class="btn btn-gray in" data-popover="tooltip" data-placement="top" data-original-title="'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.zoom.in",{name:"t",hash:{},data:a}))+'"><i class="icon-zoomin"></i></a>\n</li>\n\n<div class="ui-dropdown-content custom-zoom"><ul>\n    <li><a data-value="10">10%</a></li>\n    <li><a data-value="25">25%</a></li>\n    <li><a data-value="50">50%</a></li>\n    <li><a data-value="75">75%</a></li>\n    <li><a data-value="100">100%</a></li>\n    <li><a data-value="125">125%</a></li>\n    <li><a data-value="150">150%</a></li>\n    <li><a data-value="175">175%</a></li>\n    <li><a data-value="200">200%</a></li>\n    <li><a data-value="500">500%</a></li>\n    <li><a data-value="fit">'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.zoom.fit",{name:"t",hash:{},data:a}))+'</a></li>\n    <li><a data-value="original">'+s((n.t||e&&e.t||r).call(o,"bottom_submenu.zoom.original",{name:"t",hash:{},data:a}))+"</a></li>\n</ul></div>"},useData:!0})},{"hbsfy/runtime":375}],99:[function(t,e,n){var i=t("./zoom.hbs"),a=t("../../../analytics/decorate"),o=t("../../../facade/editor/editor");e.exports=a(t("../analytics/zoom"),Backbone.View.extend({events:{"click div.custom-zoom li a":"customZoomEvent","click a.btn.custom":"showCustomEvent","click a.btn.in":"zoomInEvent","click a.btn.out":"zoomOutEvent"},showCustomEvent:function(t){var e=this.$el.find("a.btn.custom"),n=this.$el.find(".ui-dropdown-content"),i=$(window).width()-(e.offset().left+e.outerWidth());n.show().css("right",i)},customZoomEvent:function(t){var e=$(t.target),n=this.$el.find(".ui-dropdown-content"),i=e.attr("data-value");"fit"==i?o.handle("zoom","fit"):"original"==i?o.handle("zoom","original"):o.handle("zoom","set",{zoom:parseInt(i)/100}),n.hide()},zoomInEvent:function(t){o.handle("zoom","in")},zoomOutEvent:function(t){o.handle("zoom","out")},initialize:function(){this.render()},render:function(){this.$el.html(i())}}))},{"../../../analytics/decorate":4,"../../../facade/editor/editor":45,"../analytics/zoom":93,"./zoom.hbs":98}],100:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="margin"></div><!--\n--><ul class="tool-page"></ul><!--\n--><ul class="tool-size"></ul><!--\n--><ul class="tool-zoom"></ul>\n'},useData:!0})},{"hbsfy/runtime":375}],101:[function(t,e,n){var i=t("./template.hbs"),a=t("./contents/page"),o=t("./contents/zoom"),r=t("./contents/size"),s=t("../../facade/editor/editor"),l=t("../../facade/design/design"),c=t("../../facade/project/project");e.exports=Backbone.View.extend({initialize:function(){_.bindAll(this,"setMenuSize","updateCurrentPageInfo"),c.on("design.removed",this.updateCurrentPageInfo),s.on("page.move_to",this.updateCurrentPageInfo),l.on("template.update.designed",this.updateCurrentPageInfo),this.render()},render:function(){this.$el.html(i()),this.pageView=new a({el:this.$el.find(".tool-page")}),this.zoomView=new o({el:this.$el.find(".tool-zoom")}),this.sizeView=new r({el:this.$el.find(".tool-size")}),this.sizeView.on("render",this.setMenuSize),this.setMenuSize()},setMenuSize:function(){var t=$(".modalHeader.pageOrderShow").outerWidth(),e=$("#canvas-panel").width(),n=this.$el.outerWidth()-this.$el.children(".margin").width(),i=2;this.$el.children(".margin").width(e-t-n-i)},updateCurrentPageInfo:function(){this.sizeView.updateCurrentPageInfo(),this.pageView.updateCurrentPageInfo()}})},{"../../facade/design/design":19,"../../facade/editor/editor":45,"../../facade/project/project":56,"./contents/page":95,"./contents/size":97,"./contents/zoom":99,"./template.hbs":100}],102:[function(t,e,n){var i="default",a=null,o={"default":t("./editor-modes/default"),template:t("./editor-modes/template"),sticker:t("./editor-modes/sticker"),banner:t("./editor-modes/banner"),placeholder:t("./editor-modes/placeholder"),logo:t("./editor-modes/logo"),restrict:t("./editor-modes/restrict")},r={};_.each(o,function(t,e){r[e]=new t}),e.exports={setMode:function(t,e){r[t]&&(r[i].disable(),i=t,a=e,r[t].enable(e))},getMode:function(){return i},getData:function(){return a},isMode:function(t){return i===t}}},{"./editor-modes/banner":103,"./editor-modes/default":104,"./editor-modes/logo":105,"./editor-modes/placeholder":106,"./editor-modes/restrict":107,"./editor-modes/sticker":108,"./editor-modes/template":109}],103:[function(t,e,n){function i(){this.type="banner"}var a=t("./sticker");i.prototype=new a,e.exports=i},{"./sticker":108}],104:[function(t,e,n){function i(){this.type="default",this.hideList=[],this.showList=[],this.enableList=[],this.disableList=[]}i.prototype.initialize=function(){this.initialized=!0,this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas,_.bindAll(this,"enable","disable")},i.prototype.enable=function(t){this.initialized||this.initialize(),this.beforeUIEnable(),this.enableUI(),this.afterUIEnable(t)},i.prototype.disable=function(){this.initialized||this.initialize(),this.disableUI()},i.prototype.beforeUIEnable=function(){clearTimeout(INKIVE.Tool._autoSaveTimeout),INKIVE.Tool._autoSaveTimeout=null},i.prototype.afterUIEnable=function(t){this.canvas.runExtensions("disableRuler",{}),this.tool.load(INKIVE.Tool._current_page_id)},i.prototype.enableUI=function(){$(this.hideList.join(",")).hide(),$(this.showList.join(",")).show(),$(this.enableList.join(",")).removeClass("disabled"),$(this.disableList.join(",")).addClass("disabled")},i.prototype.disableUI=function(){$(this.hideList.join(",")).show(),$(this.showList.join(",")).hide(),$(this.enableList.join(",")).addClass("disabled"),$(this.disableList.join(",")).removeClass("disabled")},e.exports=i},{}],105:[function(t,e,n){function i(){this.type="logo",this.hideList=["#pages-panel","#tool-panel .help-menu",".name.editor-header-title","#bottom-submenu > .margin","#bottom-submenu > .tool-page","#bottom-submenu > .tool-size","#bottom-submenu > .tool-zoom li:nth-child(2)","#ruler-horizontal","#ruler-vertical","#ik-grid-snap"]}var a=t("./default");i.prototype=new a,i.prototype.enableUI=function(){a.prototype.enableUI.call(this),$('.tool-menu a[role="tab"][href="#tabAdmin"]').parent().hide(),$('.tool-menu a[role="tab"][href="#tabLayouts"]').parent().hide(),$('.tool-menu a[role="tab"][href="#tabSettings"]').parent().hide()},i.prototype.disableUI=function(){a.prototype.disableUI.call(this),$('.tool-menu a[role="tab"][href="#tabAdmin"]').parent().show(),$('.tool-menu a[role="tab"][href="#tabLayouts"]').parent().show(),$('.tool-menu a[role="tab"][href="#tabSettings"]').parent().show()},i.prototype.afterUIEnable=function(t){$('.tool-menu a[role="tab"][href="#tabExtra"]').trigger("click"),this.editor.canvas.runExtensions("enableRuler",{})},e.exports=i},{"./default":104}],106:[function(t,e,n){function i(){this.type="placeholder"}var a=t("./sticker");i.prototype=new a,e.exports=i},{"./sticker":108}],107:[function(t,e,n){function i(){this.type="restrict",this.hideList=[]}var a=t("./default"),o=t("../../facade/restrictions/restrictions");i.prototype=new a,i.prototype.enableUI=function(){a.prototype.enableUI.call(this),$('.tool-menu a[role="tab"][href="#tabAdmin"]').parent().hide(),$('.tool-menu a[role="tab"][href="#tabLayouts"]').parent().hide(),$('.tool-menu a[role="tab"][href="#tabSettings"]').parent().hide(),o.isFunctionalityAllowed("text_add")||$('.tool-menu a[role="tab"][href="#tabText"]').parent().hide(),o.isFunctionalityAllowed("function_artwork_resizing")||$("#bottom-submenu > .tool-size").hide(),o.isFunctionalityAllowed("function_download_file")||$('#shr-buttons > [data-id="download"]').hide(),o.isFunctionalityAllowed("function_print_file")||$("#shr-buttons > .print").hide(),o.isFunctionalityAllowed("function_share_file")||$('#shr-buttons > [data-id="share"]').hide(),o.isFunctionalityAllowed("function_add_page")||$("#pages-panel, #bottom-submenu > .tool-page").hide(),!o.isFunctionalityAllowed("text_add")&&(!o.isFunctionalityAllowed("function_use_own_images")||!o.isFunctionalityAllowed("image_add"))&&!o.isFunctionalityAllowed("vector_add")&&$('.tool-menu a[role="tab"][href="#tabImport"]').parent().hide(),!o.isFunctionalityAllowed("function_draw")&&!o.isFunctionalityAllowed("function_use_desygner_background")&&(!o.isFunctionalityAllowed("function_use_desygner_images")||!o.isFunctionalityAllowed("image_add"))&&(!o.isFunctionalityAllowed("function_use_desygner_vector")||!o.isFunctionalityAllowed("vector_add"))&&$('.tool-menu a[role="tab"][href="#tabExtra"]').parent().hide(),!o.isFunctionalityAllowed("text_add")&&!o.isFunctionalityAllowed("function_use_own_background")&&(!o.isFunctionalityAllowed("function_use_own_images")||!o.isFunctionalityAllowed("image_add"))&&!o.isFunctionalityAllowed("function_use_own_logo")&&!o.isFunctionalityAllowed("function_use_own_colors")&&$('.tool-menu a[role="tab"][href="#tabLibrary"]').parent().hide(),(!o.isFunctionalityAllowed("function_use_own_images")||!o.isFunctionalityAllowed("image_add"))&&$('.tool-menu a[role="tab"][href="#tabImages"').parent().hide(),$('#tabSearch a[data-id="layout"]').parent().addClass("hidden"),(!o.isFunctionalityAllowed("function_use_web_vector")||!o.isFunctionalityAllowed("function_use_desygner_vector"))&&$('#tabSearch a[data-id="sticker"]').parent().addClass("hidden"),(!o.isFunctionalityAllowed("function_use_web_background")||!o.isFunctionalityAllowed("function_use_desygner_background"))&&$('#tabSearch a[data-id="background"]').parent().addClass("hidden"),o.isFunctionalityAllowed("function_use_web_images")||$('#tabSearch a[data-id="image"]').parent().addClass("hidden").siblings("li:not(.hidden)").first().find("a").trigger("click")},i.prototype.disableUI=function(){a.prototype.disableUI.call(this),$('.tool-menu a[role="tab"][href="#tabAdmin"]').parent().show(),$('.tool-menu a[role="tab"][href="#tabLayouts"]').parent().show(),$('.tool-menu a[role="tab"][href="#tabSettings"]').parent().show()},i.prototype.afterUIEnable=function(t){},e.exports=i},{"../../facade/restrictions/restrictions":62,"./default":104}],108:[function(t,e,n){function i(){this.type="sticker",this.disableList=["#header #shr-buttons",'.tool-menu a[role="tab"][href="#tabSettings"]','.tool-menu a[role="tab"][href="#tabLayouts"]','.tool-menu a[role="tab"][href="#tabFavourites"]','.tool-menu a[role="tab"][href="#tabImages"]','.tool-menu a[role="tab"][href="#tabSearch"]','.tool-content #tabAdmin input[name="search"]','.tool-content a[data-toggle="accordion"][href="#accordionBackgrounds"]','.tool-content #tabAdmin a[data-toggle="accordion"][href="#accordionAdminLayouts"]',".tool-content #tabAdmin .btn-new-item",'.tool-content #tabAdmin a[data-toggle="accordion"][href="#accordionAdminBackgrounds"]']}var a=t("./template");i.prototype=new a,i.prototype.afterUIEnable=function(t){this.editor.canvas.runExtensions("enableRuler",{}),this.editor.loadSvgString(Base64.decode(INKIVE.C.BLANK_SVG),_.bind(this.onBlankSVG,this,t),1e3,1e3)},i.prototype.onBlankSVG=function(t){if(t.content){var e=INKIVE.Helpers.getStickerFromString(Base64.decode(t.content));if(!e)return;var n=this.canvas.getCurrentDrawing().getCurrentLayer();n.appendChild(e);var i=this.editor.getOffset();INKIVE.Helpers.resize(e,i.width,i.height,50,50)}},e.exports=i},{"./template":109}],109:[function(t,e,n){function i(){this.type="template",this.showList=["#mode-panel"],this.hideList=["#pages-panel","#bottom-submenu > .margin","#bottom-submenu > .tool-page","#bottom-submenu > .tool-size"],this.disableList=["#header #shr-buttons",'.tool-menu a[role="tab"][href="#tabSettings"]','.tool-menu a[role="tab"][href="#tabLayouts"]','.tool-content #tabAdmin input[name="search"]',".tool-content #tabAdmin .btn-new-item",'.tool-content #tabAdmin a[data-toggle="accordion"][href="#accordionAdminBackgrounds"]','.tool-content #tabAdmin a[data-toggle="accordion"][href="#accordionAdminStickers"]']}var a=t("./default");i.prototype=new a,i.prototype.enableUI=function(){a.prototype.enableUI.call(this);var e=t("../editor-mode-manager"),n=this.tool,i=$("#mode-panel");$("#canvas-panel").addClass("mode"),i.find("span").html("close_mode."+this.type),i.find("a").on("click",function(){INKIVE.Modal.togglePageLoader(!0),n.save(null,function(){e.setMode("default"),INKIVE.Modal.togglePageLoader(!1)})})},i.prototype.disableUI=function(){a.prototype.disableUI.call(this),$("#canvas-panel").removeClass("mode"),$("#mode-panel").find("a").off("click")},i.prototype.afterUIEnable=function(t){this.editor.canvas.runExtensions("enableRuler",{}),this.editor.loadSvgString(Base64.decode(INKIVE.C.BLANK_SVG),_.bind(this.onBlankSVG,this,t),t.format_width,t.format_height)},i.prototype.onBlankSVG=function(t){if(t.content){var e={background:Base64.decode(t.background),defs:Base64.decode(t.defs),content:Base64.decode(t.content)};this.editor.addElement("layout",e),t.old_format_width&&t.old_format_height&&INKIVE.Helpers.converterLayoutSizeChange(t.format_width,t.format_height,t.old_format_width,t.old_format_height)}},e.exports=i},{"../editor-mode-manager":102,"./default":104}],110:[function(t,e,n){var i={container:t("./templates/filterpicker/container.hbs"),SVGImageFiltred:t("./templates/filterpicker/svg-image-filtred.hbs")};!function(e){e.fn.extend({filterpicker:function(n){function a(t,e,n){return o(t,-100,100,e,n)}function o(t,e,n,i,a){t=parseFloat(t),i="undefined"==typeof i?-100:i,a="undefined"==typeof a?100:a;var o=a-i,r=(t-i)/o,s=n-e;return e+s*r}function r(){var t=x.find(".slider-wrapper.saturation-slider-wrapper input").val();if(0!=t){var e=document.createElementNS(k,"feColorMatrix");if(0>t)e.setAttribute("type","saturate"),e.setAttribute("values",I.to.saturation(t));else{var n=I.to.matrixSaturation(t),i=-.3*n,a=1+.7*n;e.setAttribute("type","matrix"),e.setAttribute("values",a+" "+i+" "+i+" 0 0 "+i+" "+a+" "+i+" 0 0 "+i+" "+i+" "+a+" 0 0 0 0 0 1 0")}return e}}function s(){var t=x.find(".slider-wrapper.blur-slider-wrapper input").val();if(0!=t){if(t>0){var e=document.createElementNS(k,"feGaussianBlur");return e.setAttribute("stdDeviation",I.to.blur(t)),e}var n=I.to.sharpen(t),i=-1*n,a=1+4*n,o=document.createElementNS(k,"feConvolveMatrix");return o.setAttribute("order","3 3"),o.setAttribute("preserveAlpha","true"),o.setAttribute("kernelMatrix","0 "+i+" 0 "+i+" "+a+" "+i+" 0 "+i+" 0"),o}}function l(){var t=x.find(".slider-wrapper.brightness-slider-wrapper input").val();if(0!=t){var e=I.to.brightness(t),n=document.createElementNS(k,"feComponentTransfer");return _.each(["R","G","B"],function(t){var i=document.createElementNS(k,"feFunc"+t);i.setAttribute("type","linear"),i.setAttribute("slope",e),n.appendChild(i)}),n}}function c(){var t=x.find(".slider-wrapper.contrast-slider-wrapper input").val();if(0!=t){var e=I.to.contrast(t),n=.5-.5*e,i=document.createElementNS(k,"feComponentTransfer");return _.each(["R","G","B"],function(t){var a=document.createElementNS(k,"feFunc"+t);a.setAttribute("type","linear"),a.setAttribute("slope",e),a.setAttribute("intercept",n),i.appendChild(a)}),i}}function u(){var t=x.find(".slider-wrapper.x-process-slider-wrapper input").val();if(0!=t){var e=document.createElementNS(k,"feColorMatrix");return e.setAttribute("type","hueRotate"),e.setAttribute("values",I.to.hue(t)),e}}function h(t,e){function i(){if(e=e||n.$svgImageElement,e.hasClass("layoutBox")){var t=e.get(0).textContent.replace(/[^\d.-\s]/g,"").split(" ");return{leftOffset:parseFloat(t[0]),topOffset:parseFloat(t[1]),width:parseFloat(t[2]),height:parseFloat(t[3])}}return{leftOffset:parseFloat(e.attr("x")),topOffset:parseFloat(e.attr("y")),width:parseFloat(e.attr("width")),height:parseFloat(e.attr("height"))}}var a=x.find(".slider-wrapper.vignette-slider-wrapper input").val();if(0!=a){var o=(I.to.vignetteOpacity(a),I.to.vignetteSpecular(a)),r=i(),s=document.createElementNS(k,"feFlood"),l=document.createElementNS(k,"fePointLight"),c=document.createElementNS(k,"feSpecularLighting"),u=document.createElementNS(k,"feBlend"),h=document.createElementNS(k,"feBlend");return s.setAttribute("result","blackfield-"+t),s.setAttribute("x",r.leftOffset+"px"),s.setAttribute("y",r.topOffset+"px"),s.setAttribute("width",r.width+"px"),s.setAttribute("height",r.height+"px"),l.setAttribute("x",r.leftOffset+r.width/2),l.setAttribute("y",r.topOffset+r.height/2),l.setAttribute("z",_.min([r.width,r.height])),c.setAttribute("result","spotlight-"+t),c.setAttribute("lighting-color","#FFFFFF"),c.setAttribute("surfaceScale","1"),c.setAttribute("specularConstant","1"),c.setAttribute("specularExponent",o),c.setAttribute("x",r.leftOffset+"px"),c.setAttribute("y",r.topOffset+"px"),c.setAttribute("width",r.width+"px"),c.setAttribute("height",r.height+"px"),c.appendChild(l),u.setAttribute("result","A-"+t),u.setAttribute("in","blackfield-"+t),u.setAttribute("in2","spotlight-"+t),u.setAttribute("mode","lighten"),h.setAttribute("result","B-"+t),h.setAttribute("in","A-"+t),h.setAttribute("in2","SourceGraphic"),h.setAttribute("mode","multiply"),[s,c,u,h]}}function d(){var t=document.createElementNS(k,"defs"),e=n.$svgImageElement.closest("svg");return e.children("defs").length||e.prepend(t),e.children("defs").get(0)}function p(){function t(){var t=x.find(".presets-container");_.each(E,function(a){var o="filter-thumb-"+a.className,r=a.template({filter_id:o}),s=e("<li>",{"class":"thumb "+a.className,html:i.SVGImageFiltred({width:110,height:110,image:n.$svgImageElement.attr("xlink:href"),filter_id:o,filter:r})});s.append('<span class="filter-name">'+a.name+"</span>"),t.append(s)})}function a(){var t=x.find(".svg-container");e(i.SVGImageFiltred({width:400,height:400,image:n.$svgImageElement.attr("xlink:href"),filter_id:"filtered-image-preview",filter:_.findWhere(E,{name:"Normal"}).template()})).appendTo(t)}x=e(i.container()),x.on("change",y),x.tabs(),t(),a()}function f(t,e){e=e||0;var i=(t.width()||400)+e,a=(t.height()||400)+e,o=i/a,r=parseInt(n.$svgImageElement.attr("width")),s=parseInt(n.$svgImageElement.attr("height")),l=r/s;return{width:l>o?a*l:i,height:l>o?a:i/l}}function m(){var t=x.find(".svg-container"),e=t.find("image"),i=f(t,4),a=n.$svgImageElement.attr("xlink:href");e.attr("xlink:href",a),e.attr("width",i.width),e.attr("height",i.height),t.find("svg").attr("width",i.width),t.find("svg").attr("height",i.height),INKIVE.ImagesFactory.smartLoad(a,i,function(t,n){t===INKIVE.C.Status.success&&e.attr("xlink:href",n.src)})}function g(){var t=x.find(".presets-container");t.hasClass("slick-slider")&&t.slick("unslick"),t.slick({prevArrow:'<span class="prev btn btn-green"><i class="icon-chevron-left"></i></span>',nextArrow:'<span class="next btn btn-green"><i class="icon-chevron-right"></i></span>',infinite:!0,slidesToShow:4,slidesToScroll:2})}function v(){var t=x.find(".presets-container"),e=t.find("li"),i=e.find("image");i.attr("xlink:href",n.$svgImageElement.attr("xlink:href")),t.hide(),INKIVE.Modal.loader(t.parent()),t.hasClass("slick-slider")&&t.slick("slickGoTo",0),_.delay(function(){INKIVE.Modal.loaderClose(t.parent()),t.show(),g();var n=f(e,2);i.attr("width",n.width),i.attr("height",n.height),e.find("svg").attr("width",n.width),e.find("svg").attr("height",n.height),w&&w.refresh()},2e3)}function b(t){function n(){function t(t,i,a,o){o=isNaN(o)?0:Math.round(o);var r=e('<div class="slider-wrapper"><div class="slider"></div></div>'),s=e('<input type="text" />').val(o);r.append(s),r.addClass(t+"-slider-wrapper"),u.append(r),s.on("click",function(t){t.stopPropagation()}),s.keyup(function(t){var n=parseInt(e(this).val())||0;n>a?n=a:i>n&&(n=i),e(this).val(n),l.slider("option","value",n),x.trigger("change")});var l=r.children(".slider").slider({max:a,min:i,value:o,slide:function(t,e){s.val(e.value),x.trigger("change")}});l.slider("float"),r.prepend(e("<label>",{text:n("filterpicker.sliders."+t)}))}var n=INKIVE.TranslateHelper.translate;u.empty(),t("brightness",-100,100),t("contrast",-100,100),t("saturation",-100,100),t("blur",-100,100),t("x-process",-100,100),t("vignette",0,100)}function i(){var e=t.find("feComponentTransfer feFuncR:not([intercept])");return e.length?c.brightness(e.attr("slope")):0}function a(){var e=t.find("feComponentTransfer feFuncR[intercept]");return e.length?c.contrast(e.attr("slope")):0}function o(){var e=t.find('feColorMatrix[type="saturate"]'),n=t.find('feColorMatrix[type="matrix"]');if(e.length)return c.saturation(e.attr("values"));if(n.length){var i=n.attr("values");return c.matrixSaturation((i.split(" ")[0]-1)/.7)}return 0}function r(){var e=t.find('feColorMatrix[type="hueRotate"]');return e.length?c.hue(e.attr("values")):0}function s(){var e=t.find("feSpecularLighting");return e.length?c.vignetteSpecular(e.attr("specularExponent")):0}function l(){var e=t.find("feGaussianBlur"),n=t.find("feConvolveMatrix");if(e.length)return c.blur(e.attr("stdDeviation"));if(n.length){var i=n.attr("kernelMatrix");return c.sharpen(-1*parseFloat(i.split(" ")[1]))}return 0}var c=I.from,u=x.find(".sliders-container");n(),u.find(".blur-slider-wrapper input").val(l()),u.find(".x-process-slider-wrapper input").val(r()),u.find(".vignette-slider-wrapper input").val(s()),u.find(".contrast-slider-wrapper input").val(a()),u.find(".brightness-slider-wrapper input").val(i()),u.find(".saturation-slider-wrapper input").val(o()),u.find("input").trigger("keyup")}function y(){function t(){n.innerHTML="";var t=_.compact(_.flatten(_.map([h,r,l,c,s,u],function(t){return t("filtered-image-preview",i)})));return _.each(t,function(t){n.appendChild(t)}),t.length>0}var e=x.find("#filtered-image-preview"),n=e.get(0),i=e.closest("svg").find("image"),a=t();a&&i.attr("filter","url(#filtered-image-preview)"),a||i.removeAttr("filter")}var w,x,k="http://www.w3.org/2000/svg";n=e.extend({defaultFilter:null,$svgImageElement:null},n);var E=[{name:"Normal",className:"thumb-normal",template:_.template('<feColorMatrix type="saturate" values="1"></feColorMatrix>')},{name:"Cali",className:"thumb-cali",template:t("./templates/filterpicker/filter-cali.hbs")},{name:"Drama",className:"thumb-drama",template:t("./templates/filterpicker/filter-drama.hbs")},{name:"Edge",className:"thumb-edge",template:t("./templates/filterpicker/filter-edge.hbs")},{name:"Epic",className:"thumb-epic",template:t("./templates/filterpicker/filter-epic.hbs")},{name:"Festive",className:"thumb-festive",template:t("./templates/filterpicker/filter-festive.hbs")},{name:"Grayscale",className:"thumb-grayscale",template:t("./templates/filterpicker/filter-grayscale.hbs")},{name:"Nordic",className:"thumb-nordic",template:t("./templates/filterpicker/filter-nordic.hbs")},{name:"Street",className:"thumb-street",template:t("./templates/filterpicker/filter-street.hbs")},{name:"The blues",className:"thumb-the-blues",template:t("./templates/filterpicker/filter-the-blues.hbs")}],I={to:{hue:function(t){return o(t,-180,180)},blur:function(t){return o(t,-10,10)},sharpen:function(t){return-1*o(t,-1,1)},contrast:function(t){return o(t,0,2)},brightness:function(t){return o(t,0,2)},saturation:function(t){return o(t,0,2)},matrixSaturation:function(t){return o(t,-1,1)},vignetteOpacity:function(t){return.7+o(t,0,.3,0,100)},vignetteSpecular:function(t){return o(t,0,30,0,100)}},from:{hue:function(t){return a(t,-180,180)},blur:function(t){return a(t,-10,10)},sharpen:function(t){return-1*a(t,-1,1)},contrast:function(t){return a(t,0,2)},brightness:function(t){return a(t,0,2)},saturation:function(t){return a(t,0,2)},matrixSaturation:function(t){return a(t,-1,1)},vignetteSpecular:function(t){return o(t,0,100,0,30)}}};return this.each(function(t){function i(){e("#filter-picker").remove(),p(),o(),a(),_.defer(f)}function a(){x.find(".presets-container li").off("click").on("click",function(t){t.stopPropagation();var n=e("#filtered-image-preview"),i=n.closest("svg").find("image"),a=e(this).attr("class").split(/\s+/),o=_.find(E,function(t){return _.contains(a,t.className)});o&&(n.html(o.template({filter_id:"filtered-image-preview"})),i.attr("filter","url(#filtered-image-preview)"),b(n),x.trigger("change"))}),x.off("change").on("change",y)}function o(){var t=_.debounce(function(){x.trigger("change"),g()},400);n.$svgImageElement.on("change",function(){e("#"+C).length&&(f(),t())})}function f(){m(),v(),b(e("#"+C))}function g(){function t(){var t=document.createElementNS(k,"filter");t.setAttribute("id",i);var e=_.compact(_.flatten(_.map([h,r,l,c,s,u],function(t){return t(i)})));return _.each(e,function(e){t.appendChild(e)}),a&&e.length&&a.appendChild(t),e.length>0}for(var i="filter_"+n.$svgImageElement.attr("id"),a=d(),o=INKIVE.Tool.getInstance().editor,p=o.canvas;e("#"+i).length;)e("#"+i).remove();var f=t();p.undoMgr.beginUndoableChange("filter",[n.$svgImageElement.get(0)]),f&&n.$svgImageElement.attr("filter","url(#"+i+")"),f||n.$svgImageElement.removeAttr("filter");var m=p.undoMgr.finishUndoableChange();m.isEmpty()||p.undoMgr.addCommandToHistory(m),w&&w.close()}var I=e(this),C="filter_"+n.$svgImageElement.attr("id");i(),I.off("click").on("click",function(){w&&w.close(),i();var t=.8*e(window).width();t>800&&(t=800);var n=INKIVE.TranslateHelper.translate;w=INKIVE.Modal.modalWindow(x,{width:t,headerIcon:"icon-filters",headerTitle:"Filters",buttons:[{title:n("common.apply"),onClick:g}]})})})}})}(jQuery)},{"./templates/filterpicker/container.hbs":113,"./templates/filterpicker/filter-cali.hbs":114,"./templates/filterpicker/filter-drama.hbs":115,"./templates/filterpicker/filter-edge.hbs":116,"./templates/filterpicker/filter-epic.hbs":117,"./templates/filterpicker/filter-festive.hbs":118,"./templates/filterpicker/filter-grayscale.hbs":119,"./templates/filterpicker/filter-nordic.hbs":120,"./templates/filterpicker/filter-street.hbs":121,"./templates/filterpicker/filter-the-blues.hbs":122,"./templates/filterpicker/svg-image-filtred.hbs":123}],111:[function(t,e,n){var i=t("../../facade/editor/editor");e.exports=Backbone.View.extend({events:{'click a[data-action="on_undo"]':"undoEvent",'click a[data-action="on_redo"]':"redoEvent","click a.btn.zoom-in":"zoomInEvent","click a.btn.zoom-out":"zoomOutEvent","click #ik-save":"saveEvent","click #ik-close":"closeEvent"},undoEvent:function(t){i.handle("history","undo")},redoEvent:function(t){i.handle("history","redo")},zoomInEvent:function(t){i.handle("zoom","in")},zoomOutEvent:function(t){i.handle("zoom","out")},saveEvent:function(t){i.handle("page","save")},closeEvent:function(t){i.handle("close")},initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor}})},{"../../facade/editor/editor":45}],112:[function(t,e,n){function i(){s=INKIVE.Tool.getInstance(),a()}function a(){function t(t){return t.type.match(/image.*/)}var e=$("#svgcanvas");e.on("dragover",function(t){function e(){var e=$("#svgcontent").offset();l={x:t.clientX-e.left,y:t.clientY-e.top}}t.stopPropagation(),t.preventDefault(),t=t.originalEvent,t.dataTransfer.dropEffect="copy",e()}),e.on("drop",function(e){e.stopPropagation(),e.preventDefault();var n=e.originalEvent.dataTransfer.files,i=_.filter(n,t);c=i.length,u=0,_.each(i,o)})}function o(t){r(t)}function r(t){var e=$.Deferred();return $('.btn-tag[href="#tabImages"]').trigger("click"),_.defer(function(){var n=INKIVE.Tabs.images.$el.find(".uploader.progress-button"),i=INKIVE.Tabs.images.$el.find('.btn-accordion[data-key="project"]');i.trigger("click"),n.fineUploaderS3("addFiles",t),e.resolve(_.last(n.fineUploaderS3("getUploads")).id)}),e.promise()}t("../facade/editor/editor");e.exports={init:i};var s,l,c,u},{"../facade/editor/editor":45}],113:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<div id="filter-picker">\n    <ul style="justify-content: flex-start;">\n        <li><a href="#filter-tab-1">'+s((n.t||e&&e.t||r).call(o,"filterpicker.container.presets_label",{name:"t",hash:{},data:a}))+'</a></li>\n        <li><a href="#filter-tab-2">'+s((n.t||e&&e.t||r).call(o,"filterpicker.container.advanced_label",{name:"t",hash:{},data:a}))+'</a></li>\n    </ul>\n\n    <div id="filter-tab-1"><ul class="presets-container"></ul></div>\n    <div id="filter-tab-2" class="sliders-container"></div>\n\n    <div class="svg-container"></div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],114:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="matrix" values="1.238 -0.1 -0.1 0 0 -0.1 1.238 -0.1 0 0 -0.1 -0.1 1.238 0 0 0 0 0 1 0"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.22"></feFuncR>\n    <feFuncG type="linear" slope="1.22"></feFuncG>\n    <feFuncB type="linear" slope="1.22"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncR>\n    <feFuncG type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncG>\n    <feFuncB type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncB>\n</feComponentTransfer>\n\n<feColorMatrix type="hueRotate" values="7.200000000000017"></feColorMatrix>\n';
},useData:!0})},{"hbsfy/runtime":375}],115:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="saturate" values="0.93"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.91"></feFuncR>\n    <feFuncG type="linear" slope="0.91"></feFuncG>\n    <feFuncB type="linear" slope="0.91"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.2" intercept="-0.09999999999999998"></feFuncR>\n    <feFuncG type="linear" slope="1.2" intercept="-0.09999999999999998"></feFuncG>\n    <feFuncB type="linear" slope="1.2" intercept="-0.09999999999999998"></feFuncB>\n</feComponentTransfer>\n\n<feConvolveMatrix order="3 3" preserveAlpha="true" kernelMatrix="0 -0.12 0 -0.12 1.48 -0.12 0 -0.12 0"></feConvolveMatrix>\n<feColorMatrix type="hueRotate" values="23.399999999999977"></feColorMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],116:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="matrix" values="1.119 -0.05 -0.05 0 0 -0.05 1.119 -0.05 0 0 -0.05 -0.05 1.119 0 0 0 0 0 1 0"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.09"></feFuncR>\n    <feFuncG type="linear" slope="1.09"></feFuncG>\n    <feFuncB type="linear" slope="1.09"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.91" intercept="0.044999999999999984"></feFuncR>\n    <feFuncG type="linear" slope="0.91" intercept="0.044999999999999984"></feFuncG>\n    <feFuncB type="linear" slope="0.91" intercept="0.044999999999999984"></feFuncB>\n</feComponentTransfer>\n\n<feConvolveMatrix order="3 3" preserveAlpha="true" kernelMatrix="0 -0.44999999999999996 0 -0.44999999999999996 2.8 -0.44999999999999996 0 -0.44999999999999996 0"></feConvolveMatrix>\n\n<feColorMatrix type="hueRotate" values="36"></feColorMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],117:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<feFlood result="blackfield-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" flood-color="#000000" flood-opacity="0.868"></feFlood>\n\n<feSpecularLighting result="spotlight-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" lighting-color="#FFFFFF" surfaceScale="1" specularConstant="1" specularExponent="28.000000000000004">\n    <fePointLight z="500"></fePointLight>\n</feSpecularLighting>\n\n<feBlend result="A-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in="blackfield-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in2="spotlight-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" mode="lighten"></feBlend>\n<feBlend result="B-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in="A-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in2="SourceGraphic" mode="multiply"></feBlend>\n\n<feColorMatrix type="saturate" values="0.93"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.05"></feFuncR>\n    <feFuncG type="linear" slope="1.05"></feFuncG>\n    <feFuncB type="linear" slope="1.05"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncR>\n    <feFuncG type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncG>\n    <feFuncB type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncB>\n</feComponentTransfer>\n\n<feGaussianBlur stdDeviation="0.09999999999999964"></feGaussianBlur>\n<feColorMatrix type="hueRotate" values="39.599999999999994"></feColorMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],118:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="matrix" values="1.154 -0.066 -0.066 0 0 -0.066 1.154 -0.066 0 0 -0.066 -0.066 1.154 0 0 0 0 0 1 0"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.07"></feFuncR>\n    <feFuncG type="linear" slope="1.07"></feFuncG>\n    <feFuncB type="linear" slope="1.07"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.15" intercept="-0.07499999999999996"></feFuncR>\n    <feFuncG type="linear" slope="1.15" intercept="-0.07499999999999996"></feFuncG>\n    <feFuncB type="linear" slope="1.15" intercept="-0.07499999999999996"></feFuncB>\n</feComponentTransfer>\n\n<feConvolveMatrix order="3 3" preserveAlpha="true" kernelMatrix="0 -0.06000000000000005 0 -0.06000000000000005 1.2400000000000002 -0.06000000000000005 0 -0.06000000000000005 0"></feConvolveMatrix>\n\n<feColorMatrix type="hueRotate" values="7.200000000000017"></feColorMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],119:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="saturate" values="0"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.1"></feFuncR>\n    <feFuncG type="linear" slope="1.1"></feFuncG>\n    <feFuncB type="linear" slope="1.1"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncR>\n    <feFuncG type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncG>\n    <feFuncB type="linear" slope="0.95" intercept="0.025000000000000022"></feFuncB>\n</feComponentTransfer>\n'},useData:!0})},{"hbsfy/runtime":375}],120:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="saturate" values="0.52"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.1">\n    </feFuncR><feFuncG type="linear" slope="1.1"></feFuncG>\n    <feFuncB type="linear" slope="1.1"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.97" intercept="0.015000000000000013"></feFuncR>\n    <feFuncG type="linear" slope="0.97" intercept="0.015000000000000013"></feFuncG>\n    <feFuncB type="linear" slope="0.97" intercept="0.015000000000000013"></feFuncB>\n</feComponentTransfer>\n'},useData:!0})},{"hbsfy/runtime":375}],121:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<feFlood result="blackfield-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" flood-color="#000000" flood-opacity="0.7839999999999999"></feFlood>\n\n<feSpecularLighting result="spotlight-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" lighting-color="#FFFFFF" surfaceScale="1" specularConstant="1" specularExponent="14.000000000000002">\n    <fePointLight z="500"></fePointLight>\n</feSpecularLighting>\n\n<feBlend result="A-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in="blackfield-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in2="spotlight-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" mode="lighten"></feBlend>\n<feBlend result="B-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in="A-'+c((o=null!=(o=n.filter_id||(null!=e?e.filter_id:e))?o:s,typeof o===l?o.call(r,{name:"filter_id",hash:{},data:a}):o))+'" in2="SourceGraphic" mode="multiply"></feBlend>\n\n<feColorMatrix type="saturate" values="0.05"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.94"></feFuncR>\n    <feFuncG type="linear" slope="0.94"></feFuncG>\n    <feFuncB type="linear" slope="0.94"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncR>\n    <feFuncG type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncG>\n    <feFuncB type="linear" slope="1.12" intercept="-0.06000000000000005"></feFuncB>\n</feComponentTransfer>\n\n<feConvolveMatrix order="3 3" preserveAlpha="true" kernelMatrix="0 -0.07999999999999996 0 -0.07999999999999996 1.3199999999999998 -0.07999999999999996 0 -0.07999999999999996 0"></feConvolveMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],122:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<feColorMatrix type="saturate" values="0.76"></feColorMatrix>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="1.61"></feFuncR>\n    <feFuncG type="linear" slope="1.61"></feFuncG>\n    <feFuncB type="linear" slope="1.61"></feFuncB>\n</feComponentTransfer>\n\n<feComponentTransfer>\n    <feFuncR type="linear" slope="0.73" intercept="0.135"></feFuncR>\n    <feFuncG type="linear" slope="0.73" intercept="0.135"></feFuncG>\n    <feFuncB type="linear" slope="0.73" intercept="0.135"></feFuncB>\n</feComponentTransfer>\n\n<feConvolveMatrix order="3 3" preserveAlpha="true" kernelMatrix="0 -0.13 0 -0.13 1.52 -0.13 0 -0.13 0"></feConvolveMatrix>\n<feColorMatrix type="hueRotate" values="55.80000000000001"></feColorMatrix>\n'},useData:!0})},{"hbsfy/runtime":375}],123:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing,c="function",u=t.escapeExpression;return'<svg class="filter-thumb" xmlns="http://www.w3.org/2000/svg" width="'+u((r=null!=(r=n.width||(null!=e?e.width:e))?r:l,typeof r===c?r.call(s,{name:"width",hash:{},data:a}):r))+'" height="'+u((r=null!=(r=n.height||(null!=e?e.height:e))?r:l,typeof r===c?r.call(s,{name:"height",hash:{},data:a}):r))+'">\n    <defs><filter id="'+u((r=null!=(r=n.filter_id||(null!=e?e.filter_id:e))?r:l,typeof r===c?r.call(s,{name:"filter_id",hash:{},data:a}):r))+'">'+(null!=(r=null!=(r=n.filter||(null!=e?e.filter:e))?r:l,o=typeof r===c?r.call(s,{name:"filter",hash:{},data:a}):r)?o:"")+'</filter></defs>\n    <g stroke="null">\n        <image filter="url(#'+u((r=null!=(r=n.filter_id||(null!=e?e.filter_id:e))?r:l,typeof r===c?r.call(s,{name:"filter_id",hash:{},data:a}):r))+')" xlink:href="'+u((r=null!=(r=n.image||(null!=e?e.image:e))?r:l,typeof r===c?r.call(s,{name:"image",hash:{},data:a}):r))+'" x="0" y="0" width="'+u((r=null!=(r=n.width||(null!=e?e.width:e))?r:l,typeof r===c?r.call(s,{name:"width",hash:{},data:a}):r))+'" height="'+u((r=null!=(r=n.height||(null!=e?e.height:e))?r:l,typeof r===c?r.call(s,{name:"height",hash:{},data:a}):r))+'" style="pointer-events:inherit"/>\n    </g>\n</svg>\n'},useData:!0})},{"hbsfy/runtime":375}],124:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'    <div class="filterWrapper" style="position: relative;">\n        <input type="text" name="filter" placeholder="'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.add_page.search_sizes",{name:"t",hash:{},data:a}))+'"/>\n    </div>\n\n    <div class="tool-content">\n        <div style="height: 200px;" role="tabpanel">\n            <div class="antiscroll-wrap">\n                <div class="antiscroll-inner">\n                    <div class="tab-content"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n'},3:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'    <div style="display: table-cell; width:260px; padding-right: 5px; vertical-align: top; font-size: 13px;">\n        <div class="filterWrapper">\n            <ul class="filter">\n                <li class="active" data-type="all">'+s((n.t||e&&e.t||r).call(o,"modal.add_page.show_all",{name:"t",hash:{},data:a}))+'</li>\n                <li data-type="category">'+s((n.t||e&&e.t||r).call(o,"modal.add_page.filter_by",{name:"t",hash:{},data:a}))+'</li>\n            </ul>\n        </div>\n        <div class="filterWrapper subfilter" style="display: none;"></div>\n    </div>\n\n    <div class="tool-content" style="display: table-cell;">\n        <div style="height: 200px;" role="tabpanel">\n            <div class="antiscroll-wrap">\n                <div class="antiscroll-inner">\n                    <div class="tab-content"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d='<input type="hidden" id="layout-id" />\n<div style="display: table; width:100%">\n';return r=null!=(r=n.Desygner||(null!=e?e.Desygner:e))?r:c,s={name:"Desygner",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Desygner||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n",r=null!=(r=n.Photobooky||(null!=e?e.Photobooky:e))?r:c,s={name:"Photobooky",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Photobooky||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"</div>\n"},useData:!0})},{"hbsfy/runtime":375}],125:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<b style="font-weight: 400">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},null!=e?e.message:e,{name:"t",hash:{},data:a}))+"</b>\n"},useData:!0})},{"hbsfy/runtime":375}],126:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return"<br><b>"+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"common.try_again",{name:"t",hash:{},data:a}))+"</b>"},3:function(t,e,n,i,a){return"<br><b>"+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"common.check_network",{name:"t",hash:{},data:a}))+"</b>"},5:function(t,e,n,i,a){var o;return"<br><b>"+(null!=(o=t.lambda(e,e))?o:"")+"</b>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="<b>"+t.escapeExpression((n.t||e&&e.t||c).call(l,"common.error",{name:"t",hash:{},data:a}))+" - </b>\n<i>"+(null!=(o=(n.t||e&&e.t||c).call(l,null!=e?e.message:e,{name:"t",hash:{},data:a}))?o:"")+"</i>\n";return r=null!=(r=n.try_again||(null!=e?e.try_again:e))?r:c,s={name:"try_again",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.try_again||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n",r=null!=(r=n.check_network||(null!=e?e.check_network:e))?r:c,s={name:"check_network",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.check_network||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n",r=null!=(r=n.more_info||(null!=e?e.more_info:e))?r:c,s={name:"more_info",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.more_info||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"\n"},useData:!0})},{"hbsfy/runtime":375}],127:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing;return"    "+(null!=(o=(n.t||e&&e.t||l).call(s,"modal.alert.delete_confirm_0",{name:"t",hash:{},data:a}))?o:"")+" <i>"+t.escapeExpression((r=null!=(r=n.title||(null!=e?e.title:e))?r:l,"function"==typeof r?r.call(s,{name:"title",hash:{},data:a}):r))+"</i>?<br>\n    "+(null!=(o=(n.t||e&&e.t||l).call(s,"modal.alert.delete_confirm_1",{name:"t",hash:{},data:a}))?o:"")+"\n"},3:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing;return"    "+(null!=(o=(n.t||e&&e.t||l).call(s,"modal.alert.delete_confirm_0",{name:"t",hash:{},data:a}))?o:"")+" "+t.escapeExpression((r=null!=(r=n.title||(null!=e?e.title:e))?r:l,"function"==typeof r?r.call(s,{name:"title",hash:{},data:a}):r))+"?\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="";return r=null!=(r=n.admin||(null!=e?e.admin:e))?r:c,s={name:"admin",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.admin||(o=h.call(e,o,s)),null!=o&&(d+=o),r=null!=(r=n.admin||(null!=e?e.admin:e))?r:c,s={name:"admin",hash:{},fn:t.noop,inverse:t.program(3,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.admin||(o=h.call(e,o,s)),null!=o&&(d+=o),d},useData:!0})},{"hbsfy/runtime":375}],128:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return"<span>"+t.escapeExpression((o=null!=(o=n.text||(null!=e?e.text:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"text",hash:{},data:a}):o))+"</span>\n"},useData:!0})},{"hbsfy/runtime":375}],129:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing,c="function";return'<div class="modal alert" style="'+t.escapeExpression((r=null!=(r=n.width||(null!=e?e.width:e))?r:l,typeof r===c?r.call(s,{name:"width",hash:{},data:a}):r))+'">\n    <p class="content">'+(null!=(r=null!=(r=n.message||(null!=e?e.message:e))?r:l,o=typeof r===c?r.call(s,{name:"message",hash:{},data:a}):r)?o:"")+"</p>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],130:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<li style="'+c((o=null!=(o=n.width||(null!=e?e.width:e))?o:s,typeof o===l?o.call(r,{name:"width",hash:{},data:a}):o))+'"><a id="btn-'+c((o=null!=(o=n.key||a&&a.key)?o:s,typeof o===l?o.call(r,{name:"key",hash:{},data:a}):o))+'" class="btn '+c((o=null!=(o=n["class"]||(null!=e?e["class"]:e))?o:s,typeof o===l?o.call(r,{name:"class",hash:{},data:a}):o))+'">'+c((n.t||e&&e.t||s).call(r,null!=e?e.title:e,{name:"t",hash:{},data:a}))+"</a></li>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return'<ul class="btnWrapper bottom">\n'+(null!=(o=n.each.call(null!=e?e:{},e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"\n</ul>\n"},useData:!0})},{"hbsfy/runtime":375}],131:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u=t.escapeExpression,h='    <p style="margin-top: 10px;">'+u((n.t||e&&e.t||c).call(l,"modal.layout_load.different_size",null!=e?e.new_size:e,{name:"t",hash:{},data:a}))+'</p>\n    <div class="checkbox">\n        <input type="checkbox" name="keep-size-input"';return r=null!=(r=n.keep_size||(null!=e?e.keep_size:e))?r:c,s={name:"keep_size",hash:{},fn:t.program(2,a,0),inverse:t.noop,data:a},o="function"==typeof r?r.call(l,s):r,n.keep_size||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(h+=o),h+'/>\n        <label for="keep-size-input">'+u((n.t||e&&e.t||c).call(l,"modal.layout_load.keep_current_size",null!=e?e.current_size:e,{name:"t",hash:{},data:a}))+"</label>\n    </div>\n"},2:function(t,e,n,i,a){return" checked"},4:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u='    <div class="checkbox">\n        <input type="checkbox" name="keep-images-input"';return r=null!=(r=n.keep_images||(null!=e?e.keep_images:e))?r:c,s={name:"keep_images",hash:{},fn:t.program(2,a,0),inverse:t.noop,data:a},o="function"==typeof r?r.call(l,s):r,n.keep_images||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(u+=o),u+'/>\n        <label for="keep-images-input">'+t.escapeExpression((n.t||e&&e.t||c).call(l,"modal.layout_load.keep_images",{name:"t",hash:{},data:a}))+"</label>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="<p>"+t.escapeExpression((n.t||e&&e.t||c).call(l,"modal.layout_load.about",{name:"t",hash:{},data:a}))+"</p>\n";return r=null!=(r=n.is_same_size||(null!=e?e.is_same_size:e))?r:c,s={name:"is_same_size",hash:{},fn:t.noop,inverse:t.program(1,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.is_same_size||(o=h.call(e,o,s)),null!=o&&(d+=o),r=null!=(r=n.has_images||(null!=e?e.has_images:e))?r:c,s={name:"has_images",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.has_images||(o=h.call(e,o,s)),null!=o&&(d+=o),d},useData:!0})},{"hbsfy/runtime":375}],132:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return" center"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l='<div class="spinnerWrapper';return r=null!=(r=n.center||(null!=e?e.center:e))?r:n.helperMissing,s={name:"center",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o="function"==typeof r?r.call(null!=e?e:{},s):r,n.center||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(l+=o),l+'">\n    <div class="spinner"><circle class="path"></circle></div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],133:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<div class="modal" style="'+c((o=null!=(o=n.width||(null!=e?e.width:e))?o:s,typeof o===l?o.call(r,{name:"width",hash:{},data:a}):o))+'">\n    <a class="btn btn-green modalHeader" id="pageOrderShow">\n        <i class="'+c((o=null!=(o=n.icon||(null!=e?e.icon:e))?o:s,typeof o===l?o.call(r,{name:"icon",hash:{},data:a}):o))+'"></i>\n        '+c((n.t||e&&e.t||s).call(r,null!=e?e.title:e,{name:"t",hash:{},data:a}))+'\n        <i class="icon-remove action"></i>\n    </a>\n    <section class="content">\n        <form action="#" autocomplete="on" id="form_'+c((o=null!=(o=n.id||(null!=e?e.id:e))?o:s,typeof o===l?o.call(r,{name:"id",hash:{},data:a}):o))+'" onsubmit="return false;">\n            <button type="submit" name="testname" value="test" style="display: none;"/>\n        </form>\n    </section>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],134:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return"mobile"},3:function(t,e,n,i,a){return"web"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d='<div class="modalWrapper overlay nodrag ';return r=null!=(r=n.Mobile||(null!=e?e.Mobile:e))?r:c,s={name:"Mobile",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Mobile||(o=h.call(e,o,s)),null!=o&&(d+=o),r=null!=(r=n.Desktop||(null!=e?e.Desktop:e))?r:c,s={name:"Desktop",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Desktop||(o=h.call(e,o,s)),null!=o&&(d+=o),d+'" data-id="'+t.escapeExpression((r=null!=(r=n.id||(null!=e?e.id:e))?r:c,typeof r===u?r.call(l,{name:"id",hash:{},data:a}):r))+'"></div>\n'},useData:!0})},{"hbsfy/runtime":375}],135:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'            <div class="checkbox">\n                <input type="checkbox" name="isZip" value="1"/>\n                <label for="isZip">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.download.zip_label",{name:"t",hash:{},data:a}))+"</label>\n            </div>\n"},3:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return"    <section>\n        <span>"+s((n.t||e&&e.t||r).call(o,"modal.download.include_label",{name:"t",hash:{},data:a}))+'</span>\n        <div class="checkbox"><input type="checkbox" name="isThumb" value="1"/>\n            <label for="isThumb" style="width: 90px;">'+s((n.t||e&&e.t||r).call(o,"modal.download.thumb_label",{name:"t",hash:{},data:a}))+'</label>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled thumbDimensions" data-type="width" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.width_label",{name:"t",hash:{},data:a}))+'"/><span>X</span>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled thumbDimensions" data-type="height" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.height_label",{name:"t",hash:{},data:a}))+'"/><span>px</span>\n        </div>\n\n        <div class="checkbox"><input type="checkbox" name="isWeb" value="1"/>\n            <label for="isWeb" style="width: 90px;">'+s((n.t||e&&e.t||r).call(o,"modal.download.web_label",{name:"t",hash:{},data:a}))+'</label>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled webDimensions" data-type="width" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.width_label",{name:"t",hash:{},data:a}))+'"/><span>X</span>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled webDimensions" data-type="height" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.height_label",{name:"t",hash:{},data:a}))+'"/><span>px</span>\n        </div>\n\n        <div class="checkbox"><input type="checkbox" name="isMobile" value="1"/>\n            <label for="isMobile" style="width: 90px;">'+s((n.t||e&&e.t||r).call(o,"modal.download.mobile_label",{name:"t",hash:{},data:a}))+'</label>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled mobileDimensions" data-type="width" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.width_label",{name:"t",hash:{},data:a}))+'"/><span>X</span>\n            <input type="number" style="margin: 0 5px; position:relative;" class="form-control small disabled mobileDimensions" data-type="height" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.download.height_label",{name:"t",hash:{},data:a}))+'"/><span>px</span>\n        </div>\n    </section>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u=t.escapeExpression,h="function",d=n.blockHelperMissing,p='<section style="display: block; float: left; margin-right: 10px;">\n    <section id="quality-section">\n        <span>'+u((n.t||e&&e.t||c).call(l,"modal.download.quality_label",{name:"t",hash:{},data:a}))+'</span>\n\n        <ul class="btnWrapper">\n            <li>\n                <a class="btn btn-squire btn-tag quality active" tag="'+u((n.t||e&&e.t||c).call(l,"modal.download.high_label",{name:"t",hash:{},data:a}))+'" data-value="92">\n                    <div class="iconWrapper"><i class="icon-brightness_1"></i></div>\n                </a>\n            </li>\n            <li>\n                <a class="btn btn-squire btn-tag quality" tag="'+u((n.t||e&&e.t||c).call(l,"modal.download.medium_label",{name:"t",hash:{},data:a}))+'" data-value="75">\n                    <div class="iconWrapper"><i class="icon-brightness_2"></i></div>\n                </a>\n            </li>\n            <li>\n                <a class="btn btn-squire btn-tag quality" tag="'+u((n.t||e&&e.t||c).call(l,"modal.download.low_label",{name:"t",hash:{},data:a}))+'" data-value="60">\n                    <div class="iconWrapper"><i class="icon-brightness_3"></i></div>\n                </a>\n            </li>\n        </ul>\n    </section>\n\n    <span>'+u((n.t||e&&e.t||c).call(l,"modal.download.resize_label",{name:"t",hash:{},data:a}))+'</span>\n    <section>\n        <input type="number" style="margin: 0 5px; position:relative;" class="form-control small rangeCurrentDimensions" data-type="width" placeholder="'+u((n.t||e&&e.t||c).call(l,"modal.download.width_label",{name:"t",hash:{},data:a}))+'"/><span>X</span>\n        <input type="number" style="margin: 0 5px; position:relative;" class="form-control small rangeCurrentDimensions" data-type="height" placeholder="'+u((n.t||e&&e.t||c).call(l,"modal.download.height_label",{name:"t",hash:{},data:a}))+'"/><span>px</span>\n    </section>\n</section>\n\n<section style="display: block; float: right;">\n    <section>\n        <span>'+u((n.t||e&&e.t||c).call(l,"modal.download.settings_label",{name:"t",hash:{},data:a}))+'</span>\n        <div class="checkbox"><input type="checkbox" name="isBleed" value="1"/>\n            <label for="isBleed">'+u((n.t||e&&e.t||c).call(l,"modal.download.bleed_label",{name:"t",hash:{},data:a}))+"</label></div>\n\n";return r=null!=(r=n.displayZipOption||(null!=e?e.displayZipOption:e))?r:c,s={name:"displayZipOption",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===h?r.call(l,s):r,n.displayZipOption||(o=d.call(e,o,s)),null!=o&&(p+=o),p+="    </section>\n\n",r=null!=(r=n.display_extended_options||(null!=e?e.display_extended_options:e))?r:c,s={name:"display_extended_options",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===h?r.call(l,s):r,n.display_extended_options||(o=d.call(e,o,s)),null!=o&&(p+=o),p+"</section>\n"},useData:!0})},{"hbsfy/runtime":375}],136:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<section>\n    <input type="text" class="findFriendsSearch" id="search" name="search" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.friends.search_placeholder",{name:"t",hash:{},data:a}))+'" data-role="tagsinput"/>\n    <div class="antiscroll-wrap">\n        <div class="antiscroll-inner">\n            <ul class="friends" style="padding-right: 15px; list-style: none;"></ul>\n        </div>\n    </div>\n</section>\n<hr/>\n\n<section data-description="'+s((n.t||e&&e.t||r).call(o,"modal.friends.invite_description",{name:"t",hash:{},data:a}))+'">\n    <input type="text" id="email4inviting" name="emails" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.friends.email_placeholder",{name:"t",hash:{},data:a}))+'"/>\n</section>\n\n<section style="display: none;">\n    <textarea id="inviteFriendComments" placeholder="'+s((n.t||e&&e.t||r).call(o,"modal.friends.message_placeholder",{name:"t",hash:{},data:a}))+'"></textarea>\n</section>\n'},useData:!0})},{"hbsfy/runtime":375}],137:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return t.escapeExpression(t.lambda(e,e))},3:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="            ";return r=null!=(r=n.Desygner||(null!=e?e.Desygner:e))?r:c,s={name:"Desygner",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Desygner||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n            ",r=null!=(r=n.Photobooky||(null!=e?e.Photobooky:e))?r:c,s={name:"Photobooky",hash:{},fn:t.program(6,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Photobooky||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"\n"},4:function(t,e,n,i,a){return"Desygner"},6:function(t,e,n,i,a){return"Photobooky"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d=n.blockHelperMissing,p='<li class="media grayscale" data-id="'+h((r=null!=(r=n.user_id||(null!=e?e.user_id:e))?r:c,typeof r===u?r.call(l,{name:"user_id",hash:{},data:a}):r))+'" data-network="Inkive">\n    <img class="media-object pull-left" alt="'+h((r=null!=(r=n.user_name||(null!=e?e.user_name:e))?r:c,typeof r===u?r.call(l,{name:"user_name",hash:{},data:a}):r))+'" src="'+h((r=null!=(r=n.profile_pic||(null!=e?e.profile_pic:e))?r:c,typeof r===u?r.call(l,{name:"profile_pic",hash:{},data:a}):r))+'" style="width: 42px; height: 42px">\n    <a style="width:20%" class="pull-right btn btn-inkive btn-black btn-xs btn-add-request">'+h((n.t||e&&e.t||c).call(l,"modal.friends.search_add_label",{
name:"t",hash:{},data:a}))+'</a>\n\n    <div class="media-body">\n        <span class="media-heading">\n            <strong>'+h((r=null!=(r=n.user_name||(null!=e?e.user_name:e))?r:c,typeof r===u?r.call(l,{name:"user_name",hash:{},data:a}):r))+"</strong><br />\n            ";return r=null!=(r=n.source||(null!=e?e.source:e))?r:c,s={name:"source",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.source||(o=d.call(e,o,s)),null!=o&&(p+=o),p+="\n",r=null!=(r=n.source||(null!=e?e.source:e))?r:c,s={name:"source",hash:{},fn:t.noop,inverse:t.program(3,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.source||(o=d.call(e,o,s)),null!=o&&(p+=o),p+"        </span>\n    </div>\n</li>\n"},useData:!0})},{"hbsfy/runtime":375}],138:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="info-message text-center">\n    <div class="spinner-wrapper">\n        <div class="spinner small">\n            <circle class="path"></circle>\n        </div>\n    </div>\n    <div class="empty-text">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.friends.loading_label",{name:"t",hash:{},data:a}))+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],139:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="info-message text-center">\n    <div class="empty-text">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.friends.no_results_label",{name:"t",hash:{},data:a}))+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],140:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l=t.escapeExpression,c="function";return"<p>\n    "+l((n.t||e&&e.t||s).call(r,"modal.help.hello",{name:"t",hash:{},data:a}))+" "+l((o=null!=(o=n.user_name||(null!=e?e.user_name:e))?o:s,typeof o===c?o.call(r,{name:"user_name",hash:{},data:a}):o))+",<br />\n    <small>"+l((n.t||e&&e.t||s).call(r,"modal.help.message",{name:"t",hash:{},data:a}))+'</small>\n</p>\n<section>\n    <label for="name">'+l((n.t||e&&e.t||s).call(r,"modal.help.name_label",{name:"t",hash:{},data:a}))+'</label>\n    <input type="text" name="name" class="form-control" id="name" value="'+l((o=null!=(o=n.user_name||(null!=e?e.user_name:e))?o:s,typeof o===c?o.call(r,{name:"user_name",hash:{},data:a}):o))+'"/>\n</section>\n<section>\n    <label for="email">'+l((n.t||e&&e.t||s).call(r,"modal.help.email_label",{name:"t",hash:{},data:a}))+'</label>\n    <input type="text" name="email" class="form-control" id="email" value="'+l((o=null!=(o=n.user_email||(null!=e?e.user_email:e))?o:s,typeof o===c?o.call(r,{name:"user_email",hash:{},data:a}):o))+'"/>\n</section>\n<section>\n    <label for="help">'+l((n.t||e&&e.t||s).call(r,"modal.help.help_label",{name:"t",hash:{},data:a}))+'</label>\n    <textarea name="help" rows="3" class="form-control"></textarea>\n</section>\n'},useData:!0})},{"hbsfy/runtime":375}],141:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<section>\n    <img src="'+c((o=null!=(o=n.thumb||(null!=e?e.thumb:e))?o:s,typeof o===l?o.call(r,{name:"thumb",hash:{},data:a}):o))+'" width="124"/>\n    <div style="display: inline-block; vertical-align: top; padding-left: 10px; width: 340px;">\n        <strong>'+c((o=null!=(o=n.book_name||(null!=e?e.book_name:e))?o:s,typeof o===l?o.call(r,{name:"book_name",hash:{},data:a}):o))+"</strong><br/>\n        <span>"+c((o=null!=(o=n.book_description||(null!=e?e.book_description:e))?o:s,typeof o===l?o.call(r,{name:"book_description",hash:{},data:a}):o))+"</span>\n    </div>\n</section>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d="";return r=null!=(r=n.Desktop||(null!=e?e.Desktop:e))?r:c,s={name:"Desktop",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Desktop||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(d+=o),d+'\n<section>\n    <label for="share_email">'+h((n.t||e&&e.t||c).call(l,"modal.share_email.address_label",{name:"t",hash:{},data:a}))+'</label>\n    <input type="email" name="share_email" class="form-control" id="share_email" placeholder="'+h((n.t||e&&e.t||c).call(l,"modal.share_email.address_placeholder",{name:"t",hash:{},data:a}))+'"/>\n</section>\n\n<section>\n    <label for="sender_username">'+h((n.t||e&&e.t||c).call(l,"modal.share_email.name_label",{name:"t",hash:{},data:a}))+'</label>\n    <input type="text" name="sender_username" class="form-control" id="sender_username" placeholder="'+h((n.t||e&&e.t||c).call(l,"modal.share_email.name_placeholder",{name:"t",hash:{},data:a}))+'" value="'+h((r=null!=(r=n.user_name||(null!=e?e.user_name:e))?r:c,typeof r===u?r.call(l,{name:"user_name",hash:{},data:a}):r))+'"/>\n</section>\n\n<section>\n    <label for="share_comments">'+h((n.t||e&&e.t||c).call(l,"modal.share_email.message_label",{name:"t",hash:{},data:a}))+'</label>\n    <textarea name="share_comments" class="form-control" placeholder="'+h((n.t||e&&e.t||c).call(l,"modal.share_email.message_placeholder",{name:"t",hash:{},data:a}))+'"></textarea>\n</section>\n'},useData:!0})},{"hbsfy/runtime":375}],142:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'        <label for="bookName">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.share_embed.display_project",{name:"t",hash:{},data:a}))+"</label>\n"},3:function(t,e,n,i,a){return'        <label for="bookName">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"modal.share_embed.display_book",{name:"t",hash:{},data:a}))+"</label>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u=t.escapeExpression,h="function",d=n.blockHelperMissing,p='<section style="display: block; float: left; margin-right: 10px;">\n    <span>'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.type_label",{name:"t",hash:{},data:a}))+'</span>\n\n    <ul class="btnWrapper">\n        <li>\n            <a class="btn btn-squire btn-tag type active" tag="'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.slideshow",{name:"t",hash:{},data:a}))+'" data-id="slide">\n                <div class="iconWrapper"><i class="icon-square-o"></i></div>\n            </a>\n        </li>\n        <li>\n            <a class="btn btn-squire btn-tag type" tag="'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.scrolling",{name:"t",hash:{},data:a}))+'" data-id="scroll">\n                <div class="iconWrapper"><i class="icon-square-o"></i></div>\n            </a>\n        </li>\n    </ul>\n</section>\n\n<section style="display: block; float: left;" id="share-embed-size">\n    <span id="share-embed-size-text">'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.size_label",{name:"t",hash:{},data:a}))+'</span>\n\n    <ul class="btnWrapper">\n        <li>\n            <a class="btn btn-squire btn-tag size active" tag="290 x 205" data-id="290">\n                <div class="iconWrapper"><i class="icon-square-o" style="font-size:0.6em;"></i></div>\n            </a>\n        </li>\n        <li>\n            <a class="btn btn-squire btn-tag size" tag="500 x 354" data-id="500">\n                <div class="iconWrapper"><i class="icon-square-o" style="font-size:0.8em;"></i></div>\n            </a>\n        </li>\n        <li>\n            <a class="btn btn-squire btn-tag size" tag="800 x 566" data-id="800">\n                <div class="iconWrapper"><i class="icon-square-o" style="font-size:1.0em;"></i></div>\n            </a>\n        </li>\n        <li>\n            <a class="btn btn-squire btn-tag size" tag="'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.custom",{name:"t",hash:{},data:a}))+'" data-id="custom">\n                <div class="iconWrapper"><i class="icon-square-o" style="font-size:1.2em;"></i></div>\n            </a>\n        </li>\n        <li>\n            <div id="share-embed-custom-sizes" style="display: none;">\n                <input type="number" name="width" class="form-control small" value="'+u((r=null!=(r=n.width||(null!=e?e.width:e))?r:c,typeof r===h?r.call(l,{name:"width",hash:{},data:a}):r))+'"/>\n                <span>&nbsp;X&nbsp;<span>\n                <input type="number" name="height" class="form-control small" value="'+u((r=null!=(r=n.height||(null!=e?e.height:e))?r:c,typeof r===h?r.call(l,{name:"height",hash:{},data:a}):r))+'"/>\n            </div>\n        </li>\n    </ul>\n</section>\n\n<section style="clear: both;" id="share-embed-checkboxes">\n    <div class="checkbox">\n        <input type="checkbox" name="bookName" id="bookName" value="1"/>\n';return r=null!=(r=n.Desygner||(null!=e?e.Desygner:e))?r:c,s={name:"Desygner",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===h?r.call(l,s):r,n.Desygner||(o=d.call(e,o,s)),null!=o&&(p+=o),p+="\n",r=null!=(r=n.Photobooky||(null!=e?e.Photobooky:e))?r:c,s={name:"Photobooky",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===h?r.call(l,s):r,n.Photobooky||(o=d.call(e,o,s)),null!=o&&(p+=o),p+'    </div>\n    <div class="checkbox">\n        <input type="checkbox" name="bookViews" id="bookViews" value="1"/>\n        <label for="bookViews">'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.display_numbers",{name:"t",hash:{},data:a}))+'</label>\n    </div>\n</section>\n\n<section style="clear: both;">\n    <label for="code">'+u((n.t||e&&e.t||c).call(l,"modal.share_embed.code_label",{name:"t",hash:{},data:a}))+'</label>\n    <textarea name="code" class="form-control" readonly="readonly"></textarea>\n</section>\n'},useData:!0})},{"hbsfy/runtime":375}],143:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'            <div id="pageMenu">\n                <div id="info" class="help">'+s((n.t||e&&e.t||r).call(o,"page_order.select",{name:"t",hash:{},data:a}))+'</div>\n                <a class="tool-icon" id="ik-add-page" tag="'+s((n.t||e&&e.t||r).call(o,"page_order.new",{name:"t",hash:{},data:a}))+'"><i class="icon-plus"></i></a>\n                <a class="tool-icon" id="ik-copy-page" tag="'+s((n.t||e&&e.t||r).call(o,"page_order.duplicate",{name:"t",hash:{},data:a}))+'"><i class="icon-copy"></i></a>\n                <a class="tool-icon" id="ik-delete-page" tag="'+s((n.t||e&&e.t||r).call(o,"page_order.delete",{name:"t",hash:{},data:a}))+'"><i class="icon-bin"></i></a>\n            </div>\n\n            <div class="pageSubmenu">\n                <a class="tool-icon top" id="ik-show-pagemenu" data-popover="tooltip" data-original-title="'+s((n.t||e&&e.t||r).call(o,"page_order.show_menu",{name:"t",hash:{},data:a}))+'">\n                    <i class="icon-chevron-down"></i>\n                </a>\n            </div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d='<div class="thumbnail" data="'+h((r=null!=(r=n.page_id||(null!=e?e.page_id:e))?r:c,typeof r===u?r.call(l,{name:"page_id",hash:{},data:a}):r))+'">\n    <div class="pageOrderWrapper"><a class="block">\n        <img id="page-'+h((r=null!=(r=n.page_id||(null!=e?e.page_id:e))?r:c,typeof r===u?r.call(l,{name:"page_id",hash:{},data:a}):r))+'"/></a>\n        <a id="ik-hide-pagemenu">\n            <span>'+h((n.t||e&&e.t||c).call(l,"page_order.cancel",{name:"t",hash:{},data:a}))+'</span><span class="icon-remove"></span>\n        </a>\n\n';return r=null!=(r=n.Desktop||(null!=e?e.Desktop:e))?r:c,s={name:"Desktop",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.Desktop||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(d+=o),d+"    </div>\n\n    <p><label>"+h((r=null!=(r=n.name||(null!=e?e.name:e))?r:c,typeof r===u?r.call(l,{name:"name",hash:{},data:a}):r))+"</label></p>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],144:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<li class="space" data-additional-menu="true" style="display: none;"></li>\n'},useData:!0})},{"hbsfy/runtime":375}],145:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'<li><a role="menuitem">'+t.escapeExpression(t.lambda(e,e))+" pt</a></li>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return"<ul>\n    "+(null!=(o=n.each.call(null!=e?e:{},e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"\n</ul>\n"},useData:!0})},{"hbsfy/runtime":375}],146:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<li>\n    <a class="btn btn-onmenu" data-action="on_show_more">\n        '+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"popupmenu.show_more",{name:"t",hash:{},data:a}))+"\n    </a>\n</li>\n"},useData:!0})},{"hbsfy/runtime":375}],147:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a,o,r){var s=t.lambda,l=t.escapeExpression;return'    <li>\n        <svg width="207" height="30" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            <line stroke-dasharray="'+l(s(e,e))+'" stroke-width="'+l(s(null!=r[1]?r[1].width:r[1],e))+'" x1="0" y1="15" x2="207" y2="15"/>\n        </svg>\n    </li>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a,o,r){var s,l,c=null!=e?e:{};return'<ul class="stroke-dasharray">\n    <li>\n        <svg width="207" height="30" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            <line stroke-width="'+t.escapeExpression((l=null!=(l=n.width||(null!=e?e.width:e))?l:n.helperMissing,"function"==typeof l?l.call(c,{name:"width",hash:{},data:a}):l))+'" x1="0" y1="15" x2="207" y2="15"/>\n        </svg>\n    </li>\n'+(null!=(s=n.each.call(c,null!=e?e.dashArrays:e,{name:"each",hash:{},fn:t.program(1,a,0,o,r),inverse:t.noop,data:a}))?s:"")+"</ul>\n"},useData:!0,useDepths:!0})},{"hbsfy/runtime":375}],148:[function(t,e,n){var i={modal:t("./modal/base/modal.hbs"),modal_alert:t("./modal/base/alert.hbs"),modal_wrapper:t("./modal/base/wrapper.hbs"),modal_buttons:t("./modal/base/buttons.hbs"),modal_loader:t("./modal/base/loader.hbs"),modal_layout_load:t("./modal/base/layout-load.hbs"),alert_default:t("./modal/alert/default.hbs"),alert_delete_confirm:t("./modal/alert/delete-confirm.hbs"),alert_span:t("./modal/alert/span.hbs"),alert_bold:t("./modal/alert/bold.hbs"),popupmenu_showmore:t("./popupmenu/show-more.hbs"),popupmenu_additional:t("./popupmenu/additional.hbs"),popupmenu_font_size_list:t("./popupmenu/font-size-list.hbs"),popupmenu_stroke_dasharray:t("./popupmenu/stroke-dasharray.hbs"),pageorder_thumb:t("./pageorder/thumb.hbs")};e.exports=function(t,e){return i[t]?i[t](e):void 0}},{"./modal/alert/bold.hbs":125,"./modal/alert/default.hbs":126,"./modal/alert/delete-confirm.hbs":127,"./modal/alert/span.hbs":128,"./modal/base/alert.hbs":129,"./modal/base/buttons.hbs":130,"./modal/base/layout-load.hbs":131,"./modal/base/loader.hbs":132,"./modal/base/modal.hbs":133,"./modal/base/wrapper.hbs":134,"./pageorder/thumb.hbs":143,"./popupmenu/additional.hbs":144,"./popupmenu/font-size-list.hbs":145,"./popupmenu/show-more.hbs":146,"./popupmenu/stroke-dasharray.hbs":147}],149:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'class="vertical"'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d='<g clip-path="url(#'+h((r=null!=(r=n.clipId||(null!=e?e.clipId:e))?r:c,typeof r===u?r.call(l,{name:"clipId",hash:{},data:a}):r))+')" height="'+h((r=null!=(r=n.size||(null!=e?e.size:e))?r:c,typeof r===u?r.call(l,{name:"size",hash:{},data:a}):r))+'" width="'+h((r=null!=(r=n.size||(null!=e?e.size:e))?r:c,typeof r===u?r.call(l,{name:"size",hash:{},data:a}):r))+'" y="'+h((r=null!=(r=n.y||(null!=e?e.y:e))?r:c,typeof r===u?r.call(l,{name:"y",hash:{},data:a}):r))+'" x="'+h((r=null!=(r=n.x||(null!=e?e.x:e))?r:c,typeof r===u?r.call(l,{name:"x",hash:{},data:a}):r))+'">\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n     id="'+h((r=null!=(r=n.id||(null!=e?e.id:e))?r:c,typeof r===u?r.call(l,{name:"id",hash:{},data:a}):r))+'" height="'+h((r=null!=(r=n.size||(null!=e?e.size:e))?r:c,typeof r===u?r.call(l,{name:"size",hash:{},data:a}):r))+'" width="'+h((r=null!=(r=n.size||(null!=e?e.size:e))?r:c,typeof r===u?r.call(l,{name:"size",hash:{},data:a}):r))+'" y="'+h((r=null!=(r=n.y||(null!=e?e.y:e))?r:c,typeof r===u?r.call(l,{name:"y",hash:{},data:a}):r))+'" x="'+h((r=null!=(r=n.x||(null!=e?e.x:e))?r:c,typeof r===u?r.call(l,{name:"x",hash:{},data:a}):r))+'" ';return r=null!=(r=n.is_vertical||(null!=e?e.is_vertical:e))?r:c,s={name:"is_vertical",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.is_vertical||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(d+=o),d+'\n     viewBox="0 0 1280 1280" enable-background="new 0 0 1280 1280" xml:space="preserve">\n        <g id="bg">\n            <rect fill="#9BC9D4" width="1280" height="936"/>\n            <rect y="914" fill="#72A862" width="1280" height="366"/>\n        </g>\n        <g class="sky">\n            <g class="cloud">\n                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M199.331,430.797c-1.287-7.37,0.87-13.442,7.053-17.595\n                    c6.536-4.389,13.351-4.055,19.751-0.271c2.852-3.395,5.261-7.127,8.479-9.933c10.082-8.788,21.739-10.796,34.015-5.625\n                    c12.268,5.165,18.91,14.864,19.809,28.24c0.138,2.053,0.498,3.153,2.718,3.989c10.525,3.957,17.133,16.158,15.34,27.738\n                    c-1.622,10.467-6.968,17.88-17.418,20.954c-1.912,0.562-4,0.732-6.006,0.735c-26.073,0.048-52.145,0.045-78.218,0.025\n                    c-12.834-0.009-22.492-8.336-24.433-20.987c-1.78-11.604,5.839-23.202,17.576-26.768\n                    C198.429,431.171,198.845,430.982,199.331,430.797z"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" fill="#F2F2F2" d="M405.854,465.442c11.737,3.564,19.356,15.162,17.576,26.766\n                    c-1.941,12.653-11.599,20.979-24.433,20.987c-26.073,0.021-73.944,0.023-100.018-0.024c-2.007-0.003-4.094-0.174-6.006-0.736\n                    c-10.45-3.073-15.797-10.487-17.418-20.953c-1.794-11.58,4.814-23.782,15.339-27.739c2.22-0.835,2.58-1.937,2.718-3.989\n                    c0.898-13.375,7.541-23.073,19.809-28.24c12.276-5.169,38.33-10.775,55.814,5.626c3.219,2.805,5.628,6.538,8.479,9.933\n                    c6.401-3.783,13.215-4.117,19.751,0.271c6.183,4.151,8.339,10.226,7.052,17.594C405.006,465.122,405.421,465.311,405.854,465.442z\n                    "/>\n            </g>\n            <circle class="sun" fill="#FFD300" cx="897.401" cy="443.524" r="97.165"/>\n        </g>\n        <g class="mountain">\n            <polygon class="small" fill="#927983" points="657.588,914 842.176,594.252 1026.777,914"/>\n            <g class="big">\n                <g>\n                    <polygon fill="#735C65" points="331.002,914 613.958,423.855 896.934,914"/>\n                </g>\n                <polygon fill="#FEFEFE" points="606.685,610.174 649.338,552.498 710.109,590.374 710.109,590.374 613.958,423.827\n                    518.706,588.824 573.51,560.886"/>\n            </g>\n            <g class="trees">\n                <g>\n                    <rect x="357" y="978" fill="#A76743" width="8" height="34"/>\n                    <polygon fill="#858651" points="329.142,995 363.145,936.109 397.153,995"/>\n                </g>\n                <g>\n                    <rect x="272" y="948" fill="#A76743" width="8" height="34"/>\n                    <polygon fill="#858651" points="244.142,965 278.145,906.109 312.153,965"/>\n                </g>\n                <g>\n                    <rect x="225" y="957" fill="#A76743" width="9" height="33"/>\n                    <polygon fill="#009245" points="195.77,973 230.921,912.12 266.08,973"/>\n                </g>\n                <g>\n                    <rect x="310" y="987" fill="#A76743" width="9" height="33"/>\n                    <polygon fill="#009245" points="280.77,1003 315.922,942.12 351.08,1003"/>\n                </g>\n            </g>\n        </g>\n        <g class="text">\n            <g>\n                <g>\n                    <g>\n                        <g>\n                            <path fill="#FFFFFF" d="M451.408,822.89V710.513h25.784c9.459,0,16.877,0.437,22.24,1.296\n                                c5.368,0.872,9.984,2.268,13.848,4.197c8.138,4.021,14.316,10.341,18.542,18.962c4.217,8.621,6.334,19.236,6.334,31.85\n                                c0,12.668-2.123,23.314-6.375,31.964c-4.245,8.655-10.416,14.86-18.501,18.617c-4.02,1.936-8.834,3.333-14.458,4.196\n                                c-5.619,0.867-12.832,1.295-21.63,1.295H451.408z M456.745,818.087h21.671c8.437,0,15.177-0.448,20.219-1.34\n                                c5.028-0.884,9.454-2.324,13.275-4.304c6.709-3.546,11.844-9.242,15.411-17.078c3.555-7.826,5.339-17.384,5.339-28.661\n                                c0-9.495-1.249-17.736-3.74-24.712c-2.491-6.948-6.207-12.621-11.135-16.995c-3.918-3.496-8.729-5.992-14.423-7.46\n                                c-5.697-1.483-14.014-2.211-24.947-2.211h-21.671V818.087z"/>\n                            <path fill="#FFFFFF" d="M556.994,822.89v-81.098h5.036v14.575c2.039-5.389,5.088-9.449,9.156-12.169\n                                c4.073-2.721,9.084-4.082,15.029-4.082v4.805c-8.751,0.355-14.964,3.406-18.651,9.156c-3.69,5.747-5.534,15.57-5.534,29.452\n                                v39.36H556.994z"/>\n                            <path fill="#FFFFFF" d="M664.566,823.35c-0.558,0.052-1.317,0.142-2.288,0.268c-0.967,0.131-1.675,0.188-2.136,0.188\n                                c-3.711,0-6.404-1.14-8.085-3.429c-1.679-2.29-2.519-6.028-2.519-11.213c-3.259,5.035-7.693,8.923-13.317,11.672\n                                c-5.614,2.747-12.063,4.116-19.333,4.116c-7.224,0-13.056-2.095-17.51-6.293c-4.452-4.19-6.676-9.701-6.676-16.517\n                                c0-7.176,2.445-12.643,7.324-16.403c4.881-3.765,13.224-6.484,25.023-8.163c2.083-0.302,4.911-0.656,8.469-1.07\n                                c10.683-1.225,16.021-3.994,16.021-8.314v-6.867c0-5.488-1.887-9.7-5.647-12.623c-3.756-2.926-9.181-4.389-16.249-4.389\n                                c-8.084,0-14.452,1.755-19.109,5.261c-4.656,3.515-7.188,8.469-7.592,14.879h-4.654c0.303-7.576,3.217-13.551,8.739-17.93\n                                c5.518-4.373,12.901-6.555,22.156-6.555c5.647,0,10.494,0.785,14.539,2.36c4.04,1.576,7.136,3.894,9.269,6.942\n                                c1.219,1.778,2.098,3.801,2.628,6.064c0.533,2.262,0.802,5.838,0.802,10.721v3.436v36.082c0,5.747,0.511,9.529,1.528,11.333\n                                c1.017,1.801,2.899,2.704,5.648,2.704c0.502,0,1.349-0.069,2.513-0.228c0.211-0.049,0.358-0.077,0.457-0.077V823.35z\n                                 M649.539,776.506c-1.267,1.732-6.971,3.181-17.086,4.35c-1.627,0.206-2.903,0.361-3.817,0.457\n                                c-11.546,1.479-19.572,3.727-24.073,6.752c-4.499,3.027-6.753,7.446-6.753,13.238c0,6,1.784,10.63,5.346,13.886\n                                c3.56,3.25,8.62,4.884,15.179,4.884c4.38,0,8.583-0.698,12.626-2.103c4.042-1.401,7.541-3.343,10.493-5.836\n                                c3.002-2.645,5.095-5.604,6.289-8.887c1.202-3.281,1.797-8.197,1.797-14.76V776.506z"/>\n                            <path fill="#FFFFFF" d="M740.171,805.573c-2.689,6.26-6.724,11.105-12.083,14.537c-5.37,3.431-11.663,5.147-18.887,5.147\n                                c-10.94,0-19.587-3.812-25.941-11.44c-6.354-7.632-9.538-18.036-9.538-31.207c0-13.228,3.194-23.612,9.573-31.163\n                                c6.387-7.558,15.122-11.331,26.215-11.331c7.37,0,13.769,1.751,19.186,5.26c5.414,3.514,9.246,8.373,11.476,14.577v-18.161\n                                h4.81v76.754c0,6.152-0.394,10.845-1.181,14.074c-0.792,3.231-2.099,6.192-3.927,8.886c-3.16,4.632-7.48,8.131-12.974,10.492\n                                c-5.496,2.371-12,3.544-19.533,3.544c-9.154,0-16.474-2.167-21.967-6.522c-5.498-4.343-8.292-10.13-8.395-17.354h4.732\n                                c0.299,6.1,2.82,10.887,7.552,14.341c4.733,3.46,11.164,5.188,19.297,5.188c6.767,0,12.481-1.153,17.13-3.467\n                                c4.654-2.316,8.272-5.761,10.871-10.342c1.277-2.284,2.192-4.957,2.75-8.007c0.563-3.052,0.834-8.243,0.834-15.562V805.573z\n                                 M740.171,782.61c0-11.854-2.744-21.169-8.237-27.966c-5.488-6.783-12.974-10.175-22.424-10.175\n                                c-9.459,0-16.95,3.392-22.473,10.175c-5.519,6.797-8.278,16.112-8.278,27.966c0,11.798,2.76,21.099,8.278,27.883\n                                c5.522,6.793,13.014,10.187,22.473,10.187c9.45,0,16.936-3.394,22.424-10.187C737.427,803.709,740.171,794.408,740.171,782.61z\n                                "/>\n                        </g>\n                        <g>\n                            <path fill="#FFFFFF" d="M618.807,833.938v110.425h-4.725v-17.729c-2.557,6.515-6.405,11.457-11.534,14.84\n                                c-5.132,3.38-11.357,5.073-18.669,5.073c-10.916,0-19.518-3.737-25.803-11.197c-6.283-7.46-9.429-17.682-9.429-30.656\n                                c0-12.97,3.157-23.184,9.466-30.646c6.306-7.46,14.898-11.194,25.766-11.194c7.212,0,13.459,1.683,18.738,5.035\n                                c5.292,3.358,9.109,8.086,11.465,14.199v-48.15H618.807z M614.082,904.694c0-11.662-2.711-20.839-8.116-27.523\n                                c-5.41-6.684-12.768-10.029-22.087-10.029c-9.31,0-16.688,3.346-22.121,10.029c-5.43,6.685-8.151,15.861-8.151,27.523\n                                c0,11.626,2.722,20.776,8.151,27.466c5.434,6.687,12.811,10.03,22.121,10.03c9.319,0,16.677-3.344,22.087-10.03\n                                C611.371,925.471,614.082,916.32,614.082,904.694z"/>\n                            <path fill="#FFFFFF" d="M640.144,944.363V864.51h4.958v14.352c2-5.31,5.007-9.309,9.02-11.98\n                                c4.002-2.687,8.936-4.026,14.789-4.026v4.739c-8.611,0.346-14.729,3.354-18.362,9.013c-3.63,5.659-5.446,15.324-5.446,29.001\n                                v38.756H640.144z"/>\n                            <path fill="#FFFFFF" d="M676.802,904.694c0-12.97,3.137-23.184,9.396-30.646c6.262-7.46,14.815-11.194,25.689-11.194\n                                c10.863,0,19.451,3.734,25.766,11.194c6.309,7.462,9.465,17.676,9.465,30.646c0,12.928-3.156,23.131-9.465,30.616\n                                c-6.314,7.487-14.902,11.237-25.766,11.237c-10.874,0-19.428-3.737-25.689-11.197\n                                C679.938,927.891,676.802,917.669,676.802,904.694z M681.759,904.694c0,11.626,2.697,20.776,8.081,27.466\n                                c5.382,6.687,12.733,10.03,22.047,10.03c9.314,0,16.692-3.344,22.159-10.03c5.454-6.689,8.188-15.84,8.188-27.466\n                                c0-11.662-2.733-20.839-8.188-27.523c-5.467-6.684-12.845-10.029-22.159-10.029c-9.313,0-16.665,3.346-22.047,10.029\n                                C684.456,883.855,681.759,893.032,681.759,904.694z"/>\n                            <path fill="#FFFFFF" d="M764.475,976.065V864.51h4.957v18.325c2.55-6.55,6.367-11.529,11.449-14.912\n                                c5.083-3.374,11.309-5.068,18.671-5.068c10.916,0,19.519,3.722,25.802,11.161c6.283,7.437,9.428,17.66,9.428,30.679\n                                c0,12.928-3.156,23.131-9.463,30.616c-6.312,7.487-14.901,11.237-25.767,11.237c-7.27,0-13.485-1.674-18.671-5.002\n                                c-5.177-3.327-9-8.128-11.449-14.383v48.902H764.475z M769.432,904.694c0,11.626,2.685,20.776,8.073,27.466\n                                c5.382,6.687,12.728,10.03,22.047,10.03c9.368,0,16.764-3.344,22.196-10.03c5.437-6.689,8.145-15.84,8.145-27.466\n                                c0-11.662-2.708-20.839-8.145-27.523c-5.433-6.684-12.828-10.029-22.196-10.029c-9.319,0-16.665,3.346-22.047,10.029\n                                C772.116,883.855,769.432,893.032,769.432,904.694z M778.844,874.899h-4.958v-20.423h4.958v10.627"/>\n                        </g>\n                    </g>\n                    <g>\n                        <path fill="#FFFFFF" d="M488.177,891.47l16.338,19.965c1.273-2.285,2.26-4.757,2.96-7.414c0.703-2.652,1.167-5.565,1.387-8.73\n                            h13.9c-0.305,5.098-1.219,9.895-2.73,14.394c-1.516,4.508-3.68,8.738-6.493,12.683l17.986,21.741h-18.907l-8.233-10.144\n                            c-3.865,4.215-8.271,7.367-13.211,9.457c-4.941,2.084-10.463,3.127-16.568,3.127c-8.258,0-15.079-2.7-20.452-8.098\n                            c-5.381-5.405-8.074-12.238-8.074-20.497c0-5.973,1.67-11.198,5.005-15.675c3.335-4.481,8.918-8.945,16.736-13.377\n                            c-3.782-4.478-6.403-8.301-7.878-11.462c-1.467-3.164-2.204-6.39-2.204-9.678c0-6.597,2.204-11.953,6.621-16.077\n                            c4.417-4.135,10.197-6.195,17.362-6.195c7.241,0,12.967,1.902,17.157,5.699c4.199,3.791,6.296,8.95,6.296,15.447\n                            c0,4.964-1.385,9.476-4.148,13.541C498.256,884.238,493.975,888.005,488.177,891.47z M496.146,923.749l-20.488-25.101\n                            c-5.005,2.903-8.637,5.809-10.898,8.731c-2.265,2.926-3.395,6.164-3.395,9.721c0,4.656,1.494,8.475,4.478,11.463\n                            c2.989,2.986,6.848,4.481,11.592,4.481c3.384,0,6.683-0.804,9.886-2.408C490.527,929.029,493.47,926.736,496.146,923.749z\n                             M480.534,882.581c3.87-2.372,6.723-4.809,8.566-7.319c1.844-2.501,2.764-5.22,2.764-8.161c0-3.075-0.88-5.519-2.633-7.322\n                            c-1.755-1.793-4.125-2.695-7.118-2.695c-3.291,0-5.862,0.854-7.704,2.567c-1.849,1.714-2.765,4.042-2.765,6.985\n                            c0,2.281,0.666,4.644,2.005,7.08C474.992,876.153,477.288,879.109,480.534,882.581z"/>\n                    </g>\n                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M847.512,789.331c-2.453-0.247-4.932-0.68-7.282-1.405\n                        c-3.089-0.95-3.977-3.455-2.442-6.312c0.581-1.081,1.389-2.051,2.167-3.01c1.868-2.301,3.08-4.871,3.45-7.829\n                        c0.618-4.937,0.148-9.783-1.248-14.536c-2.104-7.146-2.537-14.366-1.257-21.713c4.244-24.352,27.95-41.397,52.297-37.578\n                        c24.851,3.898,41.795,25.813,39.293,50.819c-1.818,18.158-14.807,34.036-32.273,39.242c-10.099,3.011-20.497,3.871-31.021,4.237\n                        C861.965,790.618,854.731,790.055,847.512,789.331z M891.669,729.427c-0.023-3.225-2.114-5.452-4.878-5.321\n                        c-2.529,0.123-4.386,2.175-4.404,5.005c-0.033,5.825-0.009,11.65-0.009,18.033c-2.742-2.657-5.107-4.986-7.514-7.269\n                        c-2.413-2.288-5.22-2.416-7.195-0.39c-1.981,2.035-1.779,4.809,0.569,7.188c4.741,4.803,9.487,9.601,14.259,14.369\n                        c3.143,3.139,5.49,3.101,8.572-0.144c4.7-4.951,9.399-9.903,14.021-14.928c1.76-1.913,1.771-4.17,0.335-6.074\n                        c-1.264-1.676-3.67-2.4-5.519-1.436c-0.99,0.517-1.834,1.375-2.63,2.191c-1.72,1.764-3.364,3.6-5.042,5.405\n                        c-0.185-0.06-0.369-0.119-0.557-0.18C891.678,740.395,891.705,734.911,891.669,729.427z"/>\n                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M766.341,867.598c-22.604,3.208-49.405-2.221-62.396-12.645\n                        c1.058-0.108,1.926-0.221,2.798-0.284c18.194-1.316,31.799-9.829,40.496-25.936c4.403-8.155,7.064-16.924,8.071-26.1\n                        c0.833-7.603,1.581-15.161,4.448-22.354c6.238-15.649,19.772-25.348,36.579-23.165c10.56,1.371,18.463,7.979,20.56,18.397\n                        c0.647,3.222,0.792,6.544,1.185,9.959c3.326,0.272,6.612,0.539,10.29,0.837c-0.592,0.512-0.838,0.748-1.108,0.955\n                        c-5.374,4.101-8.685,8.854-9.513,16.19c-2.904,25.753-14.197,46.524-38.134,58.827 M803.558,786.809\n                        c3.398,0.116,6.273-2.629,6.279-5.999c0.007-3.24-2.726-6.021-5.974-6.079c-3.238-0.057-6.035,2.654-6.1,5.909\n                        C797.699,784.001,800.231,786.696,803.558,786.809z"/>\n                </g>\n                <g>\n                    <path fill="#FFFFFF" d="M490.413,957.762h2.495v40.48h-2.495V957.762z"/>\n                    <path fill="#FFFFFF" d="M499.71,969.101h2.155v5.953h0.112c0.227-0.906,0.625-1.766,1.191-2.58\n                        c0.567-0.812,1.256-1.521,2.069-2.125c0.812-0.604,1.72-1.077,2.722-1.417c1.001-0.341,2.05-0.511,3.146-0.511\n                        c1.398,0,2.609,0.179,3.629,0.539c1.02,0.357,1.89,0.831,2.608,1.416c0.717,0.587,1.284,1.249,1.701,1.986\n                        c0.416,0.735,0.699,1.481,0.851,2.236h0.113c0.87-2.04,2.032-3.58,3.488-4.618c1.454-1.039,3.373-1.56,5.753-1.56\n                        c1.323,0,2.542,0.198,3.657,0.595c1.114,0.397,2.078,1.003,2.892,1.814c0.812,0.814,1.445,1.843,1.898,3.09\n                        c0.454,1.247,0.681,2.721,0.681,4.422v19.9h-2.155v-19.957c0-1.852-0.283-3.307-0.85-4.365c-0.568-1.058-1.238-1.862-2.013-2.409\n                        c-0.775-0.548-1.551-0.89-2.324-1.022c-0.775-0.13-1.371-0.196-1.786-0.196c-1.323,0-2.542,0.227-3.656,0.681\n                        c-1.116,0.452-2.079,1.133-2.892,2.04c-0.813,0.907-1.446,2.031-1.899,3.374c-0.454,1.341-0.68,2.884-0.68,4.619v17.236h-2.154\n                        v-19.957c0-1.813-0.274-3.259-0.822-4.336c-0.549-1.079-1.19-1.88-1.928-2.41c-0.737-0.529-1.493-0.869-2.267-1.021\n                        c-0.776-0.15-1.389-0.227-1.843-0.227c-1.02,0-2.079,0.208-3.174,0.622c-1.097,0.416-2.098,1.06-3.004,1.93\n                        c-0.908,0.868-1.645,1.983-2.212,3.345c-0.567,1.359-0.849,2.965-0.849,4.817v17.236h-2.155V969.101z"/>\n                    <path fill="#FFFFFF" d="M564.113,992.458H564c-0.34,0.87-0.833,1.693-1.475,2.466c-0.643,0.776-1.427,1.467-2.353,2.071\n                        c-0.927,0.604-1.975,1.076-3.146,1.416c-1.172,0.341-2.458,0.51-3.855,0.51c-3.1,0-5.499-0.672-7.2-2.013\n                        c-1.701-1.34-2.552-3.41-2.552-6.208c0-1.701,0.342-3.088,1.021-4.166c0.68-1.078,1.54-1.929,2.579-2.552\n                        c1.04-0.623,2.192-1.066,3.458-1.332c1.267-0.265,2.485-0.452,3.657-0.566l3.344-0.284c1.55-0.114,2.769-0.292,3.658-0.539\n                        c0.887-0.244,1.559-0.584,2.012-1.02c0.454-0.434,0.737-0.992,0.851-1.672c0.113-0.682,0.169-1.531,0.169-2.552\n                        c0-0.795-0.151-1.53-0.453-2.211c-0.304-0.68-0.775-1.285-1.418-1.815c-0.642-0.529-1.474-0.943-2.493-1.246\n                        c-1.021-0.304-2.269-0.453-3.743-0.453c-2.607,0-4.715,0.644-6.321,1.928c-1.608,1.285-2.486,3.229-2.637,5.84h-2.153\n                        c0.15-3.213,1.18-5.623,3.088-7.229c1.909-1.605,4.621-2.409,8.137-2.409c3.515,0,6.075,0.689,7.682,2.067\n                        c1.606,1.382,2.41,3.186,2.41,5.417v16.95c0,0.416,0.009,0.831,0.027,1.246c0.019,0.419,0.086,0.795,0.199,1.136\n                        c0.112,0.34,0.301,0.614,0.567,0.821c0.265,0.208,0.642,0.312,1.133,0.312c0.378,0,0.908-0.058,1.588-0.17v1.814\n                        c-0.567,0.152-1.153,0.228-1.757,0.228c-0.87,0-1.559-0.114-2.069-0.342s-0.898-0.53-1.163-0.905\n                        c-0.264-0.38-0.444-0.823-0.539-1.334c-0.095-0.51-0.142-1.065-0.142-1.674V992.458z M564.113,981.686\n                        c-0.529,0.644-1.333,1.079-2.409,1.305c-1.077,0.228-2.277,0.396-3.6,0.511l-3.628,0.34c-1.059,0.113-2.117,0.273-3.175,0.482\n                        c-1.059,0.208-2.013,0.558-2.863,1.048c-0.85,0.493-1.541,1.163-2.069,2.014c-0.529,0.851-0.793,1.956-0.793,3.315\n                        c0,2.155,0.68,3.753,2.042,4.79c1.359,1.042,3.231,1.561,5.612,1.561c2.456,0,4.402-0.444,5.838-1.332\n                        c1.438-0.888,2.533-1.907,3.289-3.062c0.757-1.152,1.237-2.268,1.446-3.346c0.208-1.075,0.312-1.802,0.312-2.181V981.686z"/>\n                    <path fill="#FFFFFF" d="M597.165,969.101v27.61c0,1.625-0.188,3.202-0.565,4.733c-0.378,1.53-1.027,2.882-1.951,4.055\n                        c-0.925,1.169-2.197,2.105-3.818,2.804c-1.621,0.7-3.677,1.051-6.165,1.051c-1.546,0-2.998-0.163-4.354-0.483\n                        c-1.357-0.32-2.545-0.832-3.564-1.531c-1.018-0.697-1.838-1.623-2.459-2.776c-0.622-1.153-0.971-2.58-1.046-4.28h2.154\n                        c0.113,1.284,0.434,2.383,0.965,3.288c0.528,0.906,1.217,1.653,2.068,2.238c0.851,0.587,1.805,1.013,2.863,1.277\n                        s2.191,0.396,3.401,0.396c2.003,0,3.675-0.301,5.018-0.906c1.34-0.605,2.409-1.39,3.202-2.352\n                        c0.794-0.966,1.352-2.062,1.673-3.289c0.32-1.229,0.481-2.467,0.481-3.713v-6.691h-0.165c-1.02,2.156-2.404,3.799-4.159,4.933\n                        c-1.753,1.134-3.874,1.702-6.362,1.702c-2.15,0-4.008-0.371-5.573-1.106c-1.564-0.738-2.867-1.759-3.903-3.061\n                        c-1.038-1.306-1.811-2.825-2.32-4.563s-0.763-3.63-0.763-5.67c0-1.929,0.273-3.762,0.821-5.501\n                        c0.547-1.736,1.351-3.259,2.409-4.563c1.058-1.304,2.372-2.342,3.94-3.118c1.569-0.772,3.374-1.161,5.414-1.161\n                        c2.305,0,4.431,0.585,6.378,1.756c1.947,1.174,3.336,2.836,4.167,4.99h0.114v-6.066H597.165z M584.409,970.292\n                        c-1.776,0-3.316,0.359-4.62,1.076c-1.304,0.72-2.381,1.664-3.232,2.834c-0.85,1.173-1.493,2.505-1.926,3.999\n                        c-0.436,1.491-0.653,3.014-0.653,4.563c0,1.699,0.217,3.315,0.653,4.848c0.433,1.531,1.095,2.862,1.983,3.996\n                        s1.984,2.032,3.29,2.691c1.303,0.664,2.806,0.992,4.506,0.992c1.776,0,3.325-0.338,4.649-1.02\n                        c1.322-0.682,2.428-1.606,3.317-2.777c0.887-1.172,1.548-2.506,1.984-3.997c0.434-1.492,0.652-3.072,0.652-4.733\n                        c0-1.625-0.218-3.194-0.652-4.705c-0.436-1.513-1.097-2.845-1.984-3.998c-0.889-1.151-1.995-2.07-3.317-2.75\n                        C587.734,970.633,586.186,970.292,584.409,970.292z"/>\n                    <path fill="#FFFFFF" d="M604.364,983.954v0.34c0,1.7,0.227,3.328,0.682,4.876c0.455,1.551,1.126,2.91,2.018,4.081\n                        c0.891,1.174,2.008,2.099,3.354,2.778c1.345,0.682,2.908,1.021,4.689,1.021c2.918,0,5.23-0.765,6.935-2.297\n                        c1.705-1.53,2.882-3.656,3.526-6.378h2.153c-0.643,3.402-2.031,6.01-4.166,7.824c-2.136,1.814-4.961,2.721-8.476,2.721\n                        c-2.155,0-4.036-0.389-5.642-1.162c-1.605-0.773-2.947-1.832-4.024-3.176c-1.077-1.34-1.88-2.929-2.409-4.76\n                        c-0.53-1.833-0.793-3.807-0.793-5.925c0-2.042,0.274-3.999,0.822-5.868c0.548-1.872,1.369-3.515,2.466-4.933\n                        c1.095-1.417,2.466-2.551,4.11-3.401c1.645-0.851,3.581-1.275,5.811-1.275c2.041,0,3.847,0.378,5.415,1.134\n                        c1.568,0.755,2.881,1.786,3.939,3.091c1.058,1.304,1.861,2.814,2.41,4.535c0.548,1.72,0.821,3.562,0.821,5.525\n                        c0,0.191-0.009,0.407-0.026,0.653c-0.022,0.246-0.029,0.445-0.029,0.595H604.364z M625.793,982.084\n                        c-0.075-1.589-0.339-3.091-0.794-4.508c-0.456-1.418-1.128-2.665-2.019-3.74c-0.89-1.079-1.971-1.937-3.239-2.58\n                        c-1.271-0.644-2.72-0.964-4.349-0.964c-1.744,0-3.279,0.329-4.604,0.991c-1.328,0.661-2.446,1.531-3.354,2.608\n                        c-0.91,1.077-1.611,2.334-2.104,3.77c-0.493,1.438-0.795,2.912-0.909,4.423H625.793z"/>\n                    <path fill="#FFFFFF" d="M650.909,957.762v17.575h0.114c0.376-1.096,0.916-2.07,1.614-2.92c0.7-0.851,1.513-1.578,2.438-2.182\n                        c0.925-0.605,1.938-1.059,3.032-1.361c1.098-0.303,2.212-0.453,3.345-0.453c1.703,0,3.147,0.209,4.338,0.623\n                        c1.191,0.416,2.164,0.964,2.921,1.645c0.755,0.68,1.35,1.446,1.786,2.296c0.433,0.852,0.745,1.711,0.935,2.579\n                        c0.187,0.87,0.301,1.712,0.34,2.523c0.038,0.813,0.057,1.521,0.057,2.125v18.03h-2.153v-18.427c0-0.717-0.059-1.624-0.173-2.72\n                        c-0.11-1.097-0.442-2.146-0.989-3.146c-0.549-1.002-1.381-1.861-2.497-2.581c-1.114-0.717-2.654-1.076-4.618-1.076\n                        c-1.663,0-3.139,0.303-4.423,0.905c-1.286,0.606-2.38,1.448-3.289,2.524c-0.905,1.077-1.597,2.362-2.069,3.854\n                        c-0.472,1.494-0.708,3.128-0.708,4.905v15.761h-2.154v-40.48H650.909z"/>\n                    <path fill="#FFFFFF" d="M678.973,983.954v0.34c0,1.7,0.228,3.328,0.683,4.876c0.453,1.551,1.125,2.91,2.018,4.081\n                        c0.89,1.174,2.007,2.099,3.353,2.778c1.346,0.682,2.908,1.021,4.689,1.021c2.918,0,5.23-0.765,6.936-2.297\n                        c1.706-1.53,2.88-3.656,3.525-6.378h2.153c-0.644,3.402-2.031,6.01-4.166,7.824c-2.136,1.814-4.961,2.721-8.477,2.721\n                        c-2.153,0-4.035-0.389-5.641-1.162c-1.606-0.773-2.947-1.832-4.024-3.176c-1.078-1.34-1.881-2.929-2.41-4.76\n                        c-0.528-1.833-0.793-3.807-0.793-5.925c0-2.042,0.273-3.999,0.822-5.868c0.547-1.872,1.368-3.515,2.466-4.933\n                        c1.096-1.417,2.466-2.551,4.109-3.401c1.645-0.851,3.581-1.275,5.812-1.275c2.04,0,3.847,0.378,5.414,1.134\n                        c1.568,0.755,2.882,1.786,3.939,3.091c1.06,1.304,1.861,2.814,2.412,4.535c0.545,1.72,0.82,3.562,0.82,5.525\n                        c0,0.191-0.011,0.407-0.027,0.653c-0.021,0.246-0.029,0.445-0.029,0.595H678.973z M700.402,982.084\n                        c-0.076-1.589-0.34-3.091-0.796-4.508c-0.456-1.418-1.129-2.665-2.017-3.74c-0.892-1.079-1.972-1.937-3.241-2.58\n                        c-1.271-0.644-2.721-0.964-4.349-0.964c-1.744,0-3.278,0.329-4.604,0.991c-1.327,0.661-2.446,1.531-3.355,2.608\n                        s-1.608,2.334-2.103,3.77c-0.493,1.438-0.797,2.912-0.909,4.423H700.402z"/>\n                    <path fill="#FFFFFF" d="M709.756,975.563h0.169c0.265-0.943,0.748-1.833,1.447-2.664c0.7-0.83,1.548-1.549,2.551-2.154\n                        c1.002-0.604,2.115-1.067,3.344-1.389c1.23-0.322,2.506-0.463,3.828-0.425v2.153c-1.133-0.149-2.429-0.037-3.883,0.34\n                        c-1.455,0.379-2.845,1.211-4.168,2.495c-0.528,0.567-0.991,1.114-1.389,1.644c-0.396,0.529-0.728,1.116-0.991,1.758\n                        c-0.265,0.643-0.475,1.36-0.625,2.154c-0.151,0.794-0.245,1.739-0.283,2.835v15.932h-2.154v-29.142h2.154V975.563z"/>\n                    <path fill="#FFFFFF" d="M723.477,983.954v0.34c0,1.7,0.227,3.328,0.683,4.876c0.454,1.551,1.126,2.91,2.018,4.081\n                        c0.89,1.174,2.008,2.099,3.354,2.778c1.344,0.682,2.908,1.021,4.689,1.021c2.918,0,5.23-0.765,6.935-2.297\n                        c1.705-1.53,2.88-3.656,3.526-6.378h2.153c-0.644,3.402-2.032,6.01-4.166,7.824c-2.136,1.814-4.962,2.721-8.478,2.721\n                        c-2.153,0-4.034-0.389-5.64-1.162c-1.606-0.773-2.948-1.832-4.025-3.176c-1.077-1.34-1.881-2.929-2.409-4.76\n                        c-0.53-1.833-0.794-3.807-0.794-5.925c0-2.042,0.273-3.999,0.823-5.868c0.547-1.872,1.368-3.515,2.465-4.933\n                        c1.095-1.417,2.467-2.551,4.11-3.401s3.58-1.275,5.812-1.275c2.04,0,3.847,0.378,5.414,1.134\n                        c1.568,0.755,2.882,1.786,3.939,3.091c1.059,1.304,1.86,2.814,2.409,4.535c0.547,1.72,0.822,3.562,0.822,5.525\n                        c0,0.191-0.01,0.407-0.028,0.653c-0.02,0.246-0.027,0.445-0.027,0.595H723.477z M744.905,982.084\n                        c-0.074-1.589-0.341-3.091-0.794-4.508c-0.456-1.418-1.127-2.665-2.019-3.74c-0.892-1.079-1.97-1.937-3.241-2.58\n                        c-1.27-0.644-2.719-0.964-4.348-0.964c-1.743,0-3.277,0.329-4.604,0.991c-1.326,0.661-2.444,1.531-3.353,2.608\n                        c-0.912,1.077-1.61,2.334-2.104,3.77c-0.494,1.438-0.798,2.912-0.91,4.423H744.905z"/>\n                </g>\n            </g>\n        </g>\n    </svg>\n</g>\n';
},useData:!0})},{"hbsfy/runtime":375}],150:[function(t,e,n){var i=t("../../../customize/contents/background/backgrounds");e.exports=i.extend({callbackName:"callbackAdminBackgrounds"})},{"../../../customize/contents/background/backgrounds":223}],151:[function(t,e,n){var i=t("./backgrounds"),a=t("../../../components/accordion-list/categories-director"),o=t("../../../components/mixins/create");e.exports=Backbone.mixin(a.extend({"class":"sub-category backgrounds",CategoriesView:i,views:{},addNewEvent:function(t,e){this.modalData=new INKIVE.ModalAdminBackground({data:e}),this.modal=INKIVE.Modal.modalWindow(this.modalData.getFormHtml(),{width:850,headerIcon:"icon-news",headerTitle:"modal.title.new_background",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.create_background"),onClick:_.bind(this.createTemplate,this)}]})},loadButtons:function(){var t=$.Deferred();return INKIVE.Tool.preloadBackgroundCategories(function(){var e=INKIVE.Tool._cache.backgroundCategories;t.resolve(_.map(e,function(t){return{key:t.id,tag:t.name,icon:"fa fa-ellipsis-v"}}))}),t.promise()},initialize:function(){this.createButtonMargin=31,this.modalData=new INKIVE.ModalAdminBackground,this.mode="template",this.addButtonText="tool.admin.new_background",this.createCallback=$.noop,a.prototype.initialize.call(this),this.render()},_render:function(){a.prototype._render.apply(this,arguments),this.$el.find(".wrapper").css("top",this.createButtonMargin+"px")},toggleAcordionElement:function(t,e){var n=t.closest("dt"),i=n.closest(".wrapper"),o=this.createButtonMargin-n.position().top;a.prototype.toggleAcordionElement.apply(this,arguments),i.css("top",e?o+"px":this.createButtonMargin+"px")}}),o)},{"../../../components/accordion-list/categories-director":168,"../../../components/mixins/create":176,"./backgrounds":150}],152:[function(t,e,n){var i=t("../sticker/stickersall");e.exports=i.extend({where:{isText:!0},idPrefix:"banner"})},{"../sticker/stickersall":160}],153:[function(t,e,n){var i=t("../../../components/accordion-list/categories-director"),a=t("./stickers"),o=t("../../../components/mixins/create");e.exports=Backbone.mixin(i.extend({CategoriesView:a,views:{},initialize:function(){this.createButtonMargin=31,this.tool=INKIVE.Tool.getInstance(),this.modalData=new INKIVE.ModalAdminSticker({isText:!0}),this.mode="banner",this.addButtonText="tool.admin.new_banner",this.createCallback=$.noop,i.prototype.initialize.call(this),this.render()},_render:function(){i.prototype._render.apply(this,arguments),this.$el.find(".wrapper").css("top",this.createButtonMargin+"px")},addNewEvent:function(t,e){this.modalData=new INKIVE.ModalAdminSticker({isText:!0,data:e}),this.modal=INKIVE.Modal.modalWindow(this.modalData.getFormHtml(),{width:600,headerIcon:"icon-news",headerTitle:"modal.title.new_banner",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.create_banner"),onClick:_.bind(this.createTemplate,this)}]})},toggleAcordionElement:function(t,e){var n=t.closest("dt"),a=n.closest(".wrapper"),o=this.createButtonMargin-n.position().top;i.prototype.toggleAcordionElement.apply(this,arguments),a.css("top",e?o+"px":this.createButtonMargin+"px")},extractData:function(t){return[]}}),o)},{"../../../components/accordion-list/categories-director":168,"../../../components/mixins/create":176,"./stickers":152}],154:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a,o,r){var s,l,c,u="            ";return l=null!=(l=n.data||(null!=e?e.data:e))?l:n.helperMissing,c={name:"data",hash:{},fn:t.program(2,a,0,o,r),inverse:t.noop,data:a},s="function"==typeof l?l.call(null!=e?e:{},c):l,n.data||(s=n.blockHelperMissing.call(e,s,c)),null!=s&&(u+=s),u+"\n"},2:function(t,e,n,i,a,o,r){var s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression;return'<option value="'+h((s=null!=(s=n.id||(null!=e?e.id:e))?s:c,typeof s===u?s.call(l,{name:"id",hash:{},data:a}):s))+'">'+h(t.lambda(null!=r[1]?r[1].name:r[1],e))+": "+h((s=null!=(s=n.name||(null!=e?e.name:e))?s:c,typeof s===u?s.call(l,{name:"name",hash:{},data:a}):s))+"</option>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a,o,r){var s,l,c,u=null!=e?e:{},h=n.helperMissing,d="function",p=n.blockHelperMissing,f='<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <div class="load-process">\n      <div class="select-wrapper">\n        <select class="from-format">\n          <option value="" disabled selected>From format...</option>\n';return l=null!=(l=n.groups||(null!=e?e.groups:e))?l:h,c={name:"groups",hash:{},fn:t.program(1,a,0,o,r),inverse:t.noop,data:a},s=typeof l===d?l.call(u,c):l,n.groups||(s=p.call(e,s,c)),null!=s&&(f+=s),f+='        </select>\n      </div>\n\n      <div class="select-wrapper">\n        <select class="to-format">\n          <option value="" disabled selected>To format...</option>\n',l=null!=(l=n.groups||(null!=e?e.groups:e))?l:h,c={name:"groups",hash:{},fn:t.program(1,a,0,o,r),inverse:t.noop,data:a},s=typeof l===d?l.call(u,c):l,n.groups||(s=p.call(e,s,c)),null!=s&&(f+=s),f+'        </select>\n      </div>\n      <button class="load btn btn-yellow">Load</button>\n    </div>\n\n    <button class="generate btn btn-yellow hidden">Generate missing</button>\n    <div class="progress hidden"><p class="message"></p></div>\n\n    <ul class="thumbnail-wrapper"></ul>\n  </div>\n</div>\n'},useData:!0,useDepths:!0})},{"hbsfy/runtime":375}],155:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return"ok"},3:function(t,e,n,i,a){var o;return t.escapeExpression((o=null!=(o=n.url||(null!=e?e.url:e))?o:n.helperMissing,"function"==typeof o?o.call(null!=e?e:{},{name:"url",hash:{},data:a}):o))},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d=n.blockHelperMissing,p='<div class="container" style="height: '+h((r=null!=(r=n.thumb_height||(null!=e?e.thumb_height:e))?r:c,typeof r===u?r.call(l,{name:"thumb_height",hash:{},data:a}):r))+'px">\n  <div class="wrapper from-format" style="transform: skewX(-'+h((r=null!=(r=n.angle||(null!=e?e.angle:e))?r:c,typeof r===u?r.call(l,{name:"angle",hash:{},data:a}):r))+'deg);">\n    <img src="'+h((r=null!=(r=n.url||(null!=e?e.url:e))?r:c,typeof r===u?r.call(l,{name:"url",hash:{},data:a}):r))+'" style="transform: skewX('+h((r=null!=(r=n.angle||(null!=e?e.angle:e))?r:c,typeof r===u?r.call(l,{name:"angle",hash:{},data:a}):r))+'deg);">\n  </div>\n\n  <div class="wrapper to-format ';return r=null!=(r=n.has_perfect_match||(null!=e?e.has_perfect_match:e))?r:c,s={name:"has_perfect_match",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.has_perfect_match||(o=d.call(e,o,s)),null!=o&&(p+=o),p+='" style="transform: skewX(-'+h((r=null!=(r=n.angle||(null!=e?e.angle:e))?r:c,typeof r===u?r.call(l,{name:"angle",hash:{},data:a}):r))+'deg);" >\n    <img src="',r=null!=(r=n.match||(null!=e?e.match:e))?r:c,s={name:"match",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.match||(o=d.call(e,o,s)),null!=o&&(p+=o),p+'" style="transform: skewX('+h((r=null!=(r=n.angle||(null!=e?e.angle:e))?r:c,typeof r===u?r.call(l,{name:"angle",hash:{},data:a}):r))+'deg);">\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],156:[function(t,e,n){var i=t("./template.hbs"),a=t("./thumbnail.hbs"),o=t("../../../components/mixins/scrollable"),r=t("../../../../../factory/formats"),s=t("../../../../../facade/design/design"),l=t("../../../../../../../bower_components/resemblejs/resemble.js"),c=t("../../../../editor-mode-manager");e.exports=Backbone.mixin(Backbone.View.extend({mismatchPerfect:20,mismatchSame:50,events:{"click button.load":"loadEvent","click button.generate":"generateEvent","click li.thumbnail":"migrateEvent"},loadEvent:function(){var t=this.$el.find("select.from-format").val(),e=this.$el.find("select.to-format").val();this.$el.find(".load-process").addClass("hidden"),this.$el.find(".progress").removeClass("hidden"),INKIVE.Modal.loader(this.$el.find(".progress")),$.when(this.loadAllTemplatesByFormat(t,1),this.loadAllTemplatesByFormat(e,0)).then(this.preloadThumbnails).then(this.compare).then(this.renderThumbnails).then(_.bind(function(){INKIVE.Modal.loaderClose(this.$el.find(".progress")),this.$el.find("button.generate").removeClass("hidden"),this.$el.find(".progress").addClass("hidden")},this)),$.when(r.getFormat(t),r.getFormat(e)).then(_.bind(function(t,e){this.fromFormat=t,this.toFormat=e},this))},generateEvent:function(){function t(){if(INKIVE.Modal.togglePageLoader(!1),e.length){try{this.generateMatch(e.pop()).then(t)}catch(i){t()}INKIVE.Modal.togglePageLoader(!0,"Generating matching template "+(n-e.length)+" of "+n)}}var t=_.bind(t,this),e=_.filter(this.templates,function(t){return!t.match}),n=e.length;t()},migrateEvent:function(t){var e=$(t.currentTarget),n=_.findWhere(this.templates,{id:e.data("templateid")});if(n.match||this.generateMatch(n),n.match)var i=INKIVE.Modal.modalWindow("Edit copy or create a new one?",{headerIcon:"icon-info",headerTitle:"Migrate template",buttons:[{title:"Edit current",onClick:_.bind(function(){this.editMatch(n.match),i.close()},this)},{title:"Create new",onClick:_.bind(function(){this.generateMatch(n),i.close()},this)}]})},editMatch:function(t){INKIVE.Helpers.api("search/layout","GET",{id:t.id},_.bind(function(t){c.setMode("template",t)},this))},generateMatch:function(t){function e(){var e=$.Deferred();return INKIVE.Helpers.api("search/layout","GET",{id:t.id},function(t){e.resolve(t)}),e.promise()}function n(t){var e=$.Deferred(),n=INKIVE.Helpers.convertUnitsToPixels,i={name:t.name,orientation:t.orientation,text:t.text,isBackground:t.background?1:0,set:t.set,num:t.num,active:0,format_id:this.toFormat.id,format_width:n(this.toFormat.width,this.toFormat.unit),format_height:n(this.toFormat.height,this.toFormat.unit),tag:t.tag};return INKIVE.Helpers.api("management/layoutinfo","POST",{info:i},function(t){t&&"success"==t.status?e.resolve(_.extend(i,{id:t.id})):e.reject()}),e.promise()}function i(e){var n=$.Deferred();return c.setMode("template",e),s.once("template.update.designed",function(){n.resolve(e)}),s.set("template",{keep_stage_size:!0,designed:{id:t.id}}),n.promise()}function a(e){var n=$.Deferred();return this.tool.save(null,function(){n.resolve(t,e.id)}),n.promise()}return e.call(this).then(_.bind(n,this)).then(_.bind(i,this)).then(_.bind(a,this)).then(this.updateThumbnail)},updateThumbnail:function(t,e){var n=$.Deferred(),i=this.mismatchPerfect,a=_.find(this.$el.find("ul.thumbnail-wrapper li.thumbnail"),function(e){return $(e).data("templateid")==t.id});return INKIVE.Helpers.api("search/layout","GET",{id:e},function(e){$(a).find(".to-format img").attr("src",e.url),t.match=e,l(t.url).compareTo(e.url.replace(/\/\/static\./,"//oregon.")).onComplete(function(t){var e=parseFloat(t.misMatchPercentage)<i;$(a).find(".to-format").toggleClass("ok",e),n.resolve()})}),n.promise()},loadAllTemplatesByFormat:function(t,e){function n(){var s={from:i,limit:a,where:{format:t,active:e}};i+=a,this.$el.find(".progress p").text("Loading format "+t+", page "+Math.round(i/a)),INKIVE.Helpers.api("search/layouts","GET",s,_.bind(function(t){t&&t.data&&t.data.length?(o=_.union(o,t.data),n.call(this)):r.resolve(o)},this))}var i=0,a=10,o=[],r=$.Deferred();return n.call(this),r.promise()},preloadThumbnails:function(t,e){function n(){var s=o.length>3?3:o.length,l=_.after(s,_.bind(n,this)),c=Math.round((r-o.length)/r*100);for(this.$el.find(".progress p").text("Loading thumbnails "+c+"%"),o.length||i.resolve(t,e,a);s-- >0&&o.length;){var u=o.pop();if(u.url){var h=new Image;h.setAttribute("crossOrigin","anonymous"),h.src=u.url,h.onerror=l,h.onload=function(){_.defer(l);var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(this,0,0),this.rawData=t.toDataURL("image/png")},a[u.id]=h}else l()}}var i=$.Deferred(),a={},o=_.union(t,e),r=o.length;return n.call(this),i.promise()},compare:function(t,e,n){function i(t){return n[t.id]}function a(){function p(){var n=[],i=[];_.each(_.sortBy(u,"misMatch"),function(a){var o=!_.contains(n,a.toId)&&!_.contains(i,a.fromId);if(o){var r=_.find(t,{id:a.fromId});r.match=_.find(e,{id:a.toId}),r.hasPerfectMatch=a.misMatch<d,n.push(a.toId),i.push(a.fromId)}}),s.resolve()}if(!o.length)return this.templates=_.filter(t,i),void p();var f=o.pop().id,m=_.after(r.length,_.bind(a,this)),g=Math.round((c-o.length)/c*100);this.$el.find(".progress p").text("Matching templates "+g+"%"),r.length||a.call(this),_.each(r,function(t){var e=t.id,i=n[f].rawData,a=n[e].rawData;return i&&a?void l(i).compareTo(a).onComplete(function(t){var n=parseFloat(t.misMatchPercentage);h>n&&u.push({fromId:f,toId:e,misMatch:n}),_.defer(m)}):void _.defer(m)})}var o=_.filter(t,i),r=_.filter(e,i),s=$.Deferred(),a=_.bind(a,this),c=o.length,u=[],h=this.mismatchSame,d=this.mismatchPerfect;return a(),s.promise()},renderThumbnails:function(){_.each(this.templates,function(t){t.url&&this.$el.find("ul.thumbnail-wrapper").append($('<li class="thumbnail"></li>').html(this.getThumbnailHTML(t)).data("templateid",t.id))},this),this.initScroll()},getThumbnailHTML:function(t){function e(t){return{url:t.url,has_perfect_match:t.hasPerfectMatch,thumb_height:275*(t.format_height/t.format_width)}}var n=(Math.PI/2-Math.atan(this.fromFormat.height/this.fromFormat.width))/(Math.PI/180),i=_.extend(e(t),{angle:n});return t.match&&(i.match=e(t.match)),a(i)},initialize:function(){_.bindAll(this,"render","compare","updateThumbnail","renderThumbnails","preloadThumbnails","loadAllTemplatesByFormat"),r.getGroups().then(this.render),this.tool=INKIVE.Tool.getInstance()},render:function(t){this.$el.html(i({groups:t}))}}),o)},{"../../../../../../../bower_components/resemblejs/resemble.js":1,"../../../../../facade/design/design":19,"../../../../../factory/formats":65,"../../../../editor-mode-manager":102,"../../../components/mixins/scrollable":178,"./template.hbs":154,"./thumbnail.hbs":155}],157:[function(t,e,n){var i=t("../sticker/stickersall");e.exports=i.extend({where:{isPlaceholder:!0},idPrefix:"placeholder"})},{"../sticker/stickersall":160}],158:[function(t,e,n){var i=t("../../../components/accordion-list/categories-director"),a=t("./stickers"),o=t("../../../components/mixins/create");e.exports=Backbone.mixin(i.extend({"class":"sub-category stickers",CategoriesView:a,views:{},initialize:function(){this.createButtonMargin=31,this.tool=INKIVE.Tool.getInstance(),this.modalData=new INKIVE.ModalAdminSticker({isPlaceholder:!0}),this.mode="sticker",this.addButtonText="tool.admin.new_placeholder",this.createCallback=$.noop,i.prototype.initialize.call(this),this.render()},_render:function(){i.prototype._render.apply(this,arguments),this.$el.find(".wrapper").css("top",this.createButtonMargin+"px")},addNewEvent:function(t,e){this.modalData=new INKIVE.ModalAdminSticker({isPlaceholder:!0,data:e}),this.modal=INKIVE.Modal.modalWindow(this.modalData.getFormHtml(),{width:600,headerIcon:"icon-news",headerTitle:"modal.title.new_placeholder",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.create_placeholder"),onClick:_.bind(this.createTemplate,this)}]})},toggleAcordionElement:function(t,e){var n=t.closest("dt"),a=n.closest(".wrapper"),o=this.createButtonMargin-n.position().top;i.prototype.toggleAcordionElement.apply(this,arguments),a.css("top",e?o+"px":this.createButtonMargin+"px")},extractData:function(t){return[]}}),o)},{"../../../components/accordion-list/categories-director":168,"../../../components/mixins/create":176,"./stickers":157}],159:[function(t,e,n){var i=t("../../../customize/contents/sticker/stickers");e.exports=i.extend({callbackName:"callbackAdminStickers",getParams:function(){var t={from:this.from,limit:this.limit,where:{category:this.category.name,active:INKIVE.C.USER.IS_SUPER?0:1}};return this.from+=this.limit,t}})},{"../../../customize/contents/sticker/stickers":232}],160:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../../../analytics/decorate");e.exports=a(t("../../../customize/analytics/stickers"),i.extend({apiCall:"search/stickers",dataName:"stickerCategories",callbackName:"callbackAdminStickers",where:{},idPrefix:"",initialize:function(t){this.category={id:0,name:"All"},i.prototype.initialize.call(this,t)},getScrollHeight:function(t){return t.closest(".tool-content").height()},getParams:function(){var t={from:this.from,limit:this.limit,where:$.extend(this.where,{active:INKIVE.C.USER.IS_SUPER?0:1})};return this.from+=this.limit,t},extractData:function(t){var e=this;return _.map(t,function(t){var n=e.idPrefix?e.idPrefix+"-":"";return n+="sticker-"+t.id,{id:n,src:t.url,width:t.width,height:t.height,cls:parseInt(t.active)?"":"grayscale",isNocover:!0,data:{name:t.name,count:t.count,changeable:t.changeable,width:t.width,height:t.height}}})}}))},{"../../../../../analytics/decorate":4,"../../../components/accordion-list/content":170,"../../../customize/analytics/stickers":220}],161:[function(t,e,n){var i=t("./stickers"),a=t("../../../customize/contents/sticker/view"),o=t("../../../components/mixins/create");e.exports=Backbone.mixin(a.extend({CategoriesView:i,views:{},initialize:function(){this.createButtonMargin=31,this.tool=INKIVE.Tool.getInstance(),this.modalData=new INKIVE.ModalAdminSticker,this.mode="sticker",this.addButtonText="tool.admin.new_sticker",this.createCallback=$.noop,a.prototype.initialize.call(this),this.render()},_render:function(){a.prototype._render.apply(this,arguments),this.$el.find(".wrapper").css("top",this.createButtonMargin+"px")},addNewEvent:function(t,e){this.modalData=new INKIVE.ModalAdminSticker({data:e}),this.modal=INKIVE.Modal.modalWindow(this.modalData.getFormHtml(),{width:600,headerIcon:"icon-news",headerTitle:"modal.title.new_sticker",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.create_sticker"),onClick:_.bind(this.createTemplate,this)}]})},toggleAcordionElement:function(t,e){var n=t.closest("dt"),i=n.closest(".wrapper"),o=this.createButtonMargin-n.position().top;a.prototype.toggleAcordionElement.apply(this,arguments),i.css("top",e?o+"px":this.createButtonMargin+"px")},extractData:function(t){return[]}}),o)},{"../../../components/mixins/create":176,"../../../customize/contents/sticker/view":233,"./stickers":159}],162:[function(t,e,n){var i=t("../../../templates/sub-categories");e.exports=i.extend({TemplatesView:t("./templates")})},{"../../../templates/sub-categories":298,"./templates":163}],163:[function(t,e,n){var i=t("../../../templates/templates-base"),a=t("../../../components/accordion-list/content");e.exports=i.extend({callbackName:"callbackAdminLayouts",appendThumbnails:a.prototype.appendThumbnails,render:function(){i.prototype.render.apply(this,arguments),this.$el.find("ul.thumbnail-wrapper").toggleClass("thumbnail-wrapper thumbnailWrapper").css("padding-left","5px")},extractData:function(t){var e=270;return _.compact(_.map(t,function(t){var n=parseInt(t.format_width),i=parseInt(t.format_height),a=i/n*e;return t.id?{id:"layout-"+t.id,src:t.url,width:e,height:a,isNocover:INKIVE.C.USER.IS_SUPER,cls:parseInt(t.active)?"":"grayscale",data:{count:t.count,set:t.set,num:t.num,orientation:t.orientation,text:t.text,active:t.active}}:void 0}))}})},{"../../../components/accordion-list/content":170,"../../../templates/templates-base":299}],164:[function(t,e,n){var i=t("./sub-categories"),a=t("../../../templates/view-base"),o=t("../../../components/mixins/create");e.exports=Backbone.mixin(a.extend({CategoriesView:i,views:{},addNewEvent:function(t,e){this.modalData=new INKIVE.ModalAdminLayout({data:e}),this.modal=INKIVE.Modal.modalWindow(this.modalData.getFormHtml(),{width:500,headerIcon:"icon-news",headerTitle:"modal.title.new_template",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.create_template"),onClick:_.bind(this.createTemplate,this)}]})},listContentToggleEvent:function(t){a.prototype.listContentToggleEvent.apply(this,arguments),t.stopPropagation()},initialize:function(){this.createButtonMargin=31,this.modalData=new INKIVE.ModalAdminLayout,this.mode="template",this.addButtonText="tool.admin.new_template",this.createCallback=$.noop,a.prototype.initialize.call(this),this.render(),this.$el.find(".wrapper").css("top",this.createButtonMargin+"px")},toggleAcordionElement:function(t,e){var n=t.closest("dt"),i=n.closest(".wrapper"),o=this.createButtonMargin-n.position().top;a.prototype.toggleAcordionElement.apply(this,arguments),i.css("top",e?o+"px":this.createButtonMargin+"px")},extractData:function(t){return[]}}),o)},{"../../../components/mixins/create":176,"../../../templates/view-base":301,"./sub-categories":162}],165:[function(t,e,n){var i=t("../components/accordion-list/director");e.exports=i.extend({"class":"admin",views:{},Views:{templates:t("./contents/template/view"),backgrounds:t("./contents/background/view"),stickers:t("./contents/sticker/view"),banners:t("./contents/banners/view"),placeholders:t("./contents/placeholders/view"),migrate:t("./contents/migrate/view")},buttons:[{key:"templates",tag:"tool.admin.templates",icon:"icon-news"},{key:"backgrounds",tag:"tool.admin.backgrounds",icon:"icon-backgrounds"},{key:"stickers",tag:"tool.admin.stickers",icon:"icon-hipster"},{key:"banners",tag:"tool.admin.banners",icon:"icon-font_download"},{key:"placeholders",tag:"tool.admin.placeholders",icon:"icon-image"},{key:"migrate",tag:"tool.admin.migrate",icon:"icon-forward"}],render:function(){var t=this.template({"class":this["class"],buttons:this.buttons});this.$el.html(t)}})},{"../components/accordion-list/director":172,"./contents/background/view":151,"./contents/banners/view":153,"./contents/migrate/view":156,"./contents/placeholders/view":158,"./contents/sticker/view":161,"./contents/template/view":164}],166:[function(t,e,n){e.exports={initializeUploadCheckOnce:function(){return window.Android},initializeUpload:function(){function t(){this.showListContent(o),o.parent().addClass("active")}var e=this.loadListContent(this.uploadViewKey),n="ik.editor.photoupload",i=this.$el.find('dt a[data-key="add"]'),a=_.debounce(_.bind(t,this),600),o=this.$el.find('dt a[data-key="'+this.uploadViewKey+'"]');this.appBridge.on(n,function(t,n){var i=n.photoId;a(),e.views[i]=e.getNewThumbnail(),e.views[i].toggleProgressBar(!0),e.views[i].updateProgressBar(1),e.complete(i,n)}),i.on("click",_.bind(function(t){var e="o";this.appBridge.callAndroid("photo_upload",{size_name:e})},this))}}},{}],167:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'      <div class="tool-static-block" style="z-index: 3; position: relative; margin: 0 10px; background: #2B3031;">\n        <a class="btn btn-black btn-new-item">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},e,{name:"t",hash:{},data:a}))+"</a>\n      </div>\n"},3:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d=n.blockHelperMissing,p='        <dt>\n          <a class="btn btn-accordion" data-key="'+h((r=null!=(r=n.key||(null!=e?e.key:e))?r:c,typeof r===u?r.call(l,{name:"key",hash:{},data:a}):r))+'" data-type="'+h((r=null!=(r=n.type||(null!=e?e.type:e))?r:c,typeof r===u?r.call(l,{name:"type",hash:{},data:a}):r))+'">\n            ';return r=null!=(r=n.icon||(null!=e?e.icon:e))?r:c,s={name:"icon",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.icon||(o=d.call(e,o,s)),null!=o&&(p+=o),p+="\n            ",r=null!=(r=n.image||(null!=e?e.image:e))?r:c,s={name:"image",hash:{},fn:t.program(6,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.image||(o=d.call(e,o,s)),null!=o&&(p+=o),p+'\n            <i class="collapse fa fa-chevron-up hidden"></i>\n            <i class="back fa fa-chevron-left hidden"></i>\n            <span class="name">'+h((n.t||e&&e.t||c).call(l,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</span>\n          </a>\n        </dt>\n"},4:function(t,e,n,i,a){return'<i class="'+t.escapeExpression(t.lambda(e,e))+' main"></i>'},6:function(t,e,n,i,a){var o=t.escapeExpression;return'<img class="'+o(t.lambda(e,e))+' main" src="'+o((n.route||e&&e.route||n.helperMissing).call(null!=e?e:{},e,{name:"route",hash:{},data:a}))+'"/>'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h='<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <div class="tab-content '+t.escapeExpression((r=null!=(r=n["class"]||(null!=e?e["class"]:e))?r:c,typeof r===u?r.call(l,{name:"class",hash:{},data:a}):r))+' accordion active">\n';return r=null!=(r=n.add_button||(null!=e?e.add_button:e))?r:c,s={name:"add_button",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.add_button||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(h+=o),h+'      <div class="wrapper">\n'+(null!=(o=n.each.call(l,null!=e?e.buttons:e,{name:"each",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"      </div>\n    </div>\n  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],168:[function(t,e,n){var i=t("./director"),a=t("../mixins/scrollable");e.exports=Backbone.mixin(i.extend({views:{},template:t("./categories-director.hbs"),CategoriesView:null,loadListContent:function(t){function e(){var t=$("<div></div>").addClass("image-list");return i.length?t.insertAfter(i):n.find(".wrapper").append(t),t}var n=this.$el,i=n.find('dt a[data-key="'+t+'"]');return this.views[t]=new this.CategoriesView({el:e(),key:t}),this.views[t].on("open_new_view",_.partial(this.openSubView,i)),this.views[t]},listContentToggleEvent:function(t){i.prototype.listContentToggleEvent.apply(this,arguments),t.stopPropagation()},initialize:function(){_.bindAll(this,"_render","initScroll"),this.scrollRefresh=_.debounce(this.initScroll,2e3),i.prototype.initialize.apply(this,arguments)},toggleAcordionElement:function(t,e){this.$el.find(".antiscroll-wrap:first > .antiscroll-inner").scrollTop(0),this.toggleScroll(e),i.prototype.toggleAcordionElement.apply(this,arguments)},openSubView:function(t,e){if(t.children(".collapse").addClass("hidden"),t.children(".back").removeClass("hidden"),!INKIVE.C.IS_MOBILE){var n=this.getCategoryName(e),i=$('<span class="category">').text(": "+n);t.children(".category").remove(),t.append(i)}},closeView:function(){var t=this.$el.find(".wrapper dt.active").length;return t&&this.closeAccordion(),!t},closeSubView:function(t){var e=t.data("key"),n=this.views[e].closeView?this.views[e].closeView():!0;n&&(t.children(".category").remove(),t.children(".collapse").removeClass("hidden"),t.children(".back").addClass("hidden"))},getCategoryName:function(t){return""},refreshView:function(){this.scrollRefresh()},render:function(){INKIVE.Modal.loader(this.$el),this.loadButtons().then(this._render)},_render:function(t){INKIVE.Modal.loaderClose(this.$el),this.$el.html(this.template({"class":this["class"],buttons:t,add_button:this.addButtonText})),this.scrollRefresh(),t.length||(this.loadListContent(0),this.$el.find(".image-list").css({top:10,height:this.$el.closest('[role="tabpanel"]').height()}))},getScrollHeight:function(){return this.$el.closest(".image-list").height()},loadButtons:function(){var t=$.Deferred();return t.resolve([]),t.promise()}}),a)},{"../mixins/scrollable":178,"./categories-director.hbs":167,"./director":172}],169:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="antiscroll-wrap">\n  <div class="antiscroll-inner"></div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],170:[function(t,e,n){var i=t("../mixins/scrollable"),a=t("../../../../factory/images");e.exports=Backbone.mixin(Backbone.mixin(Backbone.View.extend({from:0,limit:10,apiCall:"",callbackName:"callbackImages",template:t("./content.hbs"),initialize:function(){_.bindAll(this,"masonryReload","render","loadData","onMoreData","closeView"),this.views={},this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas,this.imagesFactory=a,this.scrollRefresh=_.debounce(_.bind(this.initScroll,this),2e3),this.render(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),_.delay(_.bind(function(){this.initScroll(),this.initDataLoading()},this),1e3)},initDataLoading:function(){var t=this.$el.find(".thumbnailWrapper").length?this.$el.find(".thumbnailWrapper"):this.$el.find(".thumbnail-wrapper");this.end&&this.end(),this.tool.initScrollDetect(t,this.loadData)},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),INKIVE.Helpers.api(this.apiCall,"GET",this.getParams(),this.onMoreData)},onMoreData:function(t){var e=t.data.length>0;INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),e?(this.appendThumbnails(t.data),this.repeat()):this.end(),this.scrollRefresh()},appendThumbnails:function(t){var e=_.bind(this.tool[this.callbackName],this.tool);this.tool.addThumbItem(this.$el,this.extractData(t),e),this.masonryReload()},render:function(){this.$el.html(this.template()),this.$el.find(".antiscroll-inner").addThumb()},remove:function(){this.undelegateEvents(),this.$el.removeData().unbind(),Backbone.View.prototype.remove.call(this)},getParams:function(){return{}},extractData:function(t){return t},openNewView:function(t,e,n){var i=$("<div></div>").addClass("image-list out right");i.insertAfter(this.$el),this.$el.addClass("out left"),this.views[t]=new e(_.extend({el:i},n)),this.trigger("open_new_view",n),_.defer(function(){i.removeClass("out right")})},closeView:function(){return this.$el.removeClass("out left"),_.each(this.views,function(t,e){"uploadThumbnail"!==e&&(t.$el.addClass("out right"),_.delay(function(){t.remove()},1e3))}),this.views={},!0},getScrollHeight:function(t){var e=t.closest(".tool-content").height(),n=INKIVE.C.IS_MOBILE?$("#ik-menu-back").height():t.siblings(".btn.btn-accordion").height();return e-n},masonryReload:function(){var t=this.$el.find(".thumbnailWrapper");t.masonry("reloadItems"),t.masonry("layout"),this.scrollRefresh()}}),Backbone.Events),i)},{"../../../../factory/images":66,"../mixins/scrollable":178,"./content.hbs":169}],171:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'  <div class="tool-static-block" style="z-index: 3; position: relative; margin: 0 10px; background: #2B3031;">\n    <a class="btn btn-black btn-new-item">'+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},e,{name:"t",hash:{},data:a}))+"</a>\n  </div>\n"},3:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d=n.blockHelperMissing,p='    <dt>\n      <a class="btn btn-accordion" data-key="'+h((r=null!=(r=n.key||(null!=e?e.key:e))?r:c,typeof r===u?r.call(l,{name:"key",hash:{},data:a}):r))+'" data-type="'+h((r=null!=(r=n.type||(null!=e?e.type:e))?r:c,typeof r===u?r.call(l,{name:"type",hash:{},data:a}):r))+'">\n        ';return r=null!=(r=n.icon||(null!=e?e.icon:e))?r:c,s={name:"icon",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.icon||(o=d.call(e,o,s)),null!=o&&(p+=o),p+="\n        ",r=null!=(r=n.image||(null!=e?e.image:e))?r:c,s={name:"image",hash:{},fn:t.program(6,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.image||(o=d.call(e,o,s)),null!=o&&(p+=o),p+'\n        <i class="collapse fa fa-chevron-up hidden"></i>\n        <i class="back fa fa-chevron-left hidden"></i>\n        <span class="name">'+h((n.t||e&&e.t||c).call(l,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</span>\n      </a>\n    </dt>\n"},4:function(t,e,n,i,a){return'<i class="'+t.escapeExpression(t.lambda(e,e))+' main"></i>'},6:function(t,e,n,i,a){var o=t.escapeExpression;return'<img class="'+o(t.lambda(e,e))+' main" src="'+o((n.route||e&&e.route||n.helperMissing).call(null!=e?e:{},e,{name:"route",hash:{},data:a}))+'"/>'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h='<div class="tab-content '+t.escapeExpression((r=null!=(r=n["class"]||(null!=e?e["class"]:e))?r:c,
typeof r===u?r.call(l,{name:"class",hash:{},data:a}):r))+' accordion active">\n';return r=null!=(r=n.add_button||(null!=e?e.add_button:e))?r:c,s={name:"add_button",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.add_button||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(h+=o),h+'  <div class="wrapper">\n'+(null!=(o=n.each.call(l,null!=e?e.buttons:e,{name:"each",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],172:[function(t,e,n){var i=t("../../../../app/decorate");e.exports=i(t("./app/director"),Backbone.View.extend({views:{},Views:{},uploadViewKey:"",buttons:[],template:t("./director.hbs"),events:{'click dt > a:not([data-key="add"])':"listContentToggleEvent"},listContentToggleEvent:function(t){function e(){var t=this.hideListContent(i);t&&a.removeClass("active")}function n(){this.showListContent(i),a.addClass("active")}var i=$(t.currentTarget),a=i.closest("dt"),o=a.hasClass("active");if(o){var r=!i.children(".back").is(".hidden");r&&this.closeSubView(i),r||e.call(this)}else n.call(this)},initialize:function(){_.bindAll(this,"show","render","hideListContent","closeAccordion","openSubView")},render:function(){var t=this.template({"class":this["class"],buttons:this.buttons.filter(function(t){return!t.disabled})});this.$el.html(t),this.initializeUpload()},initializeUpload:function(){function t(){this.showListContent(n),n.parent().addClass("active")}var e=this.loadListContent(this.uploadViewKey),n=this.$el.find('dt a[data-key="'+this.uploadViewKey+'"]'),i=this.$el.find('dt a[data-key="add"]').parent(),a=_.debounce(_.bind(t,this),600);i.fineUploaderS3(e.getUploaderOptions(i)).on("progress",e.progressEvent).on("error",e.errorEvent).on("cancel",e.cancelEvent).on("complete",e.completeEvent).on("submitted",_.bind(function(){a(),e.submittedEvent.apply(e,arguments)},this)),this.beforeSubmitEvent&&i.on("click",this.beforeSubmitEvent)},show:function(){var t=new Date,e=this.$el.find(".tab-content."+this["class"].split(" ").join(".")).length,n=t-this.showingTime<600;e||this.render(),e&&n&&this.closeAccordion(),this.showingTime=t},closeAccordion:function(){_.each(this.views,function(t,e){var n=this.$el.find('dt a[data-key="'+e+'"]'),i=n.closest("dt");i.removeClass("active"),this.hideListContent(n,e)},this)},loadListContent:function(t){function e(){var e=$("<div></div>").addClass("image-list content "+t);return e.insertAfter(n),e}var n=this.$el.find('dt a[data-key="'+t+'"]');return this.views[t]=new this.Views[t]({el:e()}),this.views[t].on("open_new_view",_.partial(this.openSubView,n)),this.views[t]},openSubView:function(t,e){t.children(".collapse").addClass("hidden"),t.children(".back").removeClass("hidden")},closeSubView:function(t){var e=t.data("key"),n=this.views[e].closeView?this.views[e].closeView():!0;n&&(t.children(".collapse").removeClass("hidden"),t.children(".back").addClass("hidden"))},showListContent:function(t,e){e="undefined"!=typeof e?e:t.data("key"),this.toggleAcordionElement(t,!0),this.views[e]||this.loadListContent(e),this.views[e]&&this.views[e].refreshView&&this.views[e].refreshView()},hideListContent:function(t,e){if(e=e||t.data("key"),this.toggleAcordionElement(t,!1),!this.views[e].closeView)return!0;for(;!this.views[e].closeView(););return!0},toggleAcordionElement:function(t,e){var n=t.closest("dt"),i=n.closest(".wrapper");t.children("i").addClass("hidden",e),t.children(".main").toggleClass("hidden",e),t.children(".collapse").toggleClass("hidden",!e);var a=e?"-"+n.position().top+"px":0,o=e?n.closest('[role="tabpanel"]').height():"";i.css("top",a),n.height(o)}}))},{"../../../../app/decorate":7,"./app/director":166,"./director.hbs":171}],173:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return"<h3>"+t.escapeExpression((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},e,{name:"t",hash:{},data:a}))+"</h3>"},3:function(t,e,n,i,a){return'<a class="btn toggle"><i class="'+t.escapeExpression(t.lambda(e,e))+'"></i></a>'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d='<div class="helper-display">\n  <div class="helper-content">\n    <h2>'+t.escapeExpression((n.t||e&&e.t||c).call(l,null!=e?e.title:e,{name:"t",hash:{},data:a}))+"</h2>\n    ";return r=null!=(r=n.sub_title||(null!=e?e.sub_title:e))?r:c,s={name:"sub_title",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.sub_title||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n    "+(null!=(r=null!=(r=n.content||(null!=e?e.content:e))?r:c,o=typeof r===u?r.call(l,{name:"content",hash:{},data:a}):r)?o:"")+"\n  </div>\n</div>\n",r=null!=(r=n.button||(null!=e?e.button:e))?r:c,s={name:"button",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.button||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"\n"},useData:!0})},{"hbsfy/runtime":375}],174:[function(t,e,n){e.exports=Backbone.mixin(Backbone.View.extend({template:t("./template.hbs"),data:{title:"",sub_title:null,content:"",button:"fa fa-info"},events:{"click .btn.toggle":"toggleEvent"},toggleEvent:function(t){this.toggle()},toggle:function(t){this.$el.toggleClass("show",t),this.trigger("toggle",this.$el.hasClass("show"))},initialize:function(){_.bindAll(this,"toggle")},render:function(t){t=_.extend({},this.data,t),this.$el.html(this.template(t)),this.setElementStyle()},setElementStyle:function(){var t=this.$el.closest(".tool-content"),e=t.outerWidth(),n=t.outerHeight(),i=t.offset();this.$el.addClass("helper").css({top:i.top+"px",left:i.left+"px",height:n+"px",width:e+"px"}),this.$el.find(".helper-content").css({height:n+"px",width:e+"px"})}}),Backbone.Events)},{"./template.hbs":173}],175:[function(t,e,n){e.exports={initializeUploadCheckOnce:function(){return window.Android},initializeUpload:function(){var t=this.$el.find(".uploader.progress-button");t.on("click",_.bind(function(t){var e="o";this.appBridge.callAndroid("photo_upload",{size_name:e})},this))}}},{}],176:[function(t,e,n){var i=t("../../../editor-mode-manager");e.exports={events:{"click .btn-new-item":"addNewEvent"},addNewEvent:function(){},createTemplate:function(){this.$el.find(".btn-new-item").addClass("disabled"),this.modalData.saveForm(_.bind(this.onFormSaved,this))},onFormSaved:function(t,e){if(t&&e.id){this.modal.close(),i.setMode(this.mode,e);var n=this.extractData([e]),a=_.bind(this.createCallback,this.tool);this.tool.addThumbItem(this.$el,n,a,"prepend")}else this.$el.find(".btn-new-item").removeClass("disabled")},render:function(){this.$el.html(this.template({placeholder:this.filterPlaceholder,add_button:this.addButtonText})),this.$el.find(".antiscroll-inner").addThumb()}}},{"../../../editor-mode-manager":102}],177:[function(t,e,n){e.exports={outline:"2px solid #ffdd17",mouseDownEvent:function(t){},mouseMoveEvent:function(t){},mouseUpEvent:function(t){},clickEvent:function(t){},mouseDown:function(t){this.$draggableClone=this.createDraggableClone(),this.$draggable.css("outline",this.outline),this.uppdateDraggableCloneDataPosition(t),this.bindDragDrop(),this.mouseDownEvent(t)},createDraggableClone:function(){var t=this.$draggable.get(0).getBoundingClientRect();return $draggableClone=this.$draggable.clone(!0).off(),$("#draggingObject").remove(),$draggableClone.attr("id","draggingObject"),$draggableClone.attr("style",this.$draggable.attr("style")),$draggableClone.css({position:"absolute",left:t.left,top:t.top,width:t.width,height:t.height,"z-index":5e3,opacity:"0"}),$draggableClone.find(".tooltip").remove(),$draggableClone.find("svg *").each(function(){var t=$(this).attr("id");t&&$(this).attr("id","clone-"+t)}),$("body").append($draggableClone),$draggableClone},uppdateDraggableCloneDataPosition:function(t){var e=this.$draggable.get(0).getBoundingClientRect(),n=this.getCursorPosition(t);this.$draggableClone.data("offset",{x:(n.x-e.left)/e.width,y:(n.y-e.top)/e.height})},bindDragDrop:function(){$(window).unbind("mousemove touchmove",this.mouseMove),$(window).unbind("mouseup touchend touchcancel",this.mouseUp),$(window).on("mousemove touchmove",this.mouseMove),$(window).on("mouseup touchend touchcancel",this.mouseUp)},mouseMove:function(t){var e=_.partial(this.processDraggable,t);$("#draggingObject").length&&_.defer(e)},mouseUp:function(t){t.preventDefault();var e=$("#canvas-panel").offset();if(this.$draggableClone.length){var n=this.getCursorPosition(t);n.x>e.left?this.mouseUpEvent(t):this.$draggableClone.data("dragging")||this.clickEvent(t),this.endDragging()}},endDragging:function(){this.$draggable.css("outline","none"),this.$draggableClone.remove(),$(window).unbind("mousemove touchmove",this.mouseMove),$(window).unbind("mouseup touchend",this.mouseUp)},processDraggable:function(t){function e(){var e=this.getCursorPosition(t);return{x:e.x-o.width*a.x,y:e.y-o.height*a.y}}function n(){var t=110>s,e=80>c,n=e?o.left:r.x,i=t?o.top:r.y;$draggableClone.css("left",n),$draggableClone.css("top",i),$draggableClone.css("opacity",e&&t?"0":"1")}function i(){var t=130,e=300,n=2,i=1;c>t&&(i+=(c-t)/(e-t),i>n&&(i=n)),$draggableClone.css("transform","scale("+i+")")}var a=this.$draggableClone.data("offset");if(this.$draggableClone.length&&a){var o=this.$draggable.get(0).getBoundingClientRect(),r=e.call(this),s=Math.abs(r.x-o.left),l=Math.abs(r.y-o.top),c=Math.round(Math.sqrt(s*s+l*l));n(),i(),s>110&&t.preventDefault(),c>10&&this.$draggableClone.data("dragging",!0),this.mouseMoveEvent(t)}},getCursorPosition:function(t){if(0===t.type.indexOf("touch")){var e=t.originalEvent?t.originalEvent.changedTouches:t.changedTouches,n={x:e&&e[0].clientX,y:e&&e[0].clientY};return t.clientX=n.x,t.clientY=n.y,n}return{x:t.clientX,y:t.clientY}},initDraggable:function(){_.bindAll(this,"mouseMove","mouseUp","processDraggable")}}},{}],178:[function(t,e,n){e.exports={initScroll:function(t,e){t=t||this.$el;var n=t.find(".accordion dd:visible"),i=n.length;if(i)return this.initScroll(n,e);var e=$.extend({autoHide:!1,width:this.getScrollWidth(t),height:this.getScrollHeight(t)},e);t.hasClass("antiscroll-wrap")?t.antiscroll(e):t.find(".antiscroll-wrap").antiscroll(e)},getScrollWidth:function(t){return t.parents(".tool-content").width()},getScrollHeight:function(t){return t.parents(".tool-content").height()},toggleScroll:function(t){var e=this.$el.find(".antiscroll-wrap:first");e.children(".antiscroll-inner").css("overflow",t?"hidden":"auto"),e.children(".antiscroll-scrollbar").toggleClass("antiscroll-scrollbar-shown",!t)}}},{}],179:[function(t,e,n){var i=t("../thumbnail/upload"),a=t("../../../../app/decorate");e.exports=a(t("./app/upload-list"),{uploadingThumbs:{},uploadAttempt:{},files:{},uploadConfig:{validation:{acceptFiles:"image/*;capture=camera",allowedExtensions:["jpg","jpeg","gif","png"]},scaling:{includeExif:!1,sendOriginal:!1,sizes:[{name:"o",maxSize:INKIVE.C.VersionUploadSize.o}]}},initialize:function(){_.bindAll(this,"complete","submittedEvent","progressEvent","errorEvent","cancelEvent","completeEvent","getUploaderOptions"),this.debouncedMasonryReload=_.debounce(this.masonryReload,800),this.addUploadThumbnail(),this.initializeUpload()},addUploadThumbnail:function(){var t=this.$el.find(".thumbnailWrapper");this.$uploaderThumbnail=$("<div></div>").addClass("thumbnail uploader"),t.prependThumb(this.$uploaderThumbnail),this.views.uploadThumbnail=new i({el:this.$uploaderThumbnail})},getNewThumbnail:function(){var t=$("<div></div>").addClass("thumbnail uploading");return t.insertAfter(this.$uploaderThumbnail),this.debouncedMasonryReload(),new i({el:t})},initializeUpload:function(){var t=this.$el.find(".uploader.progress-button");t.fineUploaderS3(this.getUploaderOptions(t)).on("submitted",this.submittedEvent).on("progress",this.progressEvent).on("error",this.errorEvent).on("cancel",this.cancelEvent).on("complete",this.completeEvent)},getUploaderOptions:function(t){function e(e){var n=/(?:\.([^.]+))?$/,i=t.fineUploaderS3("getName",e),a=t.fineUploaderS3("getUuid",e),o=n.exec(i)[1],r=INKIVE.C.UPLOAD_SERVER.split("/").pop().split(".")[0];return r+"/original/"+a+"."+o}var n=INKIVE.C.DEFAULT_FINEUPLOADER,i=$.extend(!0,{button:t,objectProperties:{acl:"public-read",key:e}},n,this.uploadConfig);return i},submittedEvent:function(t,e,n){var i=$(t.currentTarget);this.views[e]=this.getNewThumbnail(),this.views[e].toggleProgressBar(!0),this.files[e]=i.fineUploaderS3("getFile",e),this.views[e].on("thumbnail_load_error",_.bind(function(){this.errorEvent(null,e)},this)),this.views[e].on("cancel",_.bind(function(){var t=this.uploadAttempt[e];t&&t.abort&&t.abort(),i.fineUploaderS3("cancel",e)},this)),this.isFallbackUploadForced()&&_.defer(_.bind(function(){i.fineUploaderS3("cancel",e),this.regularUploadFallback(e)},this))},progressEvent:function(t,e,n,i,a){this.views[e]&&this.views[e].updateProgressBar(i/a)},cancelEvent:function(t,e){if(!this.isFallbackUploadForced()||this.uploadAttempt[e]){var n=this.views[e];this.tool.editor.canvas.call("advice.show","upload-cancel"),this.clean(e),_.delay(_.bind(function(){n.remove(),this.debouncedMasonryReload()},this),1e3)}},errorEvent:function(t,e){var n=this.views[e],i=!this.uploadAttempt[e]||"complete"===t.type;return i?("complete"!==t.type&&this.regularUploadFallback(e),!1):(INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_default",{message:"modal.alert.upload_image",try_again:!0})),this.clean(e),_.delay(_.bind(function(){n&&n.remove(),this.debouncedMasonryReload()},this),1e3),!0)},regularUploadFallback:function(t){function e(){var e=_.bind(this.progressEvent,this),a=new FormData;a.append("userfile",i),a.append("project_id",INKIVE.C.BOOK.id),this.uploadAttempt[t]=$.ajax({url:this.regularUploadFallbackUrl,type:"POST",success:n,error:_.bind(function(e){this.errorEvent(e,t)},this),data:a,cache:!1,contentType:!1,processData:!1,dataType:"json",xhr:function(){var n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(n){e(n,t,null,n.loaded,n.total)},!1),n}})}function n(e){var n=e.key;$.ajax({url:INKIVE.C.BASE_URL+"upload/successasync",type:"POST",dataType:"json",success:o,error:_.bind(function(e){a(e,t)},this),data:{type:"editor",scrapbookId:INKIVE.C.BOOK.id,key:n,name:i.name,bucket:"virginia.inkive.com"}})}var i=this.files[t],a=this.errorEvent,o=_.partial(this.complete,t);this.$el.find(".uploader.progress-button");this.uploadAttempt[t]=!0,this.forceFallbackUpload(),this.regularUploadFallbackUrl&&e.call(this),this.regularUploadFallbackUrl||$.get(BASE_URL+"upload/getdirectuploadendpoint",_.bind(function(t){this.regularUploadFallbackUrl=t,e.call(this)},this))},completeEvent:function(t,e,n,i,a){var o=$(t.currentTarget);i.success?this.complete(e,i):this.errorEvent(t,e)&&o.fineUploaderS3("cancel",e)},complete:function(t,e){var n=e.tempLink.replace("/original/","/thumb/");this.clean(t),this.views[t].setImage("photo-saved-"+e.photoId,n),this.views[t].on("resize",this.debouncedMasonryReload)},clean:function(t){this.files=_.omit(this.files,t),this.uploadAttempt=_.omit(this.uploadAttempt,t)},forceFallbackUpload:function(){INKIVE.C.USE_FALLBACK_UPLOAD="FORCE"},isFallbackUploadForced:function(){return"FORCE"===INKIVE.C.USE_FALLBACK_UPLOAD}})},{"../../../../app/decorate":7,"../thumbnail/upload":215,"./app/upload-list":175}],180:[function(t,e,n){var i=t("./base"),a=t("../../../../../facade/design/design");e.exports=i.extend({addElement:function(t){a.create("sticker",_.extend({sticker_id:this.svg.id,thumb_src:this.svg.url},t))},initialize:function(t){this.svg=t.svg,i.prototype.initialize.call(this),this.setImageListeners()},setImageListeners:function(){this.$el.find("img")[0].onload=this.resize},getTemplateRenderData:function(){return{image:{src:this.svg.url}}}})},{"../../../../../facade/design/design":19,"./base":181}],181:[function(t,e,n){var i=t("../../mixins/draggable"),a=t("../../../../../facade/editor/editor");e.exports=Backbone.mixin(Backbone.mixin(Backbone.View.extend({template:t("../templates/base.hbs"),elementType:"",height:86,width:110,events:{"touchstart .item":"mouseDown","mousedown .item":"mouseDown"},getClickElementData:function(t){var e=this.$draggableClone?this.$draggableClone.get(0).getBoundingClientRect():this.$el.get(0).getBoundingClientRect(),n=Math.min(this.canvas.contentW,this.canvas.contentH);return n/=Math.max(e.width,e.height),{position:{x:(this.canvas.contentW-e.width*(n/2))/2,y:(this.canvas.contentH-e.height*(n/2))/2},size:{width:e.width*(n/2),height:e.height*(n/2)}}},getMouseUpElementData:function(t){var e=this.$draggableClone.get(0).getBoundingClientRect(),n=a.handle("zoom","get"),i=this.editor.getOffset();return{position:{x:Math.floor4((e.left-i.x)/n),y:Math.floor4((e.top-i.y)/n)},size:{width:Math.floor4(e.width/n),height:Math.floor4(e.height/n)}}},clickEvent:function(t){this.addElement(this.getClickElementData(t))},mouseUpEvent:function(t){this.addElement(this.getMouseUpElementData(t))},addElement:function(t){var e=this.editor.addElement(this.elementType,t);INKIVE.Tool.blinkScreen(e)},initialize:function(){_.bindAll(this,"resize"),this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,this.render(),this.initDraggable()},render:function(){var t=this.template(this.getTemplateRenderData());this.$el.html(t),this.width&&this.$el.css("width",this.width),this.height&&this.$el.css("height",this.height),this.$draggable=this.$el.find("a.item")},remove:function(){this.undelegateEvents(),this.$el.removeData().unbind(),Backbone.View.prototype.remove.call(this)},resize:function(){var t=this.$el.find("img").height();this.$el.height(t),this.trigger("resize")},getTemplateRenderData:function(){}}),Backbone.Events),i)},{"../../../../../facade/editor/editor":45,"../../mixins/draggable":177,"../templates/base.hbs":203}],182:[function(t,e,n){var i=t("./base"),a=t("../../../../../analytics/decorate");e.exports=a(t("../analytics/template"),i.extend({events:{click:"addEvent"},addEvent:function(t){var e=0===$("#svgroot .main").find(":not(title)").length,n=!this.isSameSize()&&!this.isCustomFormat&&!e;n?this.addOnNewPage():e||this.setCurrentPage?this.setTemplate():this.displayModalOptions()},initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.canvas=this.editor.canvas,_.bindAll(this,"onNewPageCreated","setTemplate","onTemplateSet","acceptModal","closeModal")},addOnNewPage:function(t){var e=parseInt(INKIVE.C.BOOK.num_pages)+1,n=INKIVE.C.BASE_URL+"inkiveeditor/addPage/"+INKIVE.C.BOOK.id+"/"+e;INKIVE.Modal.togglePageLoader(!0),$.get(n,null,this.onNewPageCreated)},onNewPageCreated:function(t){INKIVE.Modal.togglePageLoader(!1),t=$.parseJSON(t),"success"==t.status?(INKIVE.C.BOOK.num_pages++,this.tool.load(t.data.now,this.setTemplate)):INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_default",{message:"modal.alert.add",try_again:!0})),INKIVE.Modal.togglePageLoader(!1)},displayModalOptions:function(){var t=0;this.modal=INKIVE.Modal.modalWindow(INKIVE.TemplatesHelper("modal_layout_load",{new_size:t,current_size:Math.round(this.canvas.contentW)+"x"+Math.round(this.canvas.contentH),keep_images:!INKIVE.C.MODE.IS_DESYGNER,has_images:$("#svgcontent .main image").length>0,keep_size:!INKIVE.C.MODE.IS_DESYGNER,is_same_size:!0}),{width:600,headerIcon:"icon-cloud-download",headerTitle:"modal.title.change_name",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.apply_name"),onClick:this.acceptModal},{title:INKIVE.TranslateHelper.translate("common.cancel"),onClick:this.closeModal}]}),$('[data-id="'+this.modal.id+'"] [type=checkbox]').iCheck({checkboxClass:"icheckbox_square-yellow"})},acceptModal:function(){this.keepSize=$('input[name="keep-size-input"]').is(":checked"),this.keepImages=$('input[name="keep-images-input"]').is(":checked"),this.setTemplate(),this.modal.close()},closeModal:function(){this.modal.close()},setTemplate:function(){this.oldImages=_.map($("#svgcontent .main image"),function(t){return t.getAttribute("xlink:href")}),this.editor.loadingElement(1),INKIVE.DesignFacade.once(this.designAddedEvent,this.onTemplateSet)},onTemplateSet:function(){INKIVE.Tool.blinkScreen();var t=$("#svgcontent .main .layoutBox");this.keepImages&&_.any(t,function(t,e){return this.oldImages.length>e?void this.canvas.runExtensions("addLayoutImage",{elem:t,data:this.oldImages[e]}):!0},this),INKIVE.C.IS_MOBILE&&this.canvas.call("advice.show","template-back"),INKIVE.C.IS_MOBILE||t.length&&INKIVE.C.MODE.IS_DESYGNER&&this.canvas.call("advice.show","template-placeholders"),INKIVE.Helpers.displayImagesLoadingAnimation(),this.editor.loadingElement(0)}}))},{"../../../../../analytics/decorate":4,"../analytics/template":189,"./base":181}],183:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize",clickEvent:function(){this.trackEvent({eventAction:"backgrounds_set_color",eventLabel:this.color})}}},{}],184:[function(t,e,n){e.exports={}},{}],185:[function(t,e,n){arguments[4][184][0].apply(n,arguments)},{dup:184}],186:[function(t,e,n){arguments[4][184][0].apply(n,arguments)},{dup:184}],187:[function(t,e,n){arguments[4][184][0].apply(n,arguments)},{dup:184}],188:[function(t,e,n){arguments[4][184][0].apply(n,arguments)},{dup:184}],189:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | templates",addEvent:function(t){var e=0===$("#svgroot .main").find(":not(title)").length,n=!this.isSameSize()&&!e;(n||e)&&this.trackEvent({eventAction:"add_"+(this.design?"designed":"grid"),eventLabel:n?"new_page":"current_empty_page"})},acceptModal:function(t){this.trackEvent({eventAction:"add_"+(this.design?"designed":"grid"),eventLabel:"current_page"})},closeModal:{eventAction:"cancel_adding"}}},{}],190:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | text banners",clickEvent:function(t){this.trackEvent({eventAction:"add_click",eventLabel:this.svg.id})},mouseUpEvent:function(){this.trackEvent({eventAction:"add_drop",eventLabel:this.svg.id})}}},{}],191:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | text",eventAction:"text_edit",toggleBoldFontEvent:{eventLabel:"toggle_bold"},toggleItalicFontEvent:{eventLabel:"toggle_italic"},toggleOptionsEvent:{eventLabel:"toggle_options"},endEditingEvent:{eventLabel:"change_content"},toggleUnderlineFontEvent:{eventLabel:"toggle_underline"},clickEvent:{eventAction:"add_click"},mouseUpEvent:{eventAction:"add_drop"},changeFontFamilyEvent:function(t){var e=$(t.currentTarget).css("font-family");this.trackEvent({eventLabel:"change_font_family "+this.getQuoteScaped(e)})}}},{}],192:[function(t,e,n){e.exports={displayFontFamiliesEventCheckOnce:function(){return!window.Android&&this.appBridge.version.isGreaterThan("1.1.1")||window.Android&&!this.appBridge.version.isLowerThan("1.1.3")},displayFontFamiliesEvent:function(t){var e=this.$el.find(".fonts-list");this.appBridge.callBoth("pick_font",_.extend(this.getTextData("_"),{position:_.extend(e.offset(),{height:e.height(),width:e.width()})})),e.find(".ui-dropdown-items").removeAttr("style").hide(),this.appBridge.off("ik.editor.text_update"),this.appBridge.on("ik.editor.text_update",_.bind(function(t,e){this.setTextData(e)},this))}}},{}],193:[function(t,e,n){var i=t("../../../../../../bower_components/tinycolor/tinycolor"),a=t("../../../../facade/design/design"),o=t("./templates/color.hbs"),r=t("../../../../analytics/decorate");e.exports=r(t("./analytics/color"),Backbone.View.extend({events:{click:"clickEvent"},clickEvent:function(t){a.set("background",{color:this.color})},initialize:function(t){var e=i(t.color);this.editor=INKIVE.Tool.getInstance().editor,this.color=t.color,this.stroke=e.isLight()?"#555":"#AAA",this.render()},render:function(){this.$el.html(o({color:this.color,stroke:this.stroke})),this.$el.data("attr","fill fill-opacity"),this.$el.attr("title",this.color)}}))},{"../../../../../../bower_components/tinycolor/tinycolor":2,"../../../../analytics/decorate":4,"../../../../facade/design/design":19,"./analytics/color":183,"./templates/color.hbs":204}],194:[function(t,e,n){function i(t){this.$el=t,this.caption="",this.captionLength=0,_.bindAll(this,"type","erase","startTyping","startErasing");var e=this.$el.height();this.$el.empty(),this.$text=$('<span class="content avoid-shortcuts"></span>').height(e).appendTo(this.$el),this.$cursor=$('<span class="cursor">|</span>').appendTo(this.$el)}e.exports=i,i.prototype.hide=function(){this.$cursor.hide()},i.prototype.show=function(){this.$cursor.show()},i.prototype.startTyping=function(t){return this.deferred=$.Deferred(),this.show(),this.caption=t,this.captionLength=0,this.type(),this.deferred.promise()},i.prototype.startErasing=function(){return this.deferred=$.Deferred(),this.show(),this.caption=this.$text.text(),this.captionLength=this.caption.length,this.erase(),this.deferred.promise()},i.prototype.type=function(){this.$text.html(this.caption.substr(0,this.captionLength++)||"&nbsp;"),this.captionLength<=this.caption.length?_.delay(this.type,100):(this.captionLength=0,this.caption="",this.deferred.resolve())},i.prototype.erase=function(){this.$text.html(this.caption.substr(0,this.captionLength--)||"&nbsp;"),this.captionLength>=0?_.delay(this.erase,50):(this.captionLength=0,this.caption="",this.deferred.resolve())}},{}],195:[function(t,e,n){function i(){var t=document.createElement("p").style;return"transition"in t?"transitionend":"WebkitTransition"in t?"webkitTransitionEnd":"MozTransition"in t?"transitionend":"msTransition"in t?"MSTransitionEnd":"OTransition"in t?"oTransitionEnd":null}function a(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(t){this.el=t,this.paths=[].slice.call(this.el.querySelectorAll("path")),this.pathsArr=new Array,this.lengthsArr=new Array,this._init()}function r(t,e){this.el=t,this.options=a({},this.options),a(this.options,e),this._init()}e.exports=r;i();o.prototype._init=function(){var t=this;this.paths.forEach(function(e,n){t.pathsArr[n]=e,e.style.strokeDasharray=t.lengthsArr[n]=e.getTotalLength()}),this.draw(0)},o.prototype.draw=function(t){for(var e=0,n=this.pathsArr.length;n>e;++e)this.pathsArr[e].style.strokeDashoffset=this.lengthsArr[e]*(1-t)},r.prototype.options={},r.prototype._init=function(){this.progressEl=new o(this.el.querySelector("svg.progress-circle")),this.successEl=new o(this.el.querySelector("svg.checkmark")),this.errorEl=new o(this.el.querySelector("svg.cross")),$(this.el).addClass("error plus"),this.errorEl.draw(1)},r.prototype._submit=function(){$(this.el).addClass("loading").removeClass("plus")},r.prototype.stop=function(t){var e=this,n=function(){if(e.progressEl.draw(0),"number"==typeof t){var n=t>=0?"success":"error",i=t>=0?e.successEl:e.errorEl;i.draw(1),$(e.el).addClass(n),e.clear=function(){$(e.el).removeClass(n),i.draw(0)}}$(e.el).removeClass("loading error")};setTimeout(n,300)},r.prototype.clear=function(){},r.prototype.setProgress=function(t){this.progressEl.draw(t)}},{}],196:[function(t,e,n){var i=t("./abstract/template"),a=t("../../../../factory/user-info");e.exports=i.extend({height:null,template:t("./templates/template.hbs"),designAddedEvent:"template.update.designed",addEvent:function(t){var e=this.design&&"1"===this.design.is_premium&&!this.isPremium;this.design&&!e&&i.prototype.addEvent.apply(this,arguments)},initialize:function(t){i.prototype.initialize.call(this),this.width=t.width,this.format=t.format,this.design=t.design,this.isCustomFormat=t.isCustomFormat,a.get().then(_.bind(function(t){this.isPremium=_(t.roles).contains("ROLE_PREMIUM"),this.render(),this.initImageLoad()},this))},render:function(){i.prototype.render.apply(this,arguments),this.$el.toggleClass("locked",this.design&&"1"===this.design.is_premium&&!this.isPremium)},getTemplateRenderData:function(){if(this.format)return this.getFormatRenderData();var t=this.isCustomFormat?this.canvas.contentW/this.canvas.contentH:this.design.format_width/this.design.format_height,e=this.width*(1/t);return{url:this.design.url,is_premium_user:this.isPremium,is_premium_template:"1"===this.design.is_premium,thumb_height:Math.floor(e)}},getFormatRenderData:function(){var t=56,e=this.format.thumb_width/this.format.thumb_height,n=this.width*(1/e);return _.extend(this.format,{is_single_line:t>n,thumb_height:Math.floor(n)})},initImageLoad:function(){function t(){var t=$(this);if(t.closest(".thumbnail.image").removeClass("loading"),e){var n=t.parent();n.height(t.height()).addClass("custom"),n.width()>t.width()&&t.width(n.width()).removeAttr("height")}else t.removeAttr("height")}var e=this.isCustomFormat;this.$el.find("img").each(function(){this.onload=t,this.src=$(this).data("src")})},setTemplate:function(){i.prototype.setTemplate.apply(this,arguments),INKIVE.DesignFacade.set("template",{keep_stage_size:this.isCustomFormat,designed:{id:this.design.id}})},isSameSize:function(){return this.canvas.contentW==this.design.format_width&&this.canvas.contentH==this.design.format_height}})},{"../../../../factory/user-info":81,"./abstract/template":182,"./templates/template.hbs":211}],197:[function(t,e,n){var i=t("./abstract/template"),a=0;e.exports=i.extend({width:null,height:null,setCurrentPage:!1,template:t("./templates/grid.hbs"),designAddedEvent:"template.update.grid",initialize:function(t){i.prototype.initialize.call(this),this.setCurrentPage=t.setCurrentPage,this.size=t.size,this.format=t.format,this.numberOfPhotos=t.numberOfPhotos,this.processSVGData(t.data),this.render()},getTemplateRenderData:function(){return{defs:this.defs,content:this.svg,width:this.size.width,height:this.size.height}},processSVGData:function(t){function e(t,e){INKIVE.SVGPlaceholderImage.setClipsData(e);var n=/<image xmlns:xlink="[^"]*" id="([^"]*)" clip-path="url\(#([^"]*)\)" [^>]*">[^<]*<\/image>/g;return t.replace(n,function(t,e,n){var i=INKIVE.SVGPlaceholderImage.render(e,n);return i?i.svgString:t})}function n(t){return t.replace(/id="(.*?)"/g,'id="$1-thumb-'+a+'"')}function i(t){return t.replace(/clip-path="url\(#(.*?)\)"/g,'clip-path="url(#$1-thumb-'+a+')"')}a++,this.defs=n(t.defs),this.svg=e(t.svg,t.defs),this.svg=n(this.svg),this.svg=i(this.svg),this.name=t.name},setTemplate:function(){i.prototype.setTemplate.apply(this,arguments),INKIVE.DesignFacade.set("template",{size:this.format,setCurrentPage:this.setCurrentPage,grid:{index_in_set:this.name,number_of_photos:this.numberOfPhotos}})},isSameSize:function(){return this.canvas.contentW==this.format.width&&this.canvas.contentH==this.format.height}})},{"./abstract/template":182,"./templates/grid.hbs":205}],198:[function(t,e,n){var i=t("../abstract/base"),a=t("../../../../../facade/design/design"),o=t("../../../../../analytics/decorate");e.exports=o(t("../analytics/library-background"),i.extend({template:t("../templates/library-background.hbs"),events:{click:"addEvent"},addEvent:function(t){a.set("background",{source:this.item.data.thumb})},initialize:function(t){this.item=t.item,i.prototype.initialize.call(this),this.setImageListeners()},render:function(){this.$el.html(this.template(this.item))},setImageListeners:function(){var t=new Image,e=this.$el,n=this.item.data.thumb;t.src=n,t.onload=function(){e.find(".loading").addClass("disappear"),e.find(".image").css("background-image",'url("'+n+'")')}}}))},{"../../../../../analytics/decorate":4,"../../../../../facade/design/design":19,"../abstract/base":181,"../analytics/library-background":184,"../templates/library-background.hbs":206}],199:[function(t,e,n){var i=t("../abstract/base"),a=t("../../../../../facade/design/design"),o=t("../../../../../facade/editor/editor"),r=t("../../../../../analytics/decorate");e.exports=r(t("../analytics/library-color"),i.extend({template:t("../templates/library-color.hbs"),events:{mouseover:"overThumbnailEvent",'click ul.options li[data-type="font"]':"setFontColorEvent",'click ul.options li[data-type="fill"]':"setFillColorEvent",'click ul.options li[data-type="stroke"]':"setStrokeColorEvent",'click ul.options li[data-type="background"]':"setBackgroundColorEvent"},setBackgroundColorEvent:function(t){var e=$(t.currentTarget).closest(".color").find(".info .code").text();a.set("background",{color:e})},setFontColorEvent:function(t){
function e(t){_.each(t,function(t){a.set(t.id,{color:r})})}function n(t){_.each(t,function(t){var e={};_.each(a.get(t.id,"texts"),function(t,n){e[n]={color:r}}),a.set(t.id,{texts:e})})}var i=this.getSelectionFacadeElements(),o=this.getElementsWithText(i),r=$(t.currentTarget).closest(".color").find(".info .code").text();e(_.filter(o,this.isText)),n(_.filter(o,this.isSticker))},setFillColorEvent:function(t){function e(t){_.each(t,function(t){a.set(t.id,{fill:{color:r}})})}function n(t){_.each(t,function(t){var e={};_.each(a.get(t.id,"shapes"),function(t,n){t.fill&&t.fill.color&&(e[n]={fill:{color:r}})}),a.set(t.id,{shapes:e})})}var i=this.getSelectionFacadeElements(),o=this.getElementsWithFill(i),r=$(t.currentTarget).closest(".color").find(".info .code").text();e(_.filter(o,this.isShape)),n(_.filter(o,this.isSticker))},setStrokeColorEvent:function(t){function e(t){_.each(t,function(t){a.set(t.id,{stroke:{color:r}})})}function n(t){_.each(t,function(t){var e={};_.each(a.get(t.id,"shapes"),function(t,n){t.stroke&&t.stroke.color&&0!==t.stroke.width&&(e[n]={stroke:{color:r}})}),a.set(t.id,{shapes:e})})}var i=this.getSelectionFacadeElements(),o=this.getElementsWithStroke(i),r=$(t.currentTarget).closest(".color").find(".info .code").text();e(_.filter(o,this.isShape)),n(_.filter(o,this.isSticker))},overThumbnailEvent:function(t){var e=this.$el.find("ul.options li"),n=this.getSelectionFacadeElements();e.filter('[data-type="font"]').toggleClass("disabled",!this.getElementsWithText(n).length),e.filter('[data-type="fill"]').toggleClass("disabled",!this.getElementsWithFill(n).length),e.filter('[data-type="stroke"]').toggleClass("disabled",!this.getElementsWithStroke(n).length)},getSelectionFacadeElements:function(){var t=_.compact(_.toArray(this.canvas.getSelectedElems()));return _.map(t,function(t){return{type:o.getType(t),id:t.getAttribute("id")}})},getElementsWithText:function(t){var e=_.filter(t,this.isSticker);return _.union(_.filter(t,this.isText),_.filter(e,function(t){return!_.isEmpty(a.get(t.id,"texts"))}))},getElementsWithStroke:function(t){var e=_.filter(t,this.isShape),n=_.filter(t,this.isSticker);return _.union(_.filter(e,function(t){var e=a.get(t.id,"stroke");return e&&e.color&&0!==e.width}),_.filter(n,function(t){return _.any(a.get(t.id,"shapes"),function(t){return t.stroke&&t.stroke.color&&0!==t.stroke.width})}))},getElementsWithFill:function(t){var e=_.filter(t,this.isShape),n=_.filter(t,this.isSticker);return _.union(_.filter(e,function(t){return a.get(t.id,"fill.color")}),_.filter(n,function(t){return _.any(a.get(t.id,"shapes"),function(t){return t.fill&&t.fill.color})}))},isText:function(t){return"text"===t.type},isShape:function(t){return"shape"===t.type},isSticker:function(t){return"sticker"===t.type},initialize:function(t){this.item=t.item,i.prototype.initialize.call(this)},render:function(){this.$el.html(this.template(this.item))}}))},{"../../../../../analytics/decorate":4,"../../../../../facade/design/design":19,"../../../../../facade/editor/editor":45,"../abstract/base":181,"../analytics/library-color":185,"../templates/library-color.hbs":207}],200:[function(t,e,n){var i=t("../abstract/base"),a=t("../../../../../facade/design/design"),o=t("../../../../../analytics/decorate");e.exports=o(t("../analytics/library-image"),i.extend({template:t("../templates/library-image.hbs"),addElement:function(t){a.create("image",_.extend({source:{url:this.item.data.thumb}},t))},getMouseUpElementData:function(t){return _.extend({placeholder:!1},i.prototype.getMouseUpElementData.call(this,t))},initialize:function(t){var e=INKIVE.Tool.getInstance();this.item=t.item,this.editor=e.editor,this.canvas=this.editor.canvas,i.prototype.initialize.call(this),this.setImageListeners()},render:function(){this.$el.html(this.template(this.item)),this.$draggable=this.$el.find(".draggable")},mouseMove:function(t){i.prototype.mouseMove.apply(this,arguments);var e=this.editor.getOffset(),n=t.clientX,a=t.clientY,o=this.canvas.runExtensions("overLayoutImage",{elem:this.$draggableClone.get(0),mouse_x:n-e.x,mouse_y:a-e.y}),r=o&&!$(o).hasClass("locked-image");this.layoutTarget=r&&o},mouseUp:function(t){t.preventDefault(),this.layoutTarget&&this.dropOverLayoutbox(),this.layoutTarget||i.prototype.mouseUp.apply(this,arguments)},dropOverLayoutbox:function(){var t=this.canvas._t.layout_prvAttr;t&&(t["xlink:href"]=t.url,this.canvas.undoMgr.addCommandToHistory(new svgedit.history.ChangeElementCommand(this.layoutTarget,{"#layout-delete":t}))),this.endDragging(),this.canvas.runExtensions("addLayoutImage",{elem:this.layoutTarget,data:{version:this.item.data}}),this.canvas._t.layout_prvElem&&(this.canvas._t.layout_prvElem=null,this.canvas._t.layout_prvAttr=null)},setImageListeners:function(){var t=new Image,e=this.$el;t.src=this.item.data.thumb,t.onload=_.bind(function(){var n=t.width/t.height;e.find(".loading").addClass("disappear"),e.height(e.width()/n),this.trigger("resize")},this)}}))},{"../../../../../analytics/decorate":4,"../../../../../facade/design/design":19,"../abstract/base":181,"../analytics/library-image":186,"../templates/library-image.hbs":208}],201:[function(t,e,n){var i=t("../abstract/base"),a=t("../../../../../facade/design/design"),o=t("../../../../../analytics/decorate");e.exports=o(t("../analytics/library-logo"),i.extend({template:t("../templates/library-logo.hbs"),addElement:function(t){var e=1==this.item.data.type;e&&this.addImageLogoElement(t),e||this.addSVGLogoElement(t)},addImageLogoElement:function(t){a.once("image.create",this.setPostCreateAttributes),a.create("image",_.extend({placeholder:!1,source:{url:this.item.data.thumb}},t))},addSVGLogoElement:function(t){var e=this.item.data.content;3==this.item.data.type&&(e=e.replace(/<g class="background"(.*?)<\/g>/,"")),a.once("sticker.create",this.setPostCreateAttributes),a.create("sticker",_.extend({content:Base64.encode(e)},t))},setPostCreateAttributes:function(t){$("#"+t.id).addClass("logo")},initialize:function(t){this.item=t.item,i.prototype.initialize.call(this),this.setImageListeners()},render:function(){this.$el.html(this.template(this.item)),this.$draggable=this.$el.find(".draggable")},setImageListeners:function(){var t=new Image,e=this.$el,n=this.item.data.thumb;t.src=n,t.onload=function(){e.find(".loading").addClass("disappear"),e.find(".image").css("background-image",'url("'+n+'")')}}}))},{"../../../../../analytics/decorate":4,"../../../../../facade/design/design":19,"../abstract/base":181,"../analytics/library-logo":187,"../templates/library-logo.hbs":209}],202:[function(t,e,n){var i=t("../abstract/base"),a=t("../../../../../facade/design/design"),o=t("../../../../../analytics/decorate");e.exports=o(t("../analytics/library-text"),i.extend({template:t("../templates/library-text.hbs"),addElement:function(t){var e=this.item.data;a.once("text.create",function(t){a.set(t.id,{color:e.color_code,spacing:{letter:e.letter_spacing,word:e.word_spacing,line:e.line_spacing}})}),a.create("text",_.extend({content:e.default_content||e.name||e.family,decoration:e.underline?"underline":null,font:{family:e.family,size:e.size,weight:e.bold?"bold":null,style:e.italic?"italic":null}},t))},initialize:function(t){this.item=t.item,i.prototype.initialize.call(this)},render:function(){this.$el.html(this.template(this.item)),this.$draggable=this.$el.find(".draggable")}}))},{"../../../../../analytics/decorate":4,"../../../../../facade/design/design":19,"../abstract/base":181,"../analytics/library-text":188,"../templates/library-text.hbs":210}],203:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'<div class="uploader progress-button">\n  <svg class="progress-circle" width="70" height="70">\n    <path d="m35,2.5c17.955803,0 32.5,14.544199 32.5,32.5c0,17.955803 -14.544197,32.5 -32.5,32.5c-17.955803,0 -32.5,-14.544197 -32.5,-32.5c0,-17.955801 14.544197,-32.5 32.5,-32.5z"/>\n  </svg>\n\n  <svg class="checkmark" width="70" height="70">\n    <path d="m31.5,46.5l15.3,-23.2"/>\n    <path d="m31.5,46.5l-8.5,-7.1"/>\n  </svg>\n\n  <svg class="cross" width="70" height="70">\n    <path d="m35,35l-9.3,-9.3"/>\n    <path d="m35,35l9.3,9.3"/>\n    <path d="m35,35l-9.3,9.3"/>\n    <path d="m35,35l9.3,-9.3"/>\n  </svg>\n</div>\n'},3:function(t,e,n,i,a){return" hidden"},5:function(t,e,n,i,a){return'style="opacity: 0"'},7:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<img id="'+c((o=null!=(o=n.id||(null!=e?e.id:e))?o:s,typeof o===l?o.call(r,{name:"id",hash:{},data:a}):o))+'" src="'+c((o=null!=(o=n.src||(null!=e?e.src:e))?o:s,typeof o===l?o.call(r,{name:"src",hash:{},data:a}):o))+'">'},9:function(t,e,n,i,a){var o=t.escapeExpression;return'  <div class="thumb_sticker" data-popover="tooltip" data-original-title="'+o((n.t||e&&e.t||n.helperMissing).call(null!=e?e:{},"tool.images.times_used",e,{name:"t",hash:{},data:a}))+'">'+o(t.lambda(e,e))+"</div>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="";return r=null!=(r=n.upload||(null!=e?e.upload:e))?r:c,s={name:"upload",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.upload||(o=h.call(e,o,s)),null!=o&&(d+=o),d+='\n<a class="item',r=null!=(r=n.image||(null!=e?e.image:e))?r:c,s={name:"image",hash:{},fn:t.noop,inverse:t.program(3,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.image||(o=h.call(e,o,s)),null!=o&&(d+=o),d+='"',r=null!=(r=n.no_opacity||(null!=e?e.no_opacity:e))?r:c,s={name:"no_opacity",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.no_opacity||(o=h.call(e,o,s)),null!=o&&(d+=o),d+=">\n  ",r=null!=(r=n.image||(null!=e?e.image:e))?r:c,s={name:"image",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.image||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n</a>\n\n",r=null!=(r=n.times_used||(null!=e?e.times_used:e))?r:c,s={name:"times_used",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.times_used||(o=h.call(e,o,s)),null!=o&&(d+=o),d},useData:!0})},{"hbsfy/runtime":375}],204:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n  <rect x="0" y="0" width="32" height="32" fill-opacity="1" stroke="'+c((o=null!=(o=n.stroke||(null!=e?e.stroke:e))?o:s,typeof o===l?o.call(r,{name:"stroke",hash:{},data:a}):o))+'" stroke-width="1px" fill="'+c((o=null!=(o=n.color||(null!=e?e.color:e))?o:s,typeof o===l?o.call(r,{name:"color",hash:{},data:a}):o))+'"></rect>\n</svg>\n'},useData:!0})},{"hbsfy/runtime":375}],205:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing,c="function",u=t.escapeExpression;return'<a class="item">\n  <svg width="'+u((r=null!=(r=n.width||(null!=e?e.width:e))?r:l,typeof r===c?r.call(s,{name:"width",hash:{},data:a}):r))+'" height="'+u((r=null!=(r=n.height||(null!=e?e.height:e))?r:l,typeof r===c?r.call(s,{name:"height",hash:{},data:a}):r))+'">\n    <rect width="'+u((r=null!=(r=n.width||(null!=e?e.width:e))?r:l,typeof r===c?r.call(s,{name:"width",hash:{},data:a}):r))+'" height="'+u((r=null!=(r=n.height||(null!=e?e.height:e))?r:l,typeof r===c?r.call(s,{name:"height",hash:{},data:a}):r))+'" fill="#313d43" />\n    <defs>'+(null!=(r=null!=(r=n.defs||(null!=e?e.defs:e))?r:l,o=typeof r===c?r.call(s,{name:"defs",hash:{},data:a}):r)?o:"")+"</defs>\n    "+(null!=(r=null!=(r=n.content||(null!=e?e.content:e))?r:l,o=typeof r===c?r.call(s,{name:"content",hash:{},data:a}):r)?o:"")+"\n  </svg>\n</a>\n"},useData:!0})},{"hbsfy/runtime":375}],206:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o;return"<span>"+t.escapeExpression(t.lambda(null!=(o=null!=e?e.data:e)?o.name:o,e))+"</span>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=t.escapeExpression;return'<div class="image">\n  <div class="loading" style="background-image: url(\''+s((n.route||e&&e.route||n.helperMissing).call(r,"assets/img/editor/loading-128.gif",{name:"route",hash:{},data:a}))+'\')"></div>\n  <img class="draggable" src="'+s(t.lambda(null!=(o=null!=e?e.data:e)?o.thumbnail:o,e))+'" />\n  <div class="overlay">'+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.name:o,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],207:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return" dark"},3:function(t,e,n,i,a){return'<span class="name">'+t.escapeExpression(t.lambda(e,e))+"</span><br>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=t.lambda,l=t.escapeExpression,c=n.helperMissing;return'<div class="color'+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.is_dark:o,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+'" style="background-color: '+l(s(null!=(o=null!=e?e.data:e)?o.color_code:o,e))+'">\n  <div class="info">\n    '+(null!=(o=n.blockHelperMissing.call(e,s(null!=(o=null!=e?e.data:e)?o.name:o,e),{name:"data.name",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+'\n    <span class="code">'+l(s(null!=(o=null!=e?e.data:e)?o.color_code:o,e))+'</span>\n  </div>\n\n  <div class="overlay">\n    <ul class="options">\n      <li data-type="fill" data-popover="tooltip" data-original-title="'+l((n.t||e&&e.t||c).call(r,"tool.library.tooltip.fill",{name:"t",hash:{},data:a}))+'"><i class="fa fa-circle"></i></li>\n      <li data-type="stroke" data-popover="tooltip" data-original-title="'+l((n.t||e&&e.t||c).call(r,"tool.library.tooltip.stroke",{name:"t",hash:{},data:a}))+'"><i class="fa fa-circle-o"></i></li>\n      <li data-type="font" data-popover="tooltip" data-original-title="'+l((n.t||e&&e.t||c).call(r,"tool.library.tooltip.font",{name:"t",hash:{},data:a}))+'"><i class="fa fa-font"></i></li>\n      <li data-type="background" data-popover="tooltip" data-original-title="'+l((n.t||e&&e.t||c).call(r,"tool.library.tooltip.background",{name:"t",hash:{},data:a}))+'"><i class="fa fa-th"></i></li>\n    </ul>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],208:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o;return"<span>"+t.escapeExpression(t.lambda(null!=(o=null!=e?e.data:e)?o.name:o,e))+"</span>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=t.escapeExpression;return'<div class="image item">\n  <div class="loading" style="background-image: url(\''+s((n.route||e&&e.route||n.helperMissing).call(r,"assets/img/editor/loading-128.gif",{name:"route",hash:{},data:a}))+'\')"></div>\n  <img class="draggable" src="'+s(t.lambda(null!=(o=null!=e?e.data:e)?o.thumb:o,e))+'" width="100%" />\n  <div class="overlay">'+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.name:o,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],209:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o;return"<span>"+t.escapeExpression(t.lambda(null!=(o=null!=e?e.data:e)?o.name:o,e))+"</span>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=t.escapeExpression;return'<div class="image item">\n  <div class="loading" style="background-image: url(\''+s((n.route||e&&e.route||n.helperMissing).call(r,"assets/img/editor/loading-128.gif",{name:"route",hash:{},data:a}))+'\')"></div>\n  <img class="draggable" src="'+s(t.lambda(null!=(o=null!=e?e.data:e)?o.thumb:o,e))+'" />\n  <div class="overlay">'+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.name:o,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],210:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return" dark"},3:function(t,e,n,i,a){return"font-weight: bold;"},5:function(t,e,n,i,a){return"font-style: italic;"},7:function(t,e,n,i,a){return"text-decoration: underline;"},9:function(t,e,n,i,a){return t.escapeExpression(t.lambda(e,e))},11:function(t,e,n,i,a){var o;return t.escapeExpression(t.lambda(null!=(o=null!=e?e.data:e)?o.family:o,e))},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=t.lambda,l=t.escapeExpression,c=n.blockHelperMissing;return'<div class="text item'+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.is_dark:o,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+'">\n  <span class="color">\n    <i class="fa fa-circle" style="color: '+l(s(null!=(o=null!=e?e.data:e)?o.color_code:o,e))+';"></i>\n    <span class="size">'+l(s(null!=(o=null!=e?e.data:e)?o.size:o,e))+'</span>\n  </span>\n  <span class="name" style="\n    font-family: '+l(s(null!=(o=null!=e?e.data:e)?o.family:o,e))+";\n    letter-spacing: "+l(s(null!=(o=null!=e?e.data:e)?o.letter_spacing:o,e))+"px;\n    word-spacing: "+l(s(null!=(o=null!=e?e.data:e)?o.word_spacing:o,e))+"px;\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.bold:o,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.italic:o,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.underline:o,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a}))?o:"")+'">\n    '+(null!=(o=c.call(e,s(null!=(o=null!=e?e.data:e)?o.name:o,e),{name:"data.name",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=c.call(e,s(null!=(o=null!=e?e.data:e)?o.name:o,e),{name:"data.name",hash:{},fn:t.noop,inverse:t.program(11,a,0),data:a}))?o:"")+'\n  </span>\n  <div class="draggable" style="\n    font-family: '+l(s(null!=(o=null!=e?e.data:e)?o.family:o,e))+";\n    font-size: "+l(s(null!=(o=null!=e?e.data:e)?o.size:o,e))+"px;\n    color: "+l(s(null!=(o=null!=e?e.data:e)?o.color_code:o,e))+";\n    letter-spacing: "+l(s(null!=(o=null!=e?e.data:e)?o.letter_spacing:o,e))+"px; \n    word-spacing: "+l(s(null!=(o=null!=e?e.data:e)?o.word_spacing:o,e))+"px;\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.bold:o,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.italic:o,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=n["if"].call(r,null!=(o=null!=e?e.data:e)?o.underline:o,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a}))?o:"")+'">\n    '+(null!=(o=c.call(e,s(null!=(o=null!=e?e.data:e)?o.name:o,e),{name:"data.name",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a}))?o:"")+"\n    "+(null!=(o=c.call(e,s(null!=(o=null!=e?e.data:e)?o.name:o,e),{name:"data.name",hash:{},fn:t.noop,inverse:t.program(11,a,0),data:a}))?o:"")+"\n  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],211:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'data-original-title="'+t.escapeExpression(t.lambda(e,e))+'"'},3:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d='<p class="description';return r=null!=(r=n.is_single_line||(null!=e?e.is_single_line:e))?r:c,s={name:"is_single_line",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.is_single_line||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(d+=o),d+'">\n  <label>'+h((r=null!=(r=n.name||(null!=e?e.name:e))?r:c,typeof r===u?r.call(l,{name:"name",hash:{},data:a}):r))+"</label>\n  <span>"+h((r=null!=(r=n.width||(null!=e?e.width:e))?r:c,typeof r===u?r.call(l,{name:"width",hash:{},data:a}):r))+"x"+h((r=null!=(r=n.height||(null!=e?e.height:e))?r:c,typeof r===u?r.call(l,{name:"height",hash:{},data:a}):r))+h((r=null!=(r=n.unit||(null!=e?e.unit:e))?r:c,typeof r===u?r.call(l,{name:"unit",hash:{},data:a}):r))+"</span>\n</p>\n"},4:function(t,e,n,i,a){return" no-break"},6:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d="";return r=null!=(r=n.is_premium_user||(null!=e?e.is_premium_user:e))?r:c,s={name:"is_premium_user",hash:{},fn:t.noop,inverse:t.program(7,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.is_premium_user||(o=h.call(e,o,s)),null!=o&&(d+=o),d+='\n<div class="premium">\n  ',r=null!=(r=n.is_premium_user||(null!=e?e.is_premium_user:e))?r:c,s={name:"is_premium_user",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.is_premium_user||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n  ",r=null!=(r=n.is_premium_user||(null!=e?e.is_premium_user:e))?r:c,s={name:"is_premium_user",hash:{},fn:t.noop,inverse:t.program(11,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.is_premium_user||(o=h.call(e,o,s)),null!=o&&(d+=o),d+"\n</div>\n"},7:function(t,e,n,i,a){return'  <a href="'+t.escapeExpression((n.route||e&&e.route||n.helperMissing).call(null!=e?e:{},"library?r=upgrade",{name:"route",hash:{},data:a}))+'" target="_blank" class="unlock">\n      <span><span>Unlock premium content</span></span>\n  </a>\n'},9:function(t,e,n,i,a){return'<i class="fa fa-unlock-alt" aria-hidden="true"></i>'},11:function(t,e,n,i,a){return'<i class="fa fa-lock" aria-hidden="true"></i>'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d='<img data-src="'+h((r=null!=(r=n.url||(null!=e?e.url:e))?r:c,typeof r===u?r.call(l,{name:"url",hash:{},data:a}):r))+'" data-popover="tooltip" ';return r=null!=(r=n.name||(null!=e?e.name:e))?r:c,s={name:"name",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.name||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(d+=o),d+" height="+h((r=null!=(r=n.thumb_height||(null!=e?e.thumb_height:e))?r:c,typeof r===u?r.call(l,{name:"thumb_height",hash:{},data:a}):r))+'>\n<span class="overlay"></span>\n'+(null!=(o=n["if"].call(l,null!=e?e.name:e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"\n"+(null!=(o=n["if"].call(l,null!=e?e.is_premium_template:e,{name:"if",hash:{},fn:t.program(6,a,0),inverse:t.noop,data:a}))?o:"")},useData:!0})},{"hbsfy/runtime":375}],212:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'        <a style="font-family: '+c((o=null!=(o=n.family||(null!=e?e.family:e))?o:s,typeof o===l?o.call(r,{name:"family",hash:{},data:a}):o))+';" data-fontid="'+c((o=null!=(o=n.index||a&&a.index)?o:s,typeof o===l?o.call(r,{name:"index",hash:{},data:a}):o))+'">'+c((o=null!=(o=n.family||(null!=e?e.family:e))?o:s,typeof o===l?o.call(r,{name:"family",hash:{},data:a}):o))+"</a>\n"},3:function(t,e,n,i,a){return" applied"},5:function(t,e,n,i,a){var o,r,s,l='    <li class="underline-font">\n      <a class="btn btn-onmenu';return r=null!=(r=n.text_decoration||(null!=e?e.text_decoration:e))?r:n.helperMissing,s={name:"text_decoration",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o="function"==typeof r?r.call(null!=e?e:{},s):r,n.text_decoration||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(l+=o),l+'" data-popover="tooltip" data-original-title="Underline" data-title="Underline">\n        <i class="icon-underline"></i>\n      </a>\n    </li>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=t.escapeExpression,d=n.blockHelperMissing,p='<div class="line-container">\n  <a id="'+h((r=null!=(r=n.id||(null!=e?e.id:e))?r:c,typeof r===u?r.call(l,{name:"id",hash:{},data:a}):r))+'" class="item" data-popover="tooltip" data-original-title="'+h((r=null!=(r=n.font_family||(null!=e?e.font_family:e))?r:c,typeof r===u?r.call(l,{name:"font_family",hash:{},data:a}):r))+": "+h((r=null!=(r=n.font_size||(null!=e?e.font_size:e))?r:c,typeof r===u?r.call(l,{name:"font_size",hash:{},data:a}):r))+'" style="font-size: '+h((r=null!=(r=n.font_size||(null!=e?e.font_size:e))?r:c,typeof r===u?r.call(l,{name:"font_size",hash:{},data:a}):r))+"; font-family: "+h((r=null!=(r=n.font_family||(null!=e?e.font_family:e))?r:c,typeof r===u?r.call(l,{name:"font_family",hash:{},data:a}):r))+"; font-weight: "+h((r=null!=(r=n.font_weight||(null!=e?e.font_weight:e))?r:c,typeof r===u?r.call(l,{name:"font_weight",hash:{},data:a}):r))+"; font-style: "+h((r=null!=(r=n.font_style||(null!=e?e.font_style:e))?r:c,typeof r===u?r.call(l,{name:"font_style",hash:{},data:a}):r))+"; text-decoration: "+h((r=null!=(r=n.text_decoration||(null!=e?e.text_decoration:e))?r:c,typeof r===u?r.call(l,{name:"text_decoration",hash:{},data:a}):r))+'">&nbsp;</a>\n\n  <input type="text" />\n  <a href="#" class="toggle-options"><i class="icon-sound-mix"></i></a>\n</div>\n\n<div class="menu options hidden">\n  <ul>\n    <li class="fonts-list">\n      <a class="btn btn-onmenu toggle">\n        <i class="icon-font"></i>\n        <span class="ui-dropdown-title">'+h((r=null!=(r=n.font_family||(null!=e?e.font_family:e))?r:c,typeof r===u?r.call(l,{name:"font_family",hash:{},data:a}):r))+'</span>\n        <i class="icon-unfold_more"></i>\n      </a>\n      <div class="ui-dropdown-items ui-dropdown-div hidden">\n'+(null!=(o=n.each.call(l,null!=e?e.fonts:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+'      </div>\n    </li>\n\n    <li class="bold-font">\n      <a class="btn btn-onmenu';return r=null!=(r=n.font_weight||(null!=e?e.font_weight:e))?r:c,s={name:"font_weight",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.font_weight||(o=d.call(e,o,s)),null!=o&&(p+=o),p+='" data-original-title="Bold" data-title="Bold">\n        <i class="icon-bold"></i>\n      </a>\n    </li>\n\n    <li class="italic-font">\n      <a class="btn btn-onmenu',r=null!=(r=n.font_style||(null!=e?e.font_style:e))?r:c,s={name:"font_style",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.font_style||(o=d.call(e,o,s)),null!=o&&(p+=o),p+='" data-original-title="Italic" data-title="Italic">\n        <i class="icon-italic"></i>\n      </a>\n    </li>\n\n',r=null!=(r=n.Mobile||(null!=e?e.Mobile:e))?r:c,s={name:"Mobile",hash:{},fn:t.noop,inverse:t.program(5,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.Mobile||(o=d.call(e,o,s)),null!=o&&(p+=o),p+'\n    <li>\n      <a class="btn btn-onmenu begin-edit" data-popover="tooltip" data-original-title="'+h((n.t||e&&e.t||c).call(l,"popupmenu.text_begin_edit.dropdown_title",{name:"t",hash:{},data:a}))+'" data-title="'+h((n.t||e&&e.t||c).call(l,"popupmenu.text_begin_edit.dropdown_title",{name:"t",hash:{},data:a}))+'">\n        <i class="icon-edit"></i>\n      </a>\n    </li>\n  </ul>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],213:[function(t,e,n){var i=t("./abstract/SVG"),a=t("../../../../analytics/decorate");e.exports=a(t("./analytics/text-banner"),i.extend({invertFilter:{"-webkit-filter":"grayscale(1) invert(1)",filter:"grayscale(1) invert(1)"},regularFilter:{"-webkit-filter":"grayscale(1)",filter:"grayscale(1)"},setImageListeners:function(t){var e=this.$el.find("img");e[0].crossOrigin="Anonymous",e.on("load",_.bind(this.processImage,this,e))},getTemplateRenderData:function(){return{no_opacity:!0,image:{src:this.svg.url}}},processImage:function(t){function e(){var e=$("<canvas>")[0],n=e.getContext("2d"),i=t.width(),a=t.height();return e.width=i,e.height=a,n.drawImage(t[0],0,0,i,a),n.getImageData(0,0,i,a).data}try{for(var n,i,a=127.5,o=e(),r=[],s=0,l=o.length;l>s;s+=4){var c=o[s+0],u=o[s+1],h=o[s+2];o[s+3]&&r.push((c+u+h)/3)}n=r.length,i=_.reduce(r,function(t,e){return t+e},0),r=i/n,t.css(a>r?this.invertFilter:this.regularFilter)}catch(d){t.css(this.invertFilter)}this.resize(),t.parent().css("opacity",1)}}))},{"../../../../analytics/decorate":4,"./abstract/SVG":180,"./analytics/text-banner":190}],214:[function(t,e,n){var i=t("./abstract/base"),a=t("./components/type-effect"),o=t("../../../../utils/humps"),r=t("../../../../app/decorate"),s=t("../../../../facade/design/design"),l=t("../../../../analytics/decorate"),c=t("../../../../facade/editor/editor");e.exports=l(t("./analytics/text"),r(t("./app/text"),i.extend({template:t("./templates/text.hbs"),width:null,height:null,events:_.extend({"click a.toggle-options":"toggleOptionsEvent","click  .btn.begin-edit":"startEditingEvent","blur .line-container input":"endEditingEvent","keyup .line-container input":"keyupEvent","keydown .line-container input":"keydownEvent","click .options .fonts-list":"displayFontFamiliesEvent","click .options .bold-font a":"toggleBoldFontEvent","click .options .italic-font a":"toggleItalicFontEvent","click .options .underline-font a":"toggleUnderlineFontEvent","click .options .fonts-list .ui-dropdown-items a":"changeFontFamilyEvent"},i.prototype.events),changeFontFamilyEvent:function(t){var e=this.$el.find(".line-container > .item"),n=this.$el.find(".options"),i=$(t.currentTarget).css("font-family");e.css({"font-family":i,"font-weight":"","font-style":"","text-decoration":""}),n.find(".fonts-list .ui-dropdown-title").text(this.getQuoteScaped(i)),n.find(".btn-onmenu").removeClass("applied"),this.toggleFontAvailableOptions($(t.currentTarget).data("fontid")),this.trigger("change")},getQuoteScaped:function(t){return t.replace(/^['|"](.*)['|"]$/,function(t,e){return e})},toggleBoldFontEvent:function(t){this.cssToggle(t,"font-weight","bold"),!this.currentFont.support.bi&&this.currentFont.support.i&&this.$el.find(".options .italic-font").toggleClass("disabled",$(t.currentTarget).hasClass("applied"))},toggleItalicFontEvent:function(t){this.cssToggle(t,"font-style","italic"),!this.currentFont.support.bi&&this.currentFont.support.b&&this.$el.find(".options .bold-font").toggleClass("disabled",$(t.currentTarget).hasClass("applied"))},toggleUnderlineFontEvent:function(t){this.cssToggle(t,"text-decoration","underline")},cssToggle:function(t,e,n){var i=this.$el.find(".line-container > .item"),a=$(t.currentTarget).toggleClass("applied");i.css(e,a.hasClass("applied")?n:""),this.trigger("change")},clickEvent:function(t){var e=this.isBeingEdit();e||this.addElement(this.getClickElementData(t))},mouseUpEvent:function(t){var e=this.isBeingEdit();e||this.addElement(this.getMouseUpElementData(t))},toggleOptionsEvent:function(t){var e=this.$el.height(),n=e>this.minimizedHeight,i=this.isBeingEdit();$(t.currentTarget).toggleClass("active"),n||this.startEditingEvent(),n&&this.$el.css("overflow","hidden"),n&&i&&this.blurEditableContent(),this.$el.height(n?this.minimizedHeight:this.fullHeight)},keydownEvent:function(t){13===t.which&&(t.preventDefault(),this.blurEditableContent())},keyupEvent:function(t){var e=this.$el.find(".line-container input").val()||"&nbsp;";this.$el.find(".line-container > .item .content").html(e)},blurEditableContent:function(){this.$el.find(".line-container input").blur()},startEditingEvent:function(t){var e=new Date;if(!(e-this.editEndTime<1e3)){this.preEditText=this.$el.find(".line-container > .item .content").text();var n=this.$el.find(".line-container input").val("").show();this.$el.css("overflow",""),this.$el.find(".btn.begin-edit").addClass("applied"),this.erase().then(function(){n.focus()})}},endEditingEvent:function(t){var e=this.$el.find(".line-container input");this.$el.find(".btn.begin-edit").removeClass("applied"),this.editEndTime=new Date,e.val()?(this.endTyping(),this.trigger("change")):this.type(this.preEditText).then(_.bind(function(){this.endTyping()},this))},addElement:function(t){s.create("text",t)},getClickElementData:function(t){var e=this.editor.getOffset(),n=this.getBaseElementData(e),i=(e.width-n.size.width)/2;return _.extend(n,{position:{x:Math.floor4(i),y:Math.floor4((e.height-n.font.size)/2)}})},getMouseUpElementData:function(t){var e=c.handle("zoom","get"),n=this.editor.getOffset(),i=this.$draggableClone[0].getBoundingClientRect(),a=this.getBaseElementData(n),o=t.clientX-a.size.width/2*e-n.x;
return _.extend(a,{position:{x:Math.floor4(o),y:Math.floor4((i.top-n.y)/e)}})},getBaseElementData:function(t){var e=this.editor.canvas,n=this.$el.find(".line-container > .item .content"),i=_.min([e.contentW,e.contentH]),a=n[0].getBoundingClientRect().width,o=Math.round(i*this.data.size),r=a*(o/25),s=this.getTextData();return{content:s.text,decoration:s.textDecoration,font:{family:s.fontFamily,weight:s.fontWeight,style:s.fontStyle,size:o},size:{width:Math.floor4(r)}}},initialize:function(t){_.bindAll(this,"type","erase","initAccordion","getTextData"),this.data=t.data,i.prototype.initialize.call(this)},initAccordion:function(){var t=this.$el.find(".menu.options");this.minimizedHeight=this.$el.height(),this.$el.height(this.minimizedHeight),t.removeClass("hidden"),this.fullHeight=this.minimizedHeight+t.outerHeight(),this.$draggable=this.$el.find("a.item > .content"),this.toggleFontAvailableOptions()},render:function(){i.prototype.render.call(this),this.$el.find(".fonts-list").popupmenudropdown({left:0,onShow:_.bind(function(){this.$el.css("overflow","visible").find(".line-container input").hide()},this),forceBottom:!0}),this.$el.find(".fonts-list .ui-dropdown-items").removeClass("hidden");var t=this.$el.find(".line-container > .item").height();this.$el.find(".line-container > .item").height(t)},getTemplateRenderData:function(){return _.extend(this.data,{id:this.data.uuid,font_size:this.data.font_size+"px",fonts:INKIVE.FontsFactory.get()})},type:function(t){var e=t||this.data.text;return this.typeEffect=this.typeEffect||new a(this.$el.find("a.item")),this.typeEffect.startTyping(e)},erase:function(){return this.typeEffect=this.typeEffect||new a(this.$el.find("a.item")),this.typeEffect.startErasing()},endTyping:function(){this.typeEffect.hide(),this.$el.find(".menu.options").hasClass("hidden")&&this.initAccordion()},isBeingEdit:function(){return this.$el.find(".line-container input").is(":focus")},toggleFontAvailableOptions:function(t){function e(){var t=this.$el.find(".fonts-list .ui-dropdown-title"),e=t.text();return _.find(i,{family:e})}var n=this.$el.find(".options"),i=INKIVE.FontsFactory.get();this.currentFont=t?i[t]:e.call(this),n.find(".bold-font").toggleClass("disabled",!this.currentFont.support.b),n.find(".italic-font").toggleClass("disabled",!this.currentFont.support.i)},createDraggableClone:function(){var t=i.prototype.createDraggableClone.call(this);return t.css(_.omit(this.getTextData("-"),"text")),t},setTextData:function(t){var e=this.$el.find(".line-container > .item .content"),n=this.$el.find(".options");t=o.camelizeKeys(t),t.text&&e.text(t.text),e.css("font-family",t.fontFamily),this.$el.find(".fonts-list .ui-dropdown-title").text(t.fontFamily),this.toggleFontAvailableOptions(),n.find(".bold-font a").toggleClass("applied",t.fontWeight||!1),e.css("font-weight",t.fontWeight),n.find(".italic-font a").toggleClass("applied",t.fontStyle||!1),e.css("font-style",t.fontStyle),n.find(".underline-font a").toggleClass("applied",t.textDecoration||!1),e.css("text-decoration",t.textDecoration)},getTextData:function(t){var e=this.$el.find(".line-container > .item .content"),n=this.$el.find(".options"),i={fontFamily:this.getQuoteScaped(e.css("font-family")),text:"&nbsp;"===e.text()?this.preEditText:e.text()};return n.find(".bold-font a").hasClass("applied")&&(i.fontWeight=e.css("font-weight")),n.find(".italic-font a").hasClass("applied")&&(i.fontStyle=e.css("font-style")),n.find(".underline-font a").hasClass("applied")&&(i.textDecoration=e.css("text-decoration")),t?o.decamelizeKeys(i,{separator:t}):i}})))},{"../../../../analytics/decorate":4,"../../../../app/decorate":7,"../../../../facade/design/design":19,"../../../../facade/editor/editor":45,"../../../../utils/humps":323,"./abstract/base":181,"./analytics/text":191,"./app/text":192,"./components/type-effect":194,"./templates/text.hbs":212}],215:[function(t,e,n){var i=t("./abstract/base"),a=t("./components/upload-effect.js");e.exports=i.extend({events:{"click .uploader.progress-button.loading":"cancelEvent"},cancelEvent:function(t){this.trigger("cancel"),this.cancel()},cancel:function(){this.canceled=!0,this.progressBar.setProgress(0)},initialize:function(){this.attemptsLeft=3,this.attemptDelay=2e3,i.prototype.initialize.call(this),_.bindAll(this,"setImage","onImageLoaded","onImageError","cancel")},render:function(){var t=this.template(this.getTemplateRenderData());this.$el.html(t).css({width:110,height:86}),this.progressBar=new a(this.$el.find(".progress-button")[0])},toggleProgressBar:function(t){t&&this.progressBar._submit()},updateProgressBar:function(t){this.canceled||(this.progressBar.setProgress(t),1===t&&this.progressBar.stop(1))},setImage:function(t,e){if(!this.canceled){var n=$("<img>").attr("id",t).attr("src",e).on("error",this.onImageError).on("load",this.onImageLoaded);this.$el.find("a.item").removeClass("hidden").append(n)}},onImageLoaded:function(){var t=this.$el.find(".uploader");this.$el.find("a.item").addClass("loaded"),this.progressBar.clear(),this.resize(),_.delay(function(){t.remove()},1e3)},onImageError:function(t){var e=$(t.currentTarget),n=--this.attemptsLeft>0,i=_.partial(this.setImage,e.attr("id"),e.attr("src"));e.remove(),n&&_.delay(i,this.attemptDelay),n||(this.progressBar.setProgress(0),this.trigger("thumbnail_load_error"))},getTemplateRenderData:function(){return{upload:!0}}})},{"./abstract/base":181,"./components/upload-effect.js":195}],216:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize | background",render:function(){this.trackEvent({eventAction:"show",eventLabel:this.category.id})}}},{}],217:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize | grids",render:function(){this.trackEvent({eventAction:"show",eventLabel:""})}}},{}],218:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize | placeholders",render:function(){this.trackEvent({eventAction:"show",eventLabel:this.categoryKey})}}},{}],219:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize | shapes",render:function(){this.trackEvent({eventAction:"show",eventLabel:this.categoryKey})}}},{}],220:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize | stickers",render:function(){this.trackEvent({eventAction:"show",eventLabel:this.category.id})}}},{}],221:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | customize",show:{eventAction:"show"},listContentToggleEvent:function(t){var e=$(t.currentTarget),n=e.closest("dt");n.hasClass("active")||this.trackEvent({eventAction:"content_toggle",eventLabel:e.data("key")})}}},{}],222:[function(t,e,n){var i=t("../../components/accordion-list/director");e.exports={listContentToggleEventCheckOnce:function(){return!window.Android&&this.appBridge.version.isGreaterThan("1.1.1")||window.Android&&!this.appBridge.version.isLowerThan("1.1")},listContentToggleEvent:function(t){var e,n,a=$(t.currentTarget),o=a.is('[data-key="stickers"]'),r=o;o&&this.appBridge.callBoth("pick_sticker"),!o&&window.Android&&(e=a.is('[data-key="backgrounds"]'),n=a.is('[data-key="shapes"]'),r=e||n,e&&this.appBridge.callBoth("pick_background"),n&&this.appBridge.callBoth("pick_shape")),r||i.prototype.listContentToggleEvent.call(this,t)}}},{"../../components/accordion-list/director":172}],223:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../components/thumbnail/color"),o=t("../../../../../analytics/decorate");e.exports=o(t("../../analytics/backgrounds"),i.extend({apiCall:"search/backgrounds",dataName:"backgroundCategories",callbackName:"callbackBackgrounds",where:{},initialize:function(t){this.category=_.find(INKIVE.Tool._cache.backgroundCategories,function(e){return e.id==t.key}),i.prototype.initialize.call(this,t)},getParams:function(){var t={from:this.from,limit:this.limit,where:{category:this.category.name}};return this.from+=this.limit,t},extractData:function(t){return _.map(t,function(t){var e=this.getImageData(t);return this.imagesFactory.addImageData(e),{id:"background-"+t.id,src:e.version.thumb,cls:parseInt(t.active)?"":"grayscale",data:e,width:110,height:78}},this)},getImageData:function(t){return{name:t.readable_name,count:t.count,version:{original:t.url,largeweb:t.url,web:t.url,tab:t.url,mobile:t.url&&t.url.replace("-web","-mobile"),thumb:t.url&&t.url.replace("-web","-thumb")}}},getScrollHeight:function(t){return t.closest(".tab-content").height()-this.$el.siblings().height()},render:function(){this.$el.html(this.template({placeholder:this.filterPlaceholder,colors:!0})),this.$el.find(".antiscroll-inner").addThumb(),this.renderColors()},renderColors:function(){this.$el.find(".colorLineWrapper .addmore");_.each(this.tool.editor.getFavColors(),this.addColorThumb,this),this.initColorPicker()},addColorThumb:function(t){var e=$('<div class="palette_item">');new a({el:e,color:t});e.insertBefore(this.$el.find(".colorLineWrapper .addmore"))},initColorPicker:function(){var t=this.$el.find(".colorLineWrapper");t.find(".addmore").colorpicker({defaultColor:"#FFFFFF",onSubmit:_.bind(function(t,e){this.addColorThumb(t)},this)})}}))},{"../../../../../analytics/decorate":4,"../../../components/accordion-list/content":170,"../../../components/thumbnail/color":193,"../../analytics/backgrounds":216}],224:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <div class="colorLineWrapper">\n      <div class="palette_item addmore" data-attr="fill fill-opacity" title="addmore">\n        <i class="icon-plus"></i>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],225:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../components/thumbnail/color"),o=t("../../../../../factory/user-info"),r=t("../../../../../factory/library");e.exports=i.extend({template:t("./colours.hbs"),initialize:function(){_.bindAll(this,"renderColors"),this.tool=INKIVE.Tool.getInstance(),this.render(),o.get().then(_.bind(function(t){var e=_(t.roles).contains("ROLE_LIBRARY");e&&r.get("colors").then(this.renderColors),e||this.renderColors()},this))},renderColors:function(t){this.$el.find(".colorLineWrapper .addmore");_(t).chain().pluck("data").pluck("color_code").each(this.addColorThumb,this),_.each(this.tool.editor.getFavColors(),this.addColorThumb,this),this.initColorPicker()},addColorThumb:function(t){var e=$('<div class="palette_item">');new a({el:e,color:t});e.insertBefore(this.$el.find(".colorLineWrapper .addmore"))},initColorPicker:function(){var t=this.$el.find(".colorLineWrapper");t.find(".addmore").colorpicker({defaultColor:"#FFFFFF",onSubmit:_.bind(function(t,e){this.addColorThumb(t)},this)})}})},{"../../../../../factory/library":67,"../../../../../factory/user-info":81,"../../../components/accordion-list/content":170,"../../../components/thumbnail/color":193,"./colours.hbs":224}],226:[function(t,e,n){var i=t("../../../components/accordion-list/categories-director"),a=t("../../../components/accordion-list/director"),o=t("./backgrounds");e.exports=i.extend({"class":"sub-category backgrounds",CategoriesView:o,Views:{colours:t("./colours")},views:{},loadListContent:function(t){var e="colours"===t;e||i.prototype.loadListContent.call(this,t),e&&a.prototype.loadListContent.call(this,t)},loadButtons:function(){var t=$.Deferred(),e={key:"colours",tag:"tool.customize.backgrounds_colours",icon:"fa fa-paint-brush"};return INKIVE.Tool.preloadBackgroundCategories(function(){var n=INKIVE.Tool._cache.backgroundCategories;t.resolve(_.union([e],_.map(n,function(t){return{key:t.id,tag:t.name,icon:"fa fa-ellipsis-v"}})))}),t.promise()},initialize:function(){i.prototype.initialize.call(this),this.render()}})},{"../../../components/accordion-list/categories-director":168,"../../../components/accordion-list/director":172,"./backgrounds":223,"./colours":225}],227:[function(t,e,n){var i=t("./templates/drawing.hbs");e.exports=Backbone.View.extend({buttons:[{tag:"tool.customize.draw.pen",mode:"fhpath",icon:"icon-pen-alt2"},{tag:"tool.customize.draw.square",mode:"square",icon:"icon-stop"},{tag:"tool.customize.draw.rect",mode:"rect",icon:"icon-stop desygner-icon-rect"},{tag:"tool.customize.draw.circle",mode:"circle",icon:"icon-circle-thin"},{tag:"tool.customize.draw.ellip",mode:"ellipse",icon:"icon-circle-thin desygner-icon-ellips"},{tag:"tool.customize.draw.line",mode:"line",icon:"icon-minus"}],events:{"click .drawingTool":"changeModeEvent"},changeModeEvent:function(t){var e=$(t.currentTarget).data("mode");this.editor.setMode(e)},initialize:function(){_.bindAll(this,"updateDrawingButtons"),this.editor=INKIVE.Tool.getInstance().editor,this.render()},render:function(){this.$el.html(i(this.buttons)),this.updateDrawingButtons()},updateDrawingButtons:function(){function t(){$(".drawingTool[data-mode=select]").addClass("active"),$("#workarea").css("cursor","")}function e(){$(".drawingTool[data-mode="+n+"]").addClass("active"),$("#workarea").css("cursor","textedit"==n?"text":"crosshair")}var n=this.editor.canvas.getMode(),i=this.$el.find(".drawingTool[data-mode]"),a=["select","multiselect","resize","rotate"],o=_.contains(a,n);i.removeClass("active"),o&&t(),o||e()}})},{"./templates/drawing.hbs":234}],228:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../../../analytics/decorate"),o=t("../../../../../factory/formats"),r=t("../../../components/thumbnail/grid");e.exports=a(t("../../analytics/grids"),i.extend({apiCall:"grid/fetch",columnWidth:INKIVE.C.IS_MOBILE?210:275,numberOfPhotos:0,initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.canvas=this.tool.editor.canvas,this.getFormat().then(_.bind(function(){this.setGridTemplateFormat(),i.prototype.initialize.call(this)},this)),this.$el.find(".thumbnailWrapper").addClass("thumbnail-wrapper").removeClass("thumbnailWrapper")},getFormat:function(){function t(t){function e(t){var e=INKIVE.Helpers.convertUnitsToPixels(t.width,t.unit),n=INKIVE.Helpers.convertUnitsToPixels(t.height,t.unit);return _.extend(t,{width:e,height:n,ratio:e/n})}var n,i=1/0,a=1/0,o=this.canvas.contentW,r=this.canvas.contentH,s=o/r;return _.each(t,function(t){var l,c=e(t),u=Math.abs(s-c.ratio);a>u&&(l=Math.abs(o-c.width)+Math.abs(r-c.height),i>l&&(n=t,i=l,a=u))}),n}var e=$.Deferred(),n=_.bind(t,this);return o.getFormats().then(function(t){e.resolve(n(t))}),e.promise()},loadData:function(t,e){var n=_.partial(this.onMoreData,this.filterActionId);this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),INKIVE.Helpers.sendCmd(INKIVE.C.BASE_URL+this.apiCall,this.getParams(),n),this.$el.find(".thumbnail-wrapper").css({height:"auto"})},getParams:function(){return _.extend({number_of_photos:++this.numberOfPhotos},this.size)},onMoreData:function(t,e){if(t===this.filterActionId){e=JSON.parse(e);var n="SUCCESS"===e.STATUS;n?(this.appendGridThumbnails(e.MESSAGE),this.repeat()):(this.end(),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner"))),this.scrollRefresh()}},appendGridThumbnails:function(t){var e=this.$el.find(".thumbnail-wrapper .scrollDetect");_.each(t,function(t){var n=$("<div>").addClass("thumbnail grid").insertBefore(e);new r({setCurrentPage:!0,el:n,size:this.size,format:this.callFormat,data:t,numberOfPhotos:this.numberOfPhotos})},this)},setGridTemplateFormat:function(){var t=this.columnWidth,e=this.tool.editor.canvas;this.callFormat={width:e.contentW,height:e.contentH},this.size={width:t,height:t*(this.callFormat.height/this.callFormat.width)}}}))},{"../../../../../analytics/decorate":4,"../../../../../factory/formats":65,"../../../components/accordion-list/content":170,"../../../components/thumbnail/grid":197,"../../analytics/grids":217}],229:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../../../analytics/decorate");e.exports=a(t("../../analytics/placeholders"),i.extend({apiCall:"search/stickers",callbackName:"callbackStickers",initialize:function(){this.debouncedMasonryReload=_.debounce(_.bind(this.masonryReload,this),2e3),i.prototype.initialize.call(this)},getParams:function(){var t={from:this.from,limit:this.limit,where:{isPlaceholder:!0,active:INKIVE.C.USER.IS_SUPER?0:1}};return this.from+=this.limit,t},extractData:function(t){return _.map(t,function(t){var e=this.idPrefix?this.idPrefix+"-":"";return e+="sticker-"+t.id,{id:e,src:t.url,width:1e3,height:1e3,cls:parseInt(t.active)?"":"grayscale",data:{name:t.name,count:t.count,changeable:t.changeable}}},this)},getScrollHeight:function(t){return t.height()}}))},{"../../../../../analytics/decorate":4,"../../../components/accordion-list/content":170,"../../analytics/placeholders":218}],230:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=(t("../../../components/thumbnail/color"),t("../../../../../analytics/decorate")),o=t("../../../../../factory/shapes");e.exports=a(t("../../analytics/shapes"),i.extend({apiCall:"search/shapes",dataName:"shapesCategories",initialize:function(t){this.categoryKey=t.key,i.prototype.initialize.call(this,t),this.scrollRefresh=_.debounce(_.bind(this.initScroll,this),500)},loadData:function(t,e){this.end=e,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),o.get(this.categoryKey).then(this.onMoreData)},onMoreData:function(t){t.length&&this.appendThumbnails(t),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),this.end(),this.scrollRefresh()},getScrollHeight:function(t){return t.closest(".tab-content").height()-this.$el.siblings().height()},appendThumbnails:function(t){_.each(t,function(t){var e=new INKIVE.ThumbShape(_.extend(t,{tooltip:t.name}));e.appendTo(this.$el)},this),this.masonryReload()}}))},{"../../../../../analytics/decorate":4,"../../../../../factory/shapes":80,"../../../components/accordion-list/content":170,"../../../components/thumbnail/color":193,"../../analytics/shapes":219}],231:[function(t,e,n){var i=t("../../../components/accordion-list/categories-director"),a=t("./shapes"),o=t("../../../../../factory/shapes");e.exports=i.extend({"class":"sub-category shapes",CategoriesView:a,views:{},loadButtons:function(){var t=$.Deferred();return o.getCategories().then(function(e){t.resolve(_.map(e,function(t){return{key:t.key,tag:t.name,icon:"fa fa-ellipsis-v"}}))}),t.promise()},initialize:function(){i.prototype.initialize.call(this),this.render()}})},{"../../../../../factory/shapes":80,"../../../components/accordion-list/categories-director":168,"./shapes":230}],232:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=(t("../../../components/thumbnail/color"),t("../../../../../analytics/decorate"));e.exports=a(t("../../analytics/stickers"),i.extend({apiCall:"search/stickers",dataName:"stickerCategories",callbackName:"callbackStickers",where:{},initialize:function(t){this.category=_.find(INKIVE.Tool._cache.stickerCategories,function(e){return e.id==t.key}),i.prototype.initialize.call(this,t)},getScrollHeight:function(t){return t.closest(".tab-content").height()-this.$el.siblings().height()},getParams:function(){var t={from:this.from,limit:this.limit,where:{category:this.category.name,active:INKIVE.C.USER.IS_SUPER?0:1}};return this.from+=this.limit,t},extractData:function(t){return _.map(t,function(t){return{id:"sticker-"+t.id,src:t.url,width:t.width,height:t.height,cls:parseInt(t.active)?"":"grayscale",data:{name:t.name,count:t.count,changeable:t.changeable,width:t.width,height:t.height}}})}}))},{"../../../../../analytics/decorate":4,"../../../components/accordion-list/content":170,"../../../components/thumbnail/color":193,"../../analytics/stickers":220}],233:[function(t,e,n){var i=t("../../../components/accordion-list/categories-director"),a=t("./stickers");e.exports=i.extend({"class":"sub-category stickers",CategoriesView:a,views:{},loadButtons:function(){var t=$.Deferred();return INKIVE.Tool.preloadStickerCategories(function(){var e=INKIVE.Tool._cache.stickerCategories;t.resolve(_.map(e,function(t){return{key:t.id,tag:t.name,icon:"fa fa-ellipsis-v"}}))}),t.promise()},initialize:function(){i.prototype.initialize.call(this),this.render()}})},{"../../../components/accordion-list/categories-director":168,"./stickers":232}],234:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l=t.escapeExpression,c="function";return'  <li>\n    <a class="btn btn-squire btn-tag drawingTool" tag="'+l((n.t||e&&e.t||s).call(r,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+'" data-mode="'+l((o=null!=(o=n.mode||(null!=e?e.mode:e))?o:s,typeof o===c?o.call(r,{name:"mode",hash:{},data:a}):o))+'">\n      <div class="iconWrapper"><i class="'+l((o=null!=(o=n.icon||(null!=e?e.icon:e))?o:s,typeof o===c?o.call(r,{name:"icon",hash:{},data:a}):o))+'"></i></div>\n    </a>\n  </li>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return'<ul class="btnWrapper">\n'+(null!=(o=n.each.call(null!=e?e:{},e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"</ul>\n"},useData:!0})},{"hbsfy/runtime":375}],235:[function(t,e,n){e.exports={render:function(){function t(t){if(t.disabled)return!1;switch(t.key){case"backgrounds":return e("function_use_desygner_background");case"placeholders":return e("function_use_desygner_images")&&e("image_add");case"stickers":return e("function_use_desygner_vector")&&e("vector_add");case"shapes":return e("function_use_desygner_vector")&&e("vector_add");case"grids":return e("function_use_desygner_images")&&e("image_add");case"drawing":return e("function_draw")&&e("vector_add")}return!0}var e=this.restrictionsFacade.isFunctionalityAllowed,n=this.template({"class":this["class"],buttons:this.buttons.filter(t)});this.$el.html(n)}}},{}],236:[function(t,e,n){var i=t("../components/accordion-list/director"),a=t("../../../app/decorate"),o=t("../../../facade/restrictions/decorate"),r=t("../../../analytics/decorate"),s=t("../../editor-mode-manager");e.exports=r(t("./analytics/view"),a(t("./app/view"),o(t("./restrict/view"),i.extend({"class":"customize",views:{},Views:{backgrounds:t("./contents/background/view"),placeholders:t("./contents/placeholders/view"),stickers:t("./contents/sticker/view"),shapes:t("./contents/shape/view"),grids:t("./contents/grids/view"),drawing:t("./contents/drawing"),text:t("../text/view"),banners:t("../text/banners")},buttons:[{key:"backgrounds",tag:"tool.customize.backgrounds",icon:"icon-backgrounds"},{key:"placeholders",tag:"tool.customize.placeholders",icon:"icon-image"},{key:"stickers",tag:"tool.customize.stickers",icon:"icon-hipster"},{key:"shapes",tag:"tool.customize.shapes",icon:"icon-bug"},{key:"grids",tag:"tool.customize.grids",icon:"icon-grid"},{key:"drawing",tag:"tool.customize.drawing",icon:"icon-pencil"}],initialize:function(){INKIVE.C.IS_MOBILE&&this.addTextOptions(),i.prototype.initialize.call(this)},addTextOptions:function(){this.buttons.unshift({key:"banners",tag:"tool.customize.banners",icon:"icon-brightness_auto"}),this.buttons.unshift({key:"text",tag:"tool.customize.text",icon:"icon-text-height"})},show:function(){i.prototype.show.call(this),this.$el.find('.wrapper [data-key="backgrounds"]').parent().toggle(!s.isMode("logo"))},render:function(){var t=this.template({"class":this["class"],buttons:this.buttons.filter(function(t){return!t.disabled})});this.$el.html(t)},closeAccordion:function(t,e){_.each(this.views,function(t,e){var n=this.$el.find('dt a[data-key="'+e+'"]'),i=n.closest("dt");i.is(".active")&&this.hideListContent(n,e)&&i.removeClass("active")},this)},hideListContent:function(t,e){e=e||t.data("key");var n=!this.views[e].closeView||this.views[e].closeView();return n&&this.toggleAcordionElement(t,!1),n},updateDrawingButtons:function(){var t=this.views.drawing;t&&t.updateDrawingButtons()}}))))},{"../../../analytics/decorate":4,"../../../app/decorate":7,"../../../facade/restrictions/decorate":57,"../../editor-mode-manager":102,"../components/accordion-list/director":172,"../text/banners":305,"../text/view":307,"./analytics/view":221,"./app/view":222,"./contents/background/view":226,"./contents/drawing":227,"./contents/grids/view":228,"./contents/placeholders/view":229,"./contents/shape/view":231,"./contents/sticker/view":233,"./restrict/view":235}],237:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | images",show:{eventAction:"show"},openSearchTabEvent:{eventAction:"open_search_tab"},listContentToggleEvent:function(t){var e=$(t.currentTarget),n=e.closest("dt");n.hasClass("active")||this.trackEvent({eventAction:"content_toggle",eventLabel:e.data("key")})}}},{}],238:[function(t,e,n){e.exports={authenticate:function(){function t(t,n){this.tool.facebookToken=n.access_token,e.call(this)}function e(){n.resolve(),this.initAuthenticatedDataLoading()}var n=$.Deferred();return this.authenticated?n.resolve():FB.getAccessToken()?e():(this.appBridge.off("ik.editor.auth.facebook"),this.appBridge.on("ik.editor.auth.facebook",_.bind(t,this)),this.appBridge.callBoth("send_facebook_credentials")),n.promise()}}},{}],239:[function(t,e,n){e.exports={authenticate:function(){function t(t,n){var i=INKIVE.C.BASE_URL+"load/api/instagramSetAuth",a={auth:n.access_token},o=_.bind(_.debounce(e,500),this);this.tool.token.instagram=n.access_token,INKIVE.Helpers.sendCmd(i,a,o)}function e(){n.resolve(),this.initAuthenticatedDataLoading()}var n=$.Deferred();return this.authenticated?n.resolve():this.tool.token.instagram?e.call(this):(this.appBridge.off("ik.editor.auth.instagram"),this.appBridge.on("ik.editor.auth.instagram",_.bind(t,this)),this.appBridge.callBoth("send_instagram_credentials")),n.promise()}}},{}],240:[function(t,e,n){var i=t("../../components/accordion-list/content");e.exports=i.extend({page:0,initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner"))},initAuthenticatedDataLoading:function(){this.authenticated=!0,i.prototype.initDataLoading.call(this)},authenticate:function(){var t=$.Deferred();return this.authenticated&&t.resolve(),this.authenticated||window.dbAsynInit(_.bind(function(e){e?(this.initAuthenticatedDataLoading(),t.resolve()):(this.trigger("no_access"),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),t.reject())},this)),t.promise()},loadData:function(t,e){this.end=e,this.repeat=t,this.canvas.call("advice.show","dropbox-view"),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.imagesFactory.getDropboxPhotos({page:this.page++},this.onMoreData)},onMoreData:function(t,e,n){if(INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),!t||!n.length)return void this.end();var i=_.bind(this.tool.callbackImages,this.tool);this.tool.addThumbItem(this.$el,this.extractData(e,n),i),this.scrollRefresh(),this.end()},extractData:function(t,e){return _.map(e,function(e){return{id:"photo-fl-"+e.object_id,src:e.src,data:t[e.src_big]}})}})},{"../../components/accordion-list/content":170}],241:[function(t,e,n){var i=t("./facebook/access"),a=t("./facebook/images");e.exports=i.extend({scope:"user_photos",apiCall:"load/albums/facebook",thumbnailClickEvent:function(t){this.openNewView("images",a,{albumId:t})}})},{"./facebook/access":243,"./facebook/images":244}],242:[function(t,e,n){var i=t("./facebook/access"),a=t("./facebook/page");e.exports=i.extend({scope:"manage_pages",apiCall:"load/albums/facebook/pages",thumbnailClickEvent:function(t){this.openNewView("page",a,{pageId:t})},closeView:function(){var t=!0;return _.each(this.views,function(e){t&=e.closeView()}),t&&i.prototype.closeView.call(this)}})},{"./facebook/access":243,"./facebook/page":245}],243:[function(t,e,n){var i=t("../../../components/accordion-list/content"),a=t("../../../../../app/decorate");e.exports=a(t("../app/facebook"),i.extend({initialize:function(){_.bindAll(this,"thumbnailClickEvent"),i.prototype.initialize.call(this)},thumbnailClickEvent:function(){},initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner"))},initAuthenticatedDataLoading:function(){this.authenticated=!0,i.prototype.initDataLoading.call(this)},authenticate:function(){function t(t){t.authResponse?(e.resolve(),this.initAuthenticatedDataLoading()):(this.trigger("no_access"),e.reject(),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")))}var e=$.Deferred();return this.authenticated&&e.resolve(),this.authenticated||FB.login(_.bind(t,this),{scope:this.scope}),e.promise()},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),INKIVE.Helpers.sendCmd(INKIVE.C.BASE_URL+this.apiCall,this.getParams(),this.onMoreData)},getParams:function(){return{width:107,height:73,fb_token:this.tool.facebookToken||FB.getAccessToken()}},onMoreData:function(t){this.end(),this.appendThumbnails(t),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner"))},appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper");_.each(this.extractData(t),function(t){var n=_.partial(this.thumbnailClickEvent,t.id),i=new INKIVE.ThumbGroupImage($.extend(t,{tooltip:t.name,thumb:t.src,onItemLoad:function(t){$(t).on("click",n)}}));i.appendTo(e)},this)},extractData:function(t){return $.parseJSON(t)}}))},{"../../../../../app/decorate":7,"../../../components/accordion-list/content":170,"../app/facebook":238}],244:[function(t,e,n){var i=t("../../../components/accordion-list/content");e.exports=i.extend({initialize:function(t){this.albumId=t.albumId,i.prototype.initialize.call(this)},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.imagesFactory.getFacebookPhotos(this.getParams(),this.onMoreData)},getParams:function(){return{albums:[{id:this.albumId,after:this.after}],fb_token:this.tool.facebookToken||FB.getAccessToken()}},onMoreData:function(t,e,n){var i=_.bind(this.tool.callbackImages,this.tool),a=this.extractData(e,n[this.albumId].data);INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),this.after=n[this.albumId].paging.cursors.after,this.tool.addThumbItem(this.$el,a,i),this.scrollRefresh(),n[this.albumId].paging.next?this.repeat():this.end()},extractData:function(t,e){return _.map(e,function(e,n){return{id:"photo-fb-"+e.object_id,src:e.src,data:t[e.src_big],width:110,height:84}})}})},{"../../../components/accordion-list/content":170}],245:[function(t,e,n){var i=t("./access"),a=t("./images");e.exports=i.extend({apiCall:"load/albums/facebook",initialize:function(t){this.pageId=t.pageId,_.bindAll(this,"thumbnailClickEvent"),i.prototype.initialize.call(this)},initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.initAuthenticatedDataLoading()},getParams:function(){var t={page_ids:'["'+this.pageId+'"]'};return t.fb_token=this.tool.facebookToken||FB.getAccessToken(),t},thumbnailClickEvent:function(t){this.openNewView("images",a,{albumId:t})},closeView:function(){var t=_.size(this.views)>0;return t?(i.prototype.closeView.call(this),!1):!0}})},{"./access":243,"./images":244}],246:[function(t,e,n){var i=t("../../components/accordion-list/content");e.exports=i.extend({page:0,initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner"))},initAuthenticatedDataLoading:function(){this.authenticated=!0,i.prototype.initDataLoading.call(this)},authenticate:function(){var t=$.Deferred();return this.authenticated&&t.resolve(),this.authenticated||window.flAsynInit(_.bind(function(e){e?(this.initAuthenticatedDataLoading(),t.resolve()):(this.trigger("no_access"),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),t.reject())},this)),t.promise()},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.imagesFactory.getFlickerPhotos({page:this.page++},this.onMoreData)},onMoreData:function(t,e,n){if(INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),!t||!n.length)return void this.end();var i=_.bind(this.tool.callbackImages,this.tool);this.tool.addThumbItem(this.$el,this.extractData(e,n),i),
this.scrollRefresh(),this.repeat()},extractData:function(t,e){return _.map(e,function(e){return{id:"photo-fl-"+e.object_id,src:e.src,data:t[e.src_big]}})}})},{"../../components/accordion-list/content":170}],247:[function(t,e,n){var i=t("../../components/accordion-list/content");e.exports=i.extend({page:0,initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner"))},initAuthenticatedDataLoading:function(){this.authenticated=!0,i.prototype.initDataLoading.call(this)},authenticate:function(){var t=$.Deferred();return this.authenticated&&t.resolve(),this.authenticated||window.gdAsynInit(_.bind(function(e){e?(this.initAuthenticatedDataLoading(),t.resolve()):(this.trigger("no_access"),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),t.reject())},this)),t.promise()},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.imagesFactory.getGooglePhotos({page:this.page++},this.onMoreData)},onMoreData:function(t,e,n){if(INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),!t||!n.length)return void this.end();var i=_.bind(this.tool.callbackImages,this.tool);this.tool.addThumbItem(this.$el,this.extractData(e,n),i),this.scrollRefresh(),this.repeat()},extractData:function(t,e){return _.map(e,function(e){return{id:"photo-gd-"+e.object_id,src:e.src,data:t[e.src_big]}})}})},{"../../components/accordion-list/content":170}],248:[function(t,e,n){var i=t("../../components/accordion-list/content"),a=t("../../../../app/decorate");e.exports=a(t("./app/instagram"),i.extend({initialize:function(){_.bindAll(this,"initAuthenticatedDataLoading"),i.prototype.initialize.call(this)},initDataLoading:function(){this.end&&this.end(),INKIVE.Modal.loader(this.$el.find(".antiscroll-inner"))},initAuthenticatedDataLoading:function(){this.authenticated=!0,i.prototype.initDataLoading.call(this)},authenticate:function(){var t=$.Deferred();return this.authenticated&&t.resolve(),this.authenticated||window.inAsynInit(_.bind(function(e){e?(this.initAuthenticatedDataLoading(),t.resolve()):(this.trigger("no_access"),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),t.reject())},this)),t.promise()},loadData:function(t,e){this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),this.imagesFactory.getInstagramPhotos(null,this.onMoreData)},onMoreData:function(t,e,n){if(INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner")),t){var i=_.bind(this.tool.callbackImages,this.tool);this.tool.addThumbItem(this.$el,this.extractData(e,n),i),this.scrollRefresh(),this.end()}},extractData:function(t,e){return _.map(e,function(e){return{id:"photo-in-"+e.object_id,src:e.src,width:e.src_web_width,height:e.src_web_height,data:t[e.src_big]}})}}))},{"../../../../app/decorate":7,"../../components/accordion-list/content":170,"./app/instagram":239}],249:[function(t,e,n){var i=t("../../components/accordion-list/content"),a=t("./project");e.exports=i.extend({apiCall:"photo/saved",initialize:function(){i.prototype.initialize.call(this),_.bindAll(this,"displayProjectImagesEvent")},displayProjectImagesEvent:function(t){this.openNewView("project",a,{projectId:t})},getParams:function(){var t={id:INKIVE.C.BOOK.id,type:"albums",from:this.from,limit:this.limit};return this.from+=this.limit,t},appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper");_.each(t,function(t){var n=_.partial(this.displayProjectImagesEvent,t.id),i=new INKIVE.ThumbGroupImage($.extend(t,{tooltip:t.name,thumb:t.scrapbook_url_key,onItemLoad:function(t){$(t).on("click",n)}}));i.appendTo(e)},this),this.masonryReload()}})},{"../../components/accordion-list/content":170,"./project":250}],250:[function(t,e,n){var i=t("../../components/accordion-list/content"),a=t("../../components/mixins/upload-list");e.exports=Backbone.mixin(i.extend({apiCall:"photo/saved",initialize:function(t){this.projectId=t.projectId,i.prototype.initialize.call(this),this.projectId||a.initialize.call(this)},getParams:function(){var t={id:this.projectId||INKIVE.C.BOOK.id,type:"photos",from:this.from,limit:this.limit};return this.from+=this.limit,t},extractData:function(t){return _.compact(_.map(t,function(t){if(t.thumb_photo.trim()){var e=this.getImageData(t);return this.imagesFactory.addImageData(e),{id:"photo-saved-"+t.photo_id,src:t.thumb_photo,width:t.original_photo_width,height:t.original_photo_height,times_used:t.count,data:e,sticker_value:t.count,sticker_tooltip:"used "+t.count+" time"+(t.count>1?"s":"")}}},this))},getImageData:function(t){return{name:t.name,date:t.create_date,version:{thumb:t.thumb_photo,mobile:t.mobile_photo,tab:t.tab_photo,web:t.web_photo,largeweb:t.largeweb_photo,original:t.original_photo}}},complete:function(t,e){a.complete.call(this,t,e),this.views[t].$el.find(".item").data("version",{original:e.tempLink}),this.tool.callbackImages(this.views[t].$el,this.$el)},closeView:function(){return!0}}),a)},{"../../components/accordion-list/content":170,"../../components/mixins/upload-list":179}],251:[function(t,e,n){var i=t("../../components/accordion-list/director");e.exports={render:function(t){function e(t){if(t.disabled)return!1;switch(t.key){case"search":return n("function_use_web_images")&&n("image_add")}return!0}var n=this.restrictionsFacade.isFunctionalityAllowed;this.buttons=this.buttons.filter(e),i.prototype.render.call(this)}}},{"../../components/accordion-list/director":172}],252:[function(t,e,n){var i=t("../components/accordion-list/director"),a=t("../../../analytics/decorate"),o=t("../../../facade/restrictions/decorate");e.exports=a(t("./analytics/view"),o(t("./restrict/view"),i.extend({"class":"images",uploadViewKey:"project",views:{},Views:{project:t("./contents/project"),other:t("./contents/other"),facebookAlbums:t("./contents/facebook-albums"),facebookPages:t("./contents/facebook-pages"),instagram:t("./contents/instagram"),flickr:t("./contents/flickr"),gdrive:t("./contents/gdrive"),dropbox:t("./contents/dropbox")},buttons:[],events:{'click dt > a:not([data-key="add"]):not([data-key="search"])':"listContentToggleEvent",'click dt > a[data-key="search"]':"openSearchTabEvent"},loadListContent:function(t){var e=this.$el.find('dt a[data-key="'+t+'"]'),n=i.prototype.loadListContent.apply(this,arguments);return n.on("no_access",function(){e.addClass("blink")}),n},listContentToggleEvent:function(t){var e=$(t.currentTarget);e.removeClass("blink");var n=e.closest("dt"),a=n.hasClass("active"),o=e.data("key");return this.views[o]||this.loadListContent(o),!a&&this.views[o].authenticate?void this.views[o].authenticate().then(_.bind(function(){i.prototype.listContentToggleEvent.call(this,t)},this)):void i.prototype.listContentToggleEvent.call(this,t)},openSearchTabEvent:function(t){$('.tool-menu li > a[href="#tabSearch"]').trigger("click")},initialize:function(){this.buttons=[{key:"add",tag:"tool.images.add",icon:"icon-plus"},{key:"project",tag:"tool.images.this",image:"assets/img/favicon-editor.png"},{key:"other",tag:"tool.images.other",image:"assets/img/favicon-editor.png"}],INKIVE.C.IS_MOBILE||this.buttons.push({key:"search",tag:"tool.images.search",icon:"icon-magnifying-glass"}),this.buttons=_.union(this.buttons,[{key:"facebookAlbums",tag:"tool.images.facebook_albums",icon:"icon-fbk"},{key:"facebookPages",tag:"tool.images.facebook_pages",icon:"icon-fbk"},{key:"instagram",tag:"tool.images.instagram",icon:"icon-in"}]),INKIVE.C.IS_MOBILE_APP||(this.buttons=_.union(this.buttons,[{key:"flickr",tag:"tool.images.flickr",icon:"icon-fl"},{key:"gdrive",tag:"tool.images.gdrive",icon:"icon-gd",disabled:!INKIVE.C.USER.IS_SUPER},{key:"dropbox",tag:"tool.images.dropbox",icon:"icon-db",disabled:!INKIVE.C.USER.IS_SUPER}])),i.prototype.initialize.call(this)}})))},{"../../../analytics/decorate":4,"../../../facade/restrictions/decorate":57,"../components/accordion-list/director":172,"./analytics/view":237,"./contents/dropbox":240,"./contents/facebook-albums":241,"./contents/facebook-pages":242,"./contents/flickr":246,"./contents/gdrive":247,"./contents/instagram":248,"./contents/other":249,"./contents/project":250,"./restrict/view":251}],253:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | import",show:{eventAction:"show"},listContentToggleEvent:function(t){var e=$(t.currentTarget),n=e.closest("dt");n.hasClass("active")||this.trackEvent({eventAction:"content_toggle",eventLabel:e.data("key")})}}},{}],254:[function(t,e,n){var i=t("./base"),a=t("../../components/mixins/upload-list");e.exports=Backbone.mixin(i.extend({uploadConfig:{validation:{acceptFiles:".pdf, .psd, .svg, .ppt, .pptx",allowedExtensions:["pdf","psd","svg","ppt","pptx"]},uploadSuccess:{params:{loadType:120}}},initialize:function(){i.prototype.initialize.call(this),a.initialize.call(this)},complete:function(t,e){var n=this.views[t];n.cancel(),_.delay(_.bind(function(){n.remove(),this.refreshView()},this),1e3)},appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper"),n=_.bind(this.tool.callbackImages,this.tool);this.tool.addThumbItem(this.$el,this.extractImageData(t),n),_.each(this.extractSvgData(t),function(t){this.$el.find("#"+t.uuid).length||t.appendTo(e)},this),_.each(this.extractTextData(t),function(t){this.$el.find("#"+t.uuid).length||t.appendTo(e)},this),this.masonryReload()},closeView:function(){return!0}}),a)},{"../../components/mixins/upload-list":179,"./base":255}],255:[function(t,e,n){var i=t("../../components/accordion-list/content");e.exports=i.extend({apiCall:"photo/imported",limit:20,initialize:function(){i.prototype.initialize.call(this),this.refreshView=_.debounce(_.bind(function(){this.masonryReload(),this.from-=2*this.limit,this.from=this.from<0?0:this.from,this.initDataLoading()},this),2e3)},getParams:function(){var t={id:INKIVE.C.BOOK.id,from:this.from,limit:this.limit};return this.from+=this.limit,t},extractSvgData:function(t){return _.compact(_.map(t,function(t){return"svg"==t.type?new INKIVE.ThumbSvg(t):void 0},this))},extractTextData:function(t){return _.compact(_.map(t,function(e){return"text"==e.type?new INKIVE.ThumbText($.extend(e,{tooltip:t.text})):void 0},this))},extractImageData:function(t){return _.compact(_.map(t,function(t){if("svg"!=t.type&&"text"!=t.type&&t.thumb_photo.trim()){var e="photo-saved-"+t.photo_id;if(!this.$el.find("#"+e).length){var n=this.getImageData(t);return this.imagesFactory.addImageData(n),{id:e,src:t.thumb_photo,width:t.original_photo_width,height:t.original_photo_height,times_used:t.count,data:n,sticker_value:t.count,sticker_tooltip:"used "+t.count+" time"+(t.count>1?"s":"")}}}},this))},getImageData:function(t){return{name:t.name,date:t.create_date,version:{thumb:t.thumb_photo,mobile:t.mobile_photo,tab:t.tab_photo,web:t.web_photo,largeweb:t.largeweb_photo,original:t.original_photo}}}})},{"../../components/accordion-list/content":170}],256:[function(t,e,n){var i=t("./base");e.exports=i.extend({appendThumbnails:function(t){var e=(this.$el.find(".thumbnailWrapper"),_.bind(this.tool.callbackImages,this.tool));this.tool.addThumbItem(this.$el,this.extractImageData(t),e),this.masonryReload()}})},{"./base":255}],257:[function(t,e,n){var i=t("./base");e.exports=i.extend({appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper");_.each(this.extractSvgData(t),function(t){this.$el.find("#"+t.uuid).length||t.appendTo(e)},this),this.masonryReload()}})},{"./base":255}],258:[function(t,e,n){var i=t("./base");e.exports=i.extend({appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper");_.each(this.extractTextData(t),function(t){this.$el.find("#"+t.uuid).length||t.appendTo(e)},this),this.masonryReload()}})},{"./base":255}],259:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<div class="cant-import">\n  <p>'+s((n.t||e&&e.t||r).call(o,"tool.import.helper.text_6",{name:"t",hash:{},data:a}))+'</p>\n  <p><br/></p>\n  <a href="'+s((n.route||e&&e.route||r).call(o,"library?r=upgrade",{name:"route",hash:{},data:a}))+'" target="_blank" class="btn btn-yellow go-premium">'+s((n.t||e&&e.t||r).call(o,"tool.import.helper.go_premium",{name:"t",hash:{},data:a}))+"</a>\n</div>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u=t.escapeExpression,h="<p>"+u((n.t||e&&e.t||c).call(l,"tool.import.helper.text_1",{name:"t",hash:{},data:a}))+"</p>\n<p>"+u((n.t||e&&e.t||c).call(l,"tool.import.helper.text_2",{name:"t",hash:{},data:a}))+' <a href="#" class="open-images">'+u((n.t||e&&e.t||c).call(l,"tool.import.helper.text_3",{name:"t",hash:{},data:a}))+"</a> "+u((n.t||e&&e.t||c).call(l,"tool.import.helper.text_4",{name:"t",hash:{},data:a}))+"</p>\n<p><br/></p>\n<p>"+u((n.t||e&&e.t||c).call(l,"tool.import.helper.text_5",{name:"t",hash:{},data:a}))+"</p>\n\n";return r=null!=(r=n.can_import||(null!=e?e.can_import:e))?r:c,s={name:"can_import",hash:{},fn:t.noop,inverse:t.program(1,a,0),data:a},o="function"==typeof r?r.call(l,s):r,n.can_import||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(h+=o),h},useData:!0})},{"hbsfy/runtime":375}],260:[function(t,e,n){var i=t("../components/helper/view"),a=t("./helper.hbs");t("../../../factory/user-info");e.exports=i.extend({events:_.extend({},i.prototype.events,{"click a.open-images":"openImagesTabEvent","click a.btn.go-premium":"upgradeEvent"}),openImagesTabEvent:function(){$('.tool-menu li > a[href="#tabImages"]').trigger("click")},upgradeEvent:function(){},initialize:function(t){i.prototype.initialize.call(this),this.initData(t.isPremium)},initData:function(t){this.data.title="tool.import.helper.title",this.data.content=a({can_import:t}),this.render(),_.delay(_.bind(this.toggle,this,!t),600)}})},{"../../../factory/user-info":81,"../components/helper/view":174,"./helper.hbs":259}],261:[function(t,e,n){e.exports={render:function(t){function e(t){if(t.disabled)return!1;switch(t.key){case"all":return n("text_add")&&n("vector_add")&&n("function_use_own_images")&&n("image_add");case"images":return n("function_use_own_images")&&n("image_add");case"text":return n("text_add");case"svg":return n("vector_add")}return!0}var n=this.restrictionsFacade.isFunctionalityAllowed;this.lockedLibrary=t,this.$el.html(this.template({"class":this["class"],buttons:this.buttons.filter(e)})),this.helperView&&this.helperView.remove(),t&&this.initHelper()}}},{}],262:[function(t,e,n){var i=t("../components/accordion-list/director"),a=t("./helper.js"),o=t("../../../factory/user-info"),r=t("../../../analytics/decorate"),s=t("../../../facade/restrictions/decorate");e.exports=r(t("./analytics/view"),s(t("./restrict/view"),i.extend({"class":"import",uploadViewKey:"all",views:{},Views:{all:t("./contents/all"),images:t("./contents/images"),text:t("./contents/text"),svg:t("./contents/svg")},buttons:[{key:"add",tag:"tool.import.add",icon:"icon-plus"},{key:"all",tag:"tool.import.all",icon:"icon-earth"},{key:"images",tag:"tool.import.images",icon:"icon-file-image-o"},{key:"text",tag:"tool.import.text",icon:"icon-text-height"},{key:"svg",tag:"tool.import.svg",icon:"icon-file-code-o"}],listContentToggleEvent:function(t){this.isPremium||this.helperView.toggle(!0),this.isPremium&&i.prototype.listContentToggleEvent.call(this,t)},beforeSubmitEvent:function(t){this.isPremium||(this.helperView.toggle(!0),t.preventDefault())},initialize:function(){_.bindAll(this,"beforeSubmitEvent"),o.get().then(_.bind(function(t){this.isPremium=_(t.roles).contains("ROLE_PREMIUM"),i.prototype.initialize.call(this)},this))},render:function(){i.prototype.render.call(this),this.initHelper()},initHelper:function(){var t=$("<div>");this.$el.children(".tab-content").append(t),this.helperView=new a({isPremium:this.isPremium,el:t}),this.helperView.on("toggle",_.bind(function(t){this.$el.find(".wrapper").toggleClass("blur",t)},this))}})))},{"../../../analytics/decorate":4,"../../../facade/restrictions/decorate":57,"../../../factory/user-info":81,"../components/accordion-list/director":172,"./analytics/view":253,"./contents/all":254,"./contents/images":256,"./contents/svg":257,"./contents/text":258,"./helper.js":260,"./restrict/view":261}],263:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | library",show:{eventAction:"show"},listContentToggleEvent:function(t){var e=$(t.currentTarget),n=e.closest("dt");n.hasClass("active")||this.trackEvent({eventAction:"content_toggle",eventLabel:e.data("key")})}}},{}],264:[function(t,e,n){var i=t("./base"),a=t("../../../../facade/design/design"),o=t("../../../../facade/editor/editor");e.exports=i.extend({type:"images",filter:{type:2},ThumbnailView:t("../../components/thumbnail/library/background"),initialize:function(){_.bindAll(this,"updateBackgroundSize"),this.editor=INKIVE.Tool.getInstance().editor,this.canvas=this.editor.canvas,i.prototype.initialize.call(this),o.on("page.move_to",this.updateBackgroundSize),a.on("template.update.size",this.updateBackgroundSize)},render:function(t){this.$el.html(this.template()),_.each(t,this.addThumbnail,this),t.length||this.$el.find(".library-link").removeClass("hidden"),this.updateBackgroundSize()},updateBackgroundSize:function(t){var e=this.canvas.contentW/this.canvas.contentH,n=this.$el.find("ul.thumbnail-wrapper li").width();this.$el.find("ul.thumbnail-wrapper li").css("height",n/e),this.initScroll()}})},{"../../../../facade/design/design":19,"../../../../facade/editor/editor":45,"../../components/thumbnail/library/background":198,"./base":265}],265:[function(t,e,n){var i=t("../../components/mixins/scrollable"),a=t("../../../../factory/library");e.exports=Backbone.mixin(Backbone.mixin(Backbone.View.extend({template:t("./template.hbs"),events:{"click .library-link a.empty":"goToLibraryEvent"},goToLibraryEvent:_.partial(Backbone.Events.trigger,"go_to_libray"),initialize:function(){_.bindAll(this,"render","loadData")},loadData:function(){INKIVE.Modal.loader(this.$el.empty()),a.get(this.type,this.filter).then(this.render)},render:function(t){this.$el.html(this.template()),_.each(t,this.addThumbnail,this),t.length||this.$el.find(".library-link").removeClass("hidden"),this.initScroll()},addThumbnail:function(t){var e=$("<li>"),n=new this.ThumbnailView({el:e,item:t});return this.$el.find("ul.thumbnail-wrapper").append(e),n},remove:function(){this.undelegateEvents(),this.$el.removeData().unbind(),Backbone.View.prototype.remove.call(this)},getScrollHeight:function(t){var e=t.closest(".tab-content").height(),n=t.siblings(".btn.btn-accordion").is(":visible")?t.siblings(".btn.btn-accordion").height():$("#ik-menu-back").height();return e-n}}),Backbone.Events),i)},{"../../../../factory/library":67,"../../components/mixins/scrollable":178,"./template.hbs":269}],266:[function(t,e,n){var i=t("./base");e.exports=i.extend({type:"colors",ThumbnailView:t("../../components/thumbnail/library/color"),render:function(t){i.prototype.render.call(this,t),INKIVE.Helpers.initTooltips(this.$el)}})},{"../../components/thumbnail/library/color":199,"./base":265}],267:[function(t,e,n){var i=t("./base");e.exports=i.extend({type:"images",filter:{type:1},ThumbnailView:t("../../components/thumbnail/library/image"),initialize:function(){i.prototype.initialize.call(this),this.masonryRefresh=_.debounce(_.bind(this.masonryReload,this),1e3),this.scrollRefresh=_.debounce(_.bind(this.initScroll,this),2e3)},render:function(){i.prototype.render.apply(this,arguments),this.$el.find(".thumbnail-wrapper").masonry()},addThumbnail:function(){var t=i.prototype.addThumbnail.apply(this,arguments);return t.on("resize",this.masonryRefresh),t},masonryReload:function(){var t=this.$el.find(".thumbnail-wrapper");t.masonry("reloadItems"),t.masonry("layout"),this.scrollRefresh()}})},{"../../components/thumbnail/library/image":200,"./base":265}],268:[function(t,e,n){var i=t("./base");e.exports=i.extend({type:"logos",ThumbnailView:t("../../components/thumbnail/library/logo")})},{"../../components/thumbnail/library/logo":201,"./base":265}],269:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <ul class="thumbnail-wrapper"></ul>\n    <div class="library-link hidden">\n      <p>'+s((n.t||e&&e.t||r).call(o,"tool.library.empty.message",{name:"t",hash:{},data:a}))+'</p>\n      <a href="'+s((n.route||e&&e.route||r).call(o,"library",{name:"route",hash:{},data:a}))+'" target="_blank" class="btn btn-yellow empty">'+s((n.t||e&&e.t||r).call(o,"tool.library.empty.button",{name:"t",hash:{},data:a}))+"</a>\n    </div>\n  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],270:[function(t,e,n){var i=t("./base");e.exports=i.extend({type:"texts",ThumbnailView:t("../../components/thumbnail/library/text")})},{"../../components/thumbnail/library/text":202,"./base":265}],271:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o=null!=e?e:{},r=n.helperMissing,s=t.escapeExpression;return'<div class="big-icon"><i class="fa fa-unlock"></i></div>\n<a href="'+s((n.route||e&&e.route||r).call(o,"library",{name:"route",hash:{},data:a}))+'" target="_blank" class="btn btn-yellow locked">\n    '+s((n.t||e&&e.t||r).call(o,"tool.library.locked.button",{name:"t",hash:{},data:a}))+"\n</a>\n"},useData:!0})},{"hbsfy/runtime":375}],272:[function(t,e,n){var i=t("../components/helper/view"),a=t("./helper.hbs");e.exports=i.extend({events:_.extend({},i.prototype.events,{"click a.locked":"goToLibraryEvent"}),goToLibraryEvent:function(){$('#tool-panel .tool-menu a[href="#tabTutorial"]').trigger("click")},initialize:function(){i.prototype.initialize.call(this),this.data.title="tool.library.locked.message",this.data.content=a(),this.render()}})},{"../components/helper/view":174,"./helper.hbs":271}],273:[function(t,e,n){e.exports={render:function(t){function e(t){if(t.disabled)return!1;switch(t.key){case"text":return n("text_add");case"logos":return n("function_use_own_logos");case"colors":return n("function_use_own_colors");case"images":return n("function_use_own_images")&&n("image_add");case"backgrounds":return n("function_use_own_background")}return!0}var n=this.restrictionsFacade.isFunctionalityAllowed;this.lockedLibrary=t,this.$el.html(this.template({"class":this["class"],buttons:this.buttons.filter(e)})),this.helperView&&this.helperView.remove(),t&&this.initHelper()}}},{}],274:[function(t,e,n){var i=t("../components/accordion-list/director"),a=t("../../../analytics/decorate"),o=t("../../../facade/restrictions/decorate"),r=t("../../../factory/user-info"),s=t("./helper.js"),l=t("../../../factory/library"),c=t("../../editor-mode-manager");e.exports=a(t("./analytics/view"),o(t("./restrict/view"),i.extend({"class":"library",views:{},Views:{text:t("./contents/texts"),logos:t("./contents/logos"),colors:t("./contents/colors"),images:t("./contents/images"),backgrounds:t("./contents/backgrounds")},buttons:[{key:"text",tag:"tool.library.text",icon:"fa fa-font"},{key:"logos",tag:"tool.library.logos",icon:"fa fa-certificate"},{key:"colors",tag:"tool.library.colors",icon:"fa fa-paint-brush"},{key:"images",tag:"tool.library.images",icon:"fa fa-picture-o"},{key:"backgrounds",tag:"tool.library.backgrounds",icon:"fa fa-th"}],listContentToggleEvent:function(t){this.lockedLibrary&&this.helperView.toggle(!0),this.lockedLibrary||i.prototype.listContentToggleEvent.call(this,t)},loadListContent:function(t){var e=i.prototype.loadListContent.apply(this,arguments),n=this.$el.find('dt a[data-key="'+t+'"]');return e.on("go_to_libray",_.bind(function(){this.hideListContent(n,t),n.closest("dt").removeClass("active"),l.cacheClear(t)},this)),e},showListContent:function(t,e){e=e||t.data("key"),i.prototype.showListContent.call(this,t,e),this.views[e].loadData()},show:function(){var t=new Date,e=t-this.showingTime<600,n=this.$el.find(".tab-content.library").length>0&&0===this.$el.find(".tab-content.library .helper").length;n||this.checkForRole(),n&&e&&this.closeAccordion(),this.showingTime=t,this.$el.find('.wrapper [data-key="backgrounds"]').parent().toggle(!c.isMode("logo"))},checkForRole:function(t){this.$el.empty(),INKIVE.Modal.loader(this.$el),r.get(t).then(_.bind(function(e){INKIVE.Modal.loaderClose(this.$el);var n=_(e.roles).contains("ROLE_LIBRARY");n?this.render():(t&&this.render(!0),t||this.checkForRole(!0))},this))},render:function(t){this.lockedLibrary=t,this.$el.html(this.template({"class":this["class"],buttons:this.buttons})),this.helperView&&this.helperView.remove(),t&&this.initHelper()},initHelper:function(){var t=$("<div>");this.$el.children(".tab-content").append(t),this.helperView=new s({el:t}),this.helperView.on("toggle",_.bind(function(t){this.$el.find(".wrapper").toggleClass("blur",t)},this)),this.helperView.toggle(!0)}})))},{"../../../analytics/decorate":4,"../../../facade/restrictions/decorate":57,"../../../factory/library":67,"../../../factory/user-info":81,"../../editor-mode-manager":102,"../components/accordion-list/director":172,"./analytics/view":263,"./contents/backgrounds":264,"./contents/colors":266,"./contents/images":267,"./contents/logos":268,"./contents/texts":270,"./helper.js":272,"./restrict/view":273}],275:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o;return"<span>"+t.escapeExpression(t.lambda(null!=(o=null!=e?e.restrictions:e)?o.length:o,e))+"</span>"},3:function(t,e,n,i,a){return'  <p class="restrictions-list">No element restrictions have been added yet. Select an element on your template to start.</p>\n'},5:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l=t.escapeExpression,c="function";return"      <li>\n      <!-- TODO : Add element type -->\n        "+l((n.math||e&&e.math||s).call(r,a&&a.index,"+",1,{name:"math",hash:{},data:a}))+") Restriction on "+l((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===c?o.call(r,{name:"name",hash:{},data:a}):o))+'\n        <button class="show-restriction" data-element="'+l((o=null!=(o=n.element||(null!=e?e.element:e))?o:s,typeof o===c?o.call(r,{name:"element",hash:{},data:a}):o))+'">view</button>\n      </li>\n'},7:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<option value="'+c((o=null!=(o=n.id||(null!=e?e.id:e))?o:s,typeof o===l?o.call(r,{name:"id",hash:{},data:a}):o))+'">'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+"</option>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l=null!=e?e:{},c=n.helperMissing,u="function",h=n.blockHelperMissing,d='<div class="group no-top-margin">\n  <div>\n    <h4>\n      Element Restrictions\n      ';return r=null!=(r=n.has_restrictions||(null!=e?e.has_restrictions:e))?r:c,s={name:"has_restrictions",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o=typeof r===u?r.call(l,s):r,n.has_restrictions||(o=h.call(e,o,s)),null!=o&&(d+=o),d+="\n    </h4>\n  </div>\n\n",r=null!=(r=n.has_restrictions||(null!=e?e.has_restrictions:e))?r:c,s={name:"has_restrictions",hash:{},fn:t.noop,inverse:t.program(3,a,0),data:a},o=typeof r===u?r.call(l,s):r,n.has_restrictions||(o=h.call(e,o,s)),null!=o&&(d+=o),d+'\n  <ul class="restrictions-list">\n'+(null!=(o=n.each.call(l,null!=e?e.restrictions:e,{name:"each",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a}))?o:"")+'  </ul>\n\n  <div class="element-selected hidden">\n    Editing restrictions on the selected element.\n    <div class="select-wrapper">\n      <select>\n        '+(null!=(o=n.each.call(l,null!=e?e.groups:e,{name:"each",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a}))?o:"")+"\n      </select>\n    </div>\n  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],276:[function(t,e,n){var i=t("./element-restrictions.hbs"),a=t("../../../facade/editor/editor"),o=t("../../../factory/restrictions"),r=t("../../../facade/restrictions/restrictions"),s={text:t("./element/text-type"),image:t("./element/image-type"),vector:t("./element/vector-type"),background:t("./element/background-type")};e.exports=Backbone.mixin(Backbone.View.extend({events:{"change .element-selected select":"changeGroupEvent","click button.show-restriction":"showRestrictionEvent"},showRestrictionEvent:function(t){var e=INKIVE.Tool.getInstance().editor.canvas,n=$("#"+$(t.currentTarget).data("element"));e.setMode("select"),e.selectOnly([n[0]],!0)},changeGroupEvent:function(t){if(this.currentRestrictionsView){var e=this.getGroup($(t.currentTarget).val());e&&this.currentRestrictionsView.refresh(e)}},getGroup:function(t){return _(this.groups).find(function(e){return e.id==t})},initialize:function(){_.bindAll(this,"render","selectedEvent"),a.on("select",this.selectedEvent),this.refresh()},refresh:function(){var t=o.get("groups"),e=o.get("permission/elementpermissions");$.when(t,e).then(this.render)},selectedEvent:function(t){var e=_(t).first();if(t.length<2){this.currentRestrictionsView&&this.currentRestrictionsView.remove();var n=e&&r.getType($("#"+e.id)[0]);if(e&&s[n]){var i=$('<div class="group content"></div>');return this.$el.append(i),this.currentRestrictionsView=new s[n]({el:i,selection:e}),this.currentRestrictionsView.on("update",_.bind(this.trigger,this,"update")),this.$el.find(".restrictions-list").addClass("hidden"),void this.$el.find(".element-selected").removeClass("hidden")}}this.refresh()},render:function(t,e){this.groups=t;var n=this.getSingleElementPermissions(e),a=_(t).filter(function(t){return t.permissions});this.$el.html(i({groups:a,has_restrictions:n.length>0,restrictions:n})),this.trigger("update")},getSingleElementPermissions:function(t){var e=[],n=_.map(t,function(t){return{name:"element "+t.element_id.split("_")[1],element:t.element_id}});return _.each(n,function(t){var n=_(e).findWhere({element:t.element}),i=$("#"+t.element).length;!n&&i&&e.push(t)}),e}}),Backbone.Events)},{"../../../facade/editor/editor":45,"../../../facade/restrictions/restrictions":62,"../../../factory/restrictions":75,"./element-restrictions.hbs":275,"./element/background-type":279,"./element/image-type":284,"./element/text-type":286,"./element/vector-type":288}],277:[function(t,e,n){var i=(t("./text-type.hbs"),t("../../../../factory/restrictions"));e.exports=Backbone.mixin(Backbone.View.extend({type:null,events:{"change .restrictions.group > input":"toggleSectionEvent","change .restrictions.group .options input":"toggleRestrictionEvent","change .restrictions.group .options select":"toggleRestrictionEvent"},toggleSectionEvent:function(t){var e=$(t.currentTarget),n=e.closest(".restrictions.group"),a=n.data("name");i.get("permission/elementpermissions").then(_.bind(function(t){var o=_(t).findWhere({group:this.group.id,element_id:this.selection.id}),r=o?JSON.parse(o.restrictions):{};e.is(":checked")?e.siblings(".options").find("input, select").trigger("change"):(r=_(r).omit(a),i.setElementRestriction(this.group.id,this.selection.id,JSON.stringify(r))),this.toggleRestrictionsGroup(n,e.is(":checked"))},this))},toggleRestrictionEvent:function(t){this.persistOptionRestriction($(t.currentTarget))},persistOptionRestriction:function(t){var e=t.closest(".restrictions.group").data("name");i.get("permission/elementpermissions").then(_.bind(function(n){var a=_(n).findWhere({group:this.group.id,element_id:this.selection.id}),o=a?JSON.parse(a.restrictions):{};o[e]=o[e]||{},o[e][t.attr("name")]=this.getOptionValue(t),"undefined"==typeof o[e][t.attr("name")]&&(o[e]=_(o[e]).omit(t.attr("name"))),i.setElementRestriction(this.group.id,this.selection.id,JSON.stringify(o))},this))},getOptionValue:function(t){return t.is('input[type="checkbox"]')?t.is(":checked"):t.is('input[type="text"]')?t.val():t.is('input[type="number"]')?""===t.val()?null:parseFloat(t.val()):t.is("select")?t.val():void 0},initialize:function(t){this.selection=t.selection,_.bindAll(this,"refresh"),this.refresh()},refresh:function(t){$.when(i.get("groups"),i.get("permission/elementpermissions"),i.get("permission/templatepermissions")).then(_.bind(function(e,n,i){this.groups=e,
this.ePermissions=n,this.tPermissions=i,this.render(t)},this))},renderRestrictions:function(t){if(t){this.group=t;var e=_(this.ePermissions).findWhere({group:t.id,element_id:this.selection.id});if(e){var n=JSON.parse(e.restrictions);_.each(this.$el.find(".restrictions.group[data-name]"),_.bind(function(t){var e=$(t).data("name");this._renderRestrictions(n,e),this.toggleRestrictionsGroup($(t),n[e])},this))}else this.renderDefaultRestrictions()}},renderDefaultRestrictions:function(){var t=_(this.tPermissions).findWhere({group:this.group.id}),e={},n=new RegExp("^"+this.type+"_.*");_(t||this.group.permissions.template).each(function(t,i){i.match(n)&&(e[i]=t)}),this._renderRestrictions({basic:e},"basic"),_.each(this.$el.find(".restrictions.group[data-name]"),_.bind(function(t){this.toggleRestrictionsGroup($(t),!1),$(t).children('input[type="checkbox"]').prop("checked",!1)},this))},_renderRestrictions:function(t,e){var n=t[e],i=this.$el.find('.restrictions.group[data-name="'+e+'"]');i.children('input[type="checkbox"]').prop("checked",n),_.each(n,function(t,e){i.find('input[type="checkbox"][name="'+e+'"]').prop("checked",t),i.find('input[type="number"][name="'+e+'"]').val(t),i.find('input[type="text"][name="'+e+'"]').val(t),i.find('select[name="'+e+'"]').val(t)},this)},toggleRestrictionsGroup:function(t,e){if(e&&t.children(".options").length){var n=0;_(t.contents()).each(function(t){1===t.nodeType&&(n+=$(t).outerHeight(!0))}),t.height(n)}else t.height(t.children("label").height());this.trigger("update")}}),Backbone.Events)},{"../../../../factory/restrictions":75,"./text-type.hbs":285}],278:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="wrapper">\n\n  <div class="restrictions group" data-name="opaque">\n    <input type="checkbox" id="element-restrictions-opaque" />\n    <label for="element-restrictions-opaque">Opaque background</label>\n  </div>\n\n  <div class="restrictions group" data-name="colors">\n    <input type="checkbox" id="element-restrictions-colors" />\n    <label for="element-restrictions-colors">Colors list</label>\n    <ul class="options"><li></li></ul>\n  </div>\n\n  <div class="restrictions group" data-name="images">\n    <input type="checkbox" id="element-restrictions-images" />\n    <label for="element-restrictions-images">Images list</label>\n    <ul class="options"><li></li></ul>\n  </div>\n\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],279:[function(t,e,n){var i=t("./abstract-type"),a=t("./background-type.hbs"),o=(t("../../components/thumbnail/color"),t("./element-list/view"));e.exports=i.extend({type:"background",render:function(t){this.$el.html(a()),this.initImagesList(),this.initColorsList(),this.renderRestrictions(t||_(this.groups).find(function(t){return t.permissions&&t.permissions.template}))},initImagesList:function(){this.imagesListView&&this.imagesListView.remove(),this.imagesListView=new o({el:this.$el.find('.restrictions.group[data-name="images"] li'),type:"image",uuid:"image"}),this.imagesListView.on("change",_.bind(this.elementListChange,this,this.imagesListView)),this.imagesListView.on("apply",function(t){DesignFacade.set("background",{source:t})})},initColorsList:function(){this.colorsListView&&this.colorsListView.remove(),this.colorsListView=new o({el:this.$el.find('.restrictions.group[data-name="colors"] li'),type:"color",uuid:"color"}),this.colorsListView.on("change",_.bind(this.elementListChange,this,this.colorsListView)),this.colorsListView.on("apply",function(t){DesignFacade.set("background",{color:t})})},elementListChange:function(t){var e=t.$el.find("input");this.persistOptionRestriction(e),this.toggleRestrictionsGroup(e.closest(".restrictions.group"),!0)},getOptionValue:function(t){return t.is(".element-list")?"image"==t.data("uuid")?this.imagesListView.getData():this.colorsListView.getData():i.prototype.getOptionValue.apply(this,arguments)},_renderRestrictions:function(t,e){"images"==e&&t[e]&&_(t[e].list).each(this.imagesListView.addElement),"colors"==e&&t[e]&&_(t[e].list).each(this.colorsListView.addElement),i.prototype._renderRestrictions.apply(this,arguments)}})},{"../../components/thumbnail/color":193,"./abstract-type":277,"./background-type.hbs":278,"./element-list/view":282}],280:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o=t.lambda,r=t.escapeExpression;return'    <div class="thumbnail color" data-value="'+r(o(e,e))+'" style="background-color: '+r(o(e,e))+'">\n      <span class="remove"><i class="fa fa-times"></i></span>\n    </div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{};return'<div class="thumbnails-wrapper">\n  <input type="hidden" name="list" class="element-list" data-uuid="'+t.escapeExpression((r=null!=(r=n.uuid||(null!=e?e.uuid:e))?r:n.helperMissing,"function"==typeof r?r.call(s,{name:"uuid",hash:{},data:a}):r))+'"/>\n\n'+(null!=(o=n.each.call(s,null!=e?e.data:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+'\n  <div class="addmore add">\n    <i class="icon-plus"></i>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],281:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return"<label>Nothing yet. Drag and Drop images on the image box to add new sources</label>"},3:function(t,e,n,i,a){return"<label>Add more sources by dragging images on the image box</label>"},5:function(t,e,n,i,a){var o=t.lambda,r=t.escapeExpression;return'    <div class="thumbnail image" data-value="'+r(o(e,e))+'" style="background-image: url('+r(o(e,e))+')">\n      <span class="remove"><i class="fa fa-times"></i></span>\n    </div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{};return'<div class="thumbnails-wrapper">\n  <input type="hidden" name="list" class="element-list" data-uuid="'+t.escapeExpression((r=null!=(r=n.uuid||(null!=e?e.uuid:e))?r:n.helperMissing,"function"==typeof r?r.call(s,{name:"uuid",hash:{},data:a}):r))+'"/>\n  '+(null!=(o=n["if"].call(s,null!=e?e.no_data:e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"\n  "+(null!=(o=n["if"].call(s,null!=e?e.show_hint:e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"\n\n"+(null!=(o=n.each.call(s,null!=e?e.data:e,{name:"each",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a}))?o:"")+"</div>\n"},useData:!0})},{"hbsfy/runtime":375}],282:[function(t,e,n){var i={color:t("./colors.hbs"),image:t("./images.hbs")};e.exports=_.extend(Backbone.View.extend({events:{"click .thumbnail":"applyElementEvent","click .remove":"removeElementEvent"},applyElementEvent:function(t){this.trigger("apply",$(t.currentTarget).closest(".thumbnail").data("value"))},removeElementEvent:function(t){var e=$(t.currentTarget).closest(".thumbnail").data("value");this.data=_(this.data).without(e),this.render(),this.trigger("change",this.getData()),t.stopPropagation()},addElement:function(t){this.data.push(t),this.render(),this.trigger("change",this.getData())},initialize:function(t){_.bindAll(this,"render","addElement","getData"),this.uuid=t.uuid,this.type=t.type,this.data=[],this.debouncedRender=_.debounce(this.render,500),this.render()},render:function(){this.$el.html(i[this.type]({uuid:this.uuid,data:this.data,no_data:this.data.length<1,show_hint:1==this.data.length})),"color"===this.type&&this.initColorPicker()},initColorPicker:function(){this.$el.find(".addmore").colorpicker({defaultColor:"#FFF",onSubmit:_.bind(this.addElement,this)})},getData:function(){return _(this.data).clone()}}),Backbone.Events)},{"./colors.hbs":280,"./images.hbs":281}],283:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'        <li>\n          <input type="checkbox" name="'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" id="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" />\n          <label for="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'">'+c((n.t||e&&e.t||s).call(r,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</label>\n        </li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return'<div class="wrapper">\n\n  <div class="restrictions group" data-name="source">\n    <input type="checkbox" id="element-restrictions-source" />\n    <label for="element-restrictions-source">Source list</label>\n    <ul class="options"><li></li></ul>\n  </div>\n\n  <div class="restrictions group" data-name="basic">\n    <input type="checkbox" id="element-restrictions-basic" />\n    <label for="element-restrictions-basic">Basic restrictions</label>\n    <ul class="options">\n'+(null!=(o=n.each.call(null!=e?e:{},null!=e?e.basic:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"    </ul>\n  </div>\n\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],284:[function(t,e,n){var i=t("./image-type.hbs"),a=t("./abstract-type"),o=t("./element-list/view"),r=t("../../../../facade/design/design");e.exports=a.extend({type:"image",toggleSectionEvent:function(t){$(t.currentTarget).is("#element-restrictions-source:checked")&&!this.sourceListView.getData().length&&this.sourceListView.addElement(this.selection.source.url),a.prototype.toggleSectionEvent.apply(this,arguments)},render:function(t){var e=_(this.groups).find(function(t){return t.permissions&&t.permissions.template}),n=_.chain(e.permissions.template).map(function(t,e){return{name:e,tag:"tool.restrictions.template.permission."+e}}).filter(function(t){return t.name.match(/^image_/)}).value();this.$el.html(i({basic:n})),this.initSourceList(),this.renderRestrictions(t||_(this.groups).find(function(t){return t.permissions&&t.permissions.template}))},getOptionValue:function(t){return t.is(".element-list")?this.sourceListView.getData():a.prototype.getOptionValue.apply(this,arguments)},_renderRestrictions:function(t,e){"source"==e&&t[e]&&_(t[e].list).each(this.sourceListView.addElement),a.prototype._renderRestrictions.apply(this,arguments)},initSourceList:function(){this.sourceListView&&this.sourceListView.remove(),this.sourceListView=new o({el:this.$el.find('.restrictions.group[data-name="source"] li'),type:"image"}),this.sourceListView.on("change",_.bind(function(){var t=this.sourceListView.$el.find("input");this.persistOptionRestriction(t),this.toggleRestrictionsGroup(t.closest(".restrictions.group"),!0)},this)),this.sourceListView.on("apply",function(t){r.set({source:{url:t},keep_box_size:!0})})}})},{"../../../../facade/design/design":19,"./abstract-type":277,"./element-list/view":282,"./image-type.hbs":283}],285:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'        <li>\n          <input type="checkbox" name="'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" id="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" />\n          <label for="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'">'+c((n.t||e&&e.t||s).call(r,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</label>\n        </li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o;return'<div class="wrapper">\n\n  <div class="restrictions group" data-name="numeric">\n    <input type="checkbox" id="element-restrictions-numeric" />\n    <label for="element-restrictions-numeric">Numeric content</label>\n    <ul class="options">\n      <div class="clean-margin">\n        <li class="col-half">\n          <input name="min" type="number" placeholder="Minimum">\n        </li><li class="col-half">\n          <input name="max" type="number" placeholder="Maximum">\n        </li>\n      </div>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="dictionary">\n    <input type="checkbox" id="element-restrictions-dictionary" />\n    <label for="element-restrictions-dictionary">Available content</label>\n    <ul class="options">\n      <li>\n        <input class="dictionary" type="text" name="list" placeholder="Add content">\n      </li>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="date">\n    <input type="checkbox" id="element-restrictions-date" />\n    <label for="element-restrictions-date">Date Format</label>\n    <ul class="options">\n      <li>\n        <input name="dateformat" type="text" placeholder="Format">\n      </li>\n      <li>\n        <input name="daterange" type="text" placeholder="Availability - Date Range">\n      </li>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="currencies">\n    <input type="checkbox" id="element-restrictions-currencies" />\n    <label for="element-restrictions-currencies">Currencies</label>\n\n    <ul class="options">\n      <div class="clean-margin">\n        <li class="col-third">\n          <input name="min" type="number" placeholder="Minimum">\n        </li><li class="col-third">\n          <input name="max" type="number" placeholder="Maximum">\n        </li><li class="col-third">\n          <div class="select-wrapper">\n            <select name="currency" class="options">\n              <option value="$">Dollar $</option>\n              <option value="€">Euro €</option>\n            </select>\n          </div>\n        </li>\n      </div>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="mail">\n    <input type="checkbox" id="element-restrictions-mail" />\n    <label for="element-restrictions-mail">Mail Format</label>\n  </div>\n\n  <div class="restrictions group" data-name="insults">\n    <input type="checkbox" id="element-restrictions-insults" />\n    <label for="element-restrictions-insults">Swearing filter</label>\n  </div>\n\n  <div class="restrictions group" data-name="basic">\n    <input type="checkbox" id="element-restrictions-basic" />\n    <label for="element-restrictions-basic">Basic restrictions</label>\n    <ul class="options">\n'+(null!=(o=n.each.call(null!=e?e:{},null!=e?e.basic:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"    </ul>\n  </div>\n\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],286:[function(t,e,n){var i=t("./text-type.hbs"),a=t("./abstract-type");e.exports=a.extend({type:"text",storedDateFormat:"MM/DD/YY",events:_.extend({'change input[name="list"]':"resizeListEvent",'change input[name="dateformat"]':"changeFormatEvent",'apply.daterangepicker input[name="daterange"]':"selectDateRangeEvent",'cancel.daterangepicker input[name="daterange"]':"clearDateRangeEvent"},a.prototype.events),resizeListEvent:function(t){var e=$(t.currentTarget);this.toggleRestrictionsGroup(e.closest(".restrictions.group"),!0)},changeFormatEvent:function(){this.applyDateFormat()},selectDateRangeEvent:function(){this.applyDateFormat().trigger("change")},clearDateRangeEvent:function(){this.$el.find('input[name="daterange"]').val("").trigger("change")},applyDateFormat:function(){var t=this.$el.find('input[name="dateformat"]').val()||this.storedDateFormat,e=this.$el.find('input[name="daterange"]'),n=e.data("daterangepicker"),i=n.endDate.format(t),a=n.startDate.format(t);return n.locale.format=t,e.val(a+" ~ "+i),e},render:function(t){var e=_(this.groups).find(function(t){return t.permissions&&t.permissions.template}),n=_.chain(e.permissions.template).map(function(t,e){return{name:e,tag:"tool.restrictions.template.permission."+e}}).filter(function(t){return t.name.match(/^text_/)}).value();this.$el.html(i({basic:n})),this.initDictionary(),this.initDateFormat(),this.initDateRange(),this.renderRestrictions(t||_(this.groups).find(function(t){return t.permissions&&t.permissions.template}))},initDictionary:function(){var t=this.$el.find('input[name="list"]'),e=t.closest(".restrictions.group");t.tagsinput(),e.children("input").is(":checked")&&this.toggleRestrictionsGroup(e,!0)},initDateFormat:function(){this.$el.find('input[name="dateformat"]').typeahead({highlight:!0,minLength:0,source:["LL","DD-MM-YYYY","DD/MM/YY","MM/DD/YYYY","YYYY-MM-DD","YY-MM-DD"]})},initDateRange:function(){this.$el.find('input[name="daterange"]').daterangepicker({autoUpdateInput:!1})},_renderRestrictions:function(t,e){return"date"===e?this.renderDateRestrictions(t):a.prototype._renderRestrictions.apply(this,arguments)},renderDateRestrictions:function(t){var e=t.date;if(e){var n=this.$el.find('.restrictions.group[data-name="date"]'),i=n.find('input[name="daterange"]').data("daterangepicker");n.children('input[type="checkbox"]').prop("checked",e),n.find('input[name="dateformat"]').val(e.dateformat),e.daterange&&(i.locale.format=this.storedDateFormat,i.setStartDate(e.daterange.start),i.setEndDate(e.daterange.end),this.applyDateFormat())}},toggleRestrictionEvent:function(t){var e=$(t.currentTarget),n=e.attr("name");return!e.is('[type="number"]')||"min"!=n&&"max"!=n||this.isValidRangeNumber(e.closest("ul.options"))?void a.prototype.toggleRestrictionEvent.call(this,t):(alert("Not valid range"),void e.val(""))},getOptionValue:function(t){return t.is('input[name="daterange"]')?t.val()?{end:t.data("daterangepicker").endDate.format(this.storedDateFormat),start:t.data("daterangepicker").startDate.format(this.storedDateFormat)}:null:a.prototype.getOptionValue.apply(this,arguments)},isValidRangeNumber:function(t){var e=t.find('input[name="min"]'),n=t.find('input[name="max"]');return""===n.val()||""===e.val()||parseFloat(n.val())>parseFloat(e.val())}})},{"./abstract-type":277,"./text-type.hbs":285}],287:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'        <li>\n          <input type="checkbox" name="'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" id="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" />\n          <label for="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'">'+c((n.t||e&&e.t||s).call(r,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</label>\n        </li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{};return'<div class="wrapper">\n\n  <div class="restrictions group" data-name="margin">\n    <input type="checkbox" id="element-restrictions-margin" />\n    <label for="element-restrictions-margin">Margin</label>\n    <ul class="options">\n      <li>\n        <div class="slider"></div>\n        <input name="size" value="0" type="number" min="0" max="'+t.escapeExpression((r=null!=(r=n.max_margin||(null!=e?e.max_margin:e))?r:n.helperMissing,"function"==typeof r?r.call(s,{name:"max_margin",hash:{},data:a}):r))+'">\n      </li>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="movement">\n    <input type="checkbox" id="element-restrictions-movement" />\n    <label for="element-restrictions-movement">Limit movement</label>\n    <ul class="options">\n      <li>\n        <input name="horizontal" type="checkbox" id="element-restrictions-horizontal-move" />\n        <label for="element-restrictions-horizontal-move">Horizontal move</label>\n      </li>\n      <li>\n        <input name="vertical" type="checkbox" id="element-restrictions-vertical-move" />\n        <label for="element-restrictions-vertical-move">Vertical move</label>\n      </li>\n    </ul>\n  </div>\n\n  <div class="restrictions group" data-name="lock_text">\n    <input name="enable" type="checkbox" id="element-restrictions-editable-lock-text" />\n    <label for="element-restrictions-editable-lock-text">Lock Text Content</label>\n  </div>\n\n  <div class="restrictions group" data-name="basic">\n    <input type="checkbox" id="element-restrictions-basic" />\n    <label for="element-restrictions-basic">Basic restrictions</label>\n    <ul class="options">\n'+(null!=(o=n.each.call(s,null!=e?e.basic:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"    </ul>\n  </div>\n\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],288:[function(t,e,n){var i=t("./vector-type.hbs"),a=t("./abstract-type");e.exports=a.extend({type:"vector",events:_.extend({"slide .slider":"slideEvent",'change input[name="size"]':"resizeMarginEvent",'change input[name="vertical"]':"verticalMoveEvent",'change input[name="horizontal"]':"horizontalMoveEvent"},a.prototype.events),toggleSectionEvent:function(t){var e=$(t.currentTarget),n=e.closest(".restrictions.group").data("name");e.is(":checked")||("margin"==n?$("#margin-box").remove():"movement"==n&&$("#horizontal-line, #vertical-line").remove()),a.prototype.toggleSectionEvent.apply(this,arguments)},slideEvent:function(t,e){var n=this.$el.find('input[name="size"]');n.val(e.value),this.setMarginUI(e.value),this.persistOptionRestriction(n)},resizeMarginEvent:function(t){var e=$(t.currentTarget),n=parseFloat(e.val());this.marginSlider.slider("value",n),this.setMarginUI(n),this.persistOptionRestriction(e)},setMarginUI:function(t){var e=svgedit.utilities.getBBox($("#selectedBox0")[0]),n=document.createElementNS(svgedit.NS.SVG,"rect");$("#margin-box").remove(),this.canvas.assignAttributes(n,{id:"margin-box",width:e.width+t,height:e.height+t,x:e.x-t/2,y:e.y-t/2,"stroke-width":t,fill:"none","stroke-opacity":.3,stroke:"#ED3636"});var i=$("#selectorGroup0")[0];i.insertBefore(n,i.firstChild)},horizontalMoveEvent:function(t){this.setMoveUI("horizontal",$(t.currentTarget).is(":checked"))},verticalMoveEvent:function(t){this.setMoveUI("vertical",$(t.currentTarget).is(":checked"))},setMoveUI:function(t,e){var n=svgedit.utilities.getBBox($("#selectedBox0")[0]),i=document.createElementNS(svgedit.NS.SVG,"line"),a="vertical"===t;$("#"+t+"-line").remove(),this.canvas.assignAttributes(i,{id:t+"-line",x1:a?n.x+n.width/2:n.x,y1:a?n.y:n.y+n.height/2,x2:a?n.x+n.width/2:n.x+n.width,y2:a?n.y+n.height:n.y+n.height/2,"stroke-width":2,"stroke-dasharray":5,stroke:e?"#01ADB6":"#ED3636"});var o=document.getElementById("selectorGroup0");o.appendChild(i)},initialize:function(){this.canvas=INKIVE.Tool.getInstance().editor.canvas,a.prototype.initialize.apply(this,arguments)},render:function(t){var e=_(this.groups).find(function(t){return t.permissions&&t.permissions.template}),n=_.chain(e.permissions.template).map(function(t,e){return{name:e,tag:"tool.restrictions.template.permission."+e}}).filter(function(t){return t.name.match(/^vector_/)}).value(),a=this.canvas.contentW<this.canvas.contentH?this.canvas.contentW/8:this.canvas.contentH/8;this.$el.html(i({basic:n,max_margin:a})),this.initSlider(a),this.renderRestrictions(t||_(this.groups).find(function(t){return t.permissions&&t.permissions.template}))},_renderRestrictions:function(t,e){"margin"==e&&t.margin&&(this.marginSlider.slider("value",t.margin.size),this.setMarginUI(t.margin.size)),a.prototype._renderRestrictions.apply(this,arguments)},initSlider:function(t){var e=this.$el.find('.restrictions[data-name="margin"] .slider');this.marginSlider=e.slider({max:t,min:0,value:0})}})},{"./abstract-type":277,"./vector-type.hbs":287}],289:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<option value="'+c((o=null!=(o=n.id||(null!=e?e.id:e))?o:s,typeof o===l?o.call(r,{name:"id",hash:{},data:a}):o))+'">'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+"</option>"},3:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing,c="function",u=t.escapeExpression;return'    <dt>\n      <a class="btn btn-accordion '+u((r=null!=(r=n.key||(null!=e?e.key:e))?r:l,typeof r===c?r.call(s,{name:"key",hash:{},data:a}):r))+'" data-key="'+u((r=null!=(r=n.key||(null!=e?e.key:e))?r:l,typeof r===c?r.call(s,{name:"key",hash:{},data:a}):r))+'" data-type="'+u((r=null!=(r=n.type||(null!=e?e.type:e))?r:l,typeof r===c?r.call(s,{name:"type",hash:{},data:a}):r))+'">\n        <i class="fa fa-ellipsis-v main main"></i>\n        <span class="name">'+u((n.t||e&&e.t||l).call(s,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+'</span>\n      </a>\n\n      <ul class="restrictions-list">\n'+(null!=(o=n.each.call(s,null!=e?e.permissions:e,{name:"each",hash:{},fn:t.program(4,a,0),inverse:t.noop,data:a}))?o:"")+"      </ul>\n    </dt>\n"},4:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'          <li>\n            <input type="checkbox" name="'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" id="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'" />\n            <label for="template-restriction-'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+'">'+c((n.t||e&&e.t||s).call(r,null!=e?e.tag:e,{name:"t",hash:{},data:a}))+"</label>\n          </li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{};return'<div class="group">\n  <h4>Template Restrictions</h4>\n  <div class="select-wrapper">\n    <select>\n      '+(null!=(o=n.each.call(r,null!=e?e.groups:e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+'\n    </select>\n  </div>\n\n  <div class="sticky">\n    <i class="fa fa-chain not-applied"></i>\n    <i class="fa fa-chain-broken applied"></i>\n  </div>\n</div>\n\n<div class="wrapper">\n'+(null!=(o=n.each.call(r,null!=e?e.categories:e,{name:"each",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?o:"")+"</div>"},useData:!0})},{"hbsfy/runtime":375}],290:[function(t,e,n){var i=t("./template-restrictions.hbs"),a=t("../../../factory/restrictions");e.exports=Backbone.mixin(Backbone.View.extend({events:{"change select":"changeGroupEvent","click .sticky":"toggleStickyEvent","click dt > a":"categoryToggleEvent","change input":"changePermissionEvent"},categoryToggleEvent:function(t){function e(t){t.removeClass("active").removeAttr("style")}function n(){var t=0;a.contents().each(function(){1===this.nodeType&&(t+=$(this).outerHeight(!0))}),a.addClass("active").height(t),a.siblings(".active").each(function(){e($(this))})}var i=$(t.currentTarget),a=i.closest("dt"),o=a.hasClass("active");o&&e(a),o||n(),this.trigger("update")},toggleStickyEvent:function(t){var e=$(t.currentTarget),n=this.$el.find("select").val(),i=!e.is(".active"),o=this.getGroup(n);i?a.setTemplateRestriction(n,"sticky",i).then(_.partial(this.renderSticky,o)):a.get("permission/templatepermissions").then(_.bind(function(t){t=_(t).find(function(t){return t.group==o.id});var e=t&&!this.isEqualPermissions(o.permissions.template,t);return e?void INKIVE.Modal.alertMessage("Sure you want to make this group restrictions like defaults?",{width:450,callback:[_.bind(function(){a.remove("permission/templatepermissions",t.id),this.renderRestrictions(o),this.renderSticky(o)},this),$.noop]}):(t&&a.remove("permission/templatepermissions",t.id),void this.renderSticky(o))},this))},changeGroupEvent:function(t){var e=this.getGroup($(t.currentTarget).val());e&&this.renderRestrictions(e),this.renderSticky(e)},changePermissionEvent:function(t){var e=this.$el.find("select").val(),n=$(t.currentTarget);a.setTemplateRestriction(e,n.attr("name"),n.is(":checked")).then(_.partial(this.renderSticky,this.getGroup(e)))},initialize:function(){_.bindAll(this,"processGroups","renderSticky"),a.get("groups").then(this.processGroups)},getGroup:function(t){return _(this.groups).find(function(e){return e.id==t})},isEqualPermissions:function(t,e){return _.chain(t).omit("id","sticky","static").all(function(t,n){return t==e[n]}).value()},processGroups:function(t){var e=[];this.groups=t;var n=_(this.groups).find(function(t){return t.permissions&&t.permissions.template});n&&_.each(["function","element","text","image","vector"],function(t){var i=new RegExp("^"+t+"_.*"),a=_.chain(n.permissions.template).map(function(t,e){return{name:e,tag:"tool.restrictions.template.permission."+e}}).filter(function(t){return t.name.match(i)}).value();e.push({key:t,tag:"tool.restrictions.template.categories."+t,permissions:a})}),this.render(e)},render:function(t){var e=_(this.groups).filter(function(t){return t.permissions});this.$el.html(i({groups:e,categories:t})),this.renderRestrictions(e[0]),this.renderSticky(e[0]),this.trigger("update")},renderRestrictions:function(t){a.get("permission/templatepermissions").then(_.bind(function(e){e=_(e).find(function(e){return e.group==t.id})||t.permissions.template,_.each(e,function(t,e){this.$el.find('input[name="'+e+'"]').prop("checked",t)},this)},this))},renderSticky:function(t){t&&a.get("permission/templatepermissions").then(_.bind(function(e){e=_(e).find(function(e){return e.group==t.id});var n=e?e.sticky||!this.isEqualPermissions(t.permissions.template,e):!1;this.$el.find(".sticky").toggleClass("active",n)},this))}}),Backbone.Events)},{"../../../factory/restrictions":75,"./template-restrictions.hbs":289}],291:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <div class="accordion tab-content restrictions active sub-category">\n      <div class="notifications"></div>\n      <div class="element-restrictions"></div>\n      <div class="template-restrictions"></div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],292:[function(t,e,n){var i=t("./template.hbs"),a=t("../components/mixins/scrollable"),o=t("../../../facade/editor/editor"),r=t("./element-restrictions"),s=t("./template-restrictions");e.exports=Backbone.mixin(Backbone.View.extend({initialize:function(){_.bindAll(this,"selectedEvent","onInnerViewUpdate"),this.scrollRefresh=_.debounce(_.bind(this.initScroll,this),1e3)},show:function(){var t=this.$el.find(".tab-content.text").length;t||this.render()},render:function(){this.$el.html(i()),INKIVE.Modal.loader(this.$el.find(".tab-content")),this.initElementRestrictions(),this.initTemplateRestrictions(),o.on("select",this.selectedEvent)},initTemplateRestrictions:function(){this.templateRestrictionsView=new s({el:this.$el.find(".template-restrictions")}),this.templateRestrictionsView.on("update",this.onInnerViewUpdate)},initElementRestrictions:function(){this.elementRestrictionsView=new r({el:this.$el.find(".element-restrictions")}),this.elementRestrictionsView.on("update",this.onInnerViewUpdate)},selectedEvent:function(t){this.$el.find(".template-restrictions").toggleClass("hidden",1===t.length)},onInnerViewUpdate:function(){INKIVE.Modal.loaderClose(this.$el.find(".tab-content")),this.scrollRefresh()}}),a)},{"../../../facade/editor/editor":45,"../components/mixins/scrollable":178,"./element-restrictions":276,"./template-restrictions":290,"./template.hbs":291}],293:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | settings",show:{eventAction:"show"},lockEvent:function(){this.trackEvent({eventAction:"lock",eventLabel:!this.globalLock})},autoSaveEvent:function(){this.trackEvent({eventAction:"auto_save",eventLabel:!INKIVE.C.IS_AUTO_SAVE})}}},{}],294:[function(t,e,n){var i=t("../../../analytics/decorate");e.exports=i(t("./analytics/view"),Backbone.View.extend({events:{"click a.btn.autosave":"autoSaveEvent","click a.btn.lock":"lockEvent"},autoSaveEvent:function(){INKIVE.C.IS_AUTO_SAVE=!INKIVE.C.IS_AUTO_SAVE,localStorage.setItem("autosave",INKIVE.C.IS_AUTO_SAVE),INKIVE.Tool.autoSave(),this.toggle()},lockEvent:function(){var t=this.globalLock=!this.globalLock;localStorage.setItem("lock_elements",t),$("#svgcontent .element").each(function(){
$(this).toggleClass("locked",t)});var e=svgedit.select.getSelectorManager();e.releaseAllSelectors(),this.toggle()},initialize:function(){_.bindAll(this,"toggle"),INKIVE.C.IS_AUTO_SAVE="false"!==localStorage.getItem("autosave"),this.globalLock="true"===localStorage.getItem("lock_elements")},toggle:function(){var t=this.$el.find("a.btn.autosave");t.find("i.check").toggleClass("hidden",!INKIVE.C.IS_AUTO_SAVE),t.find("i.uncheck").toggleClass("hidden",INKIVE.C.IS_AUTO_SAVE),t=this.$el.find("a.btn.lock"),t.find("i.check").toggleClass("hidden",!this.globalLock),t.find("i.uncheck").toggleClass("hidden",this.globalLock)},show:function(){this.toggle()}}))},{"../../../analytics/decorate":4,"./analytics/view":293}],295:[function(t,e,n){var i=t("../../../../factory/formats");e.exports={eventCategory:"Editor UI | Tool Menu | templates",thumbnailClickEvent:function(t){var e=$(t.currentTarget);i.getFormat(e.data("key")).then(_.bind(function(t){this.trackEvent({eventAction:"show_format",eventLabel:t.string_id+" "+t.id})},this))}}},{"../../../../factory/formats":65}],296:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | templates",show:{eventAction:"show"},listContentToggleEvent:function(t){var e=$(t.currentTarget),n=e.closest("dt");n.hasClass("active")||this.trackEvent({eventAction:"content_toggle",eventLabel:e.data("key")})}}},{}],297:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){return'<div class="antiscroll-wrap">\n  <div class="antiscroll-inner">\n    <ul class="thumbnail-wrapper"></ul>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],298:[function(t,e,n){var i=t("../components/accordion-list/content"),a=t("../../../factory/formats"),o=t("../components/thumbnail/designed"),r=t("../../../analytics/decorate");e.exports=r(t("./analytics/sub-categories"),i.extend({views:{},template:t("./content.hbs"),TemplatesView:t("./templates"),events:{"click .thumbnail-wrapper .thumbnail":"thumbnailClickEvent"},thumbnailClickEvent:function(t){var e=$(t.currentTarget);a.getFormat(e.data("key")).then(_.bind(function(t){this.openNewView(e.data("key"),this.TemplatesView,{format:t})},this))},initialize:function(t){_.bindAll(this,"render","initScroll","thumbnailClickEvent"),this.tool=INKIVE.Tool.getInstance(),a.getGroup(t.key).then(this.render)},render:function(t){this.$el.html(this.template()),this.appendThumbnails(t.data),_.delay(this.initScroll,1e3)},appendThumbnails:function(t){var e=20,n=this.$el.width()-e,i=this.$el.find(".thumbnail-wrapper");_.each(t,function(t){var e=$("<li>").addClass("thumbnail image loading dark").data("key",t.id).appendTo(i);new o({el:e,width:n,format:t})})}}))},{"../../../analytics/decorate":4,"../../../factory/formats":65,"../components/accordion-list/content":170,"../components/thumbnail/designed":196,"./analytics/sub-categories":295,"./content.hbs":297,"./templates":300}],299:[function(t,e,n){var i=t("../components/accordion-list/content"),a=t("../components/thumbnail/designed");e.exports=i.extend({apiCall:"search/layouts",template:t("./content.hbs"),columnWidth:INKIVE.C.IS_MOBILE?210:275,initialize:function(t){this.format=t.format,this.formats=t.formats,i.prototype.initialize.call(this)},getParams:function(){var t={from:this.from,limit:this.limit,where:{format:this.format?this.format.id:_.pluck(this.formats,"id"),active:INKIVE.C.USER.IS_SUPER?0:1}};return this.from+=this.limit,t},render:function(){this.$el.html(this.template()),this.format&&this.$el.data("key",this.format.string_id)},appendThumbnails:function(t){var e=this.$el.find(".thumbnail-wrapper .scrollDetect");_.each(t,function(t){var n=$("<li>").addClass("thumbnail image loading").data("key",t.id).insertBefore(e);new a({el:n,width:this.columnWidth,design:t,isCustomFormat:this.isCustomFormat})},this)}})},{"../components/accordion-list/content":170,"../components/thumbnail/designed":196,"./content.hbs":297}],300:[function(t,e,n){var i=t("./templates-base"),a=t("../../../factory/formats"),o=t("../components/thumbnail/grid");e.exports=i.extend({initialize:function(t){this.tool=INKIVE.Tool.getInstance(),this.canvas=this.tool.editor.canvas,this.getFormat(t).then(_.bind(function(e){t.format=e,i.prototype.initialize.call(this,t)},this))},getFormat:function(t){function e(t){function e(t){var e=INKIVE.Helpers.convertUnitsToPixels(t.width,t.unit),n=INKIVE.Helpers.convertUnitsToPixels(t.height,t.unit);return _.extend(t,{width:e,height:n,ratio:e/n})}var n,i=1/0,a=1/0,o=this.canvas.contentW,r=this.canvas.contentH,s=o/r;return _.each(t,function(t){var l,c=e(t),u=Math.abs(s-c.ratio);a>u&&(l=Math.abs(o-c.width)+Math.abs(r-c.height),i>l&&(n=t,i=l,a=u))}),n}var n=$.Deferred(),i=_.bind(e,this);return t.format&&n.resolve(t.format),t.format||(this.isCustomFormat=!0,a.getFormats().then(function(t){n.resolve(i(t))})),n.promise()},initDataLoading:function(){this.loadDataType="default",i.prototype.initDataLoading.call(this)},loadData:function(t,e){var n=_.partial(this.onMoreData,this.filterActionId),i="default"===this.loadDataType;this.end=e,this.repeat=t,INKIVE.Modal.loader(this.$el.find(".antiscroll-inner")),i&&INKIVE.Helpers.api(this.apiCall,"GET",this.getParams(),n),i||INKIVE.Helpers.sendCmd(INKIVE.C.BASE_URL+"grid/fetch",this.getParams(),n)},getParams:function(){return"default"!==this.loadDataType?_.extend({number_of_photos:++this.numberOfPhotos},this.size):i.prototype.getParams.call(this)},onMoreData:function(t,e){if(t===this.filterActionId){var n="default"===this.loadDataType;e=n?e:JSON.parse(e);var i=n?e.data.length>0:"SUCCESS"===e.STATUS;i?(n&&this.appendThumbnails(e.data),n||this.appendGridThumbnails(e.MESSAGE),this.repeat()):"default"===this.loadDataType?(this.numberOfPhotos=0,this.loadDataType="grid",this.from=0,this.setGridTemplateFormat(),this.repeat()):(this.end(),INKIVE.Modal.loaderClose(this.$el.find(".antiscroll-inner"))),this.scrollRefresh()}},setGridTemplateFormat:function(){var t=INKIVE.Helpers.convertUnitsToPixels,e=this.$el.find(".thumbnail-wrapper .thumbnail ").first(),n=e.width()||this.columnWidth,i=this.tool.editor.canvas;this.callFormat=this.isCustomFormat?{width:i.contentW,height:i.contentH}:{width:t(this.format.width,this.format.unit),height:t(this.format.height,this.format.unit)},this.size={width:n,height:n*(this.callFormat.height/this.callFormat.width)}},appendGridThumbnails:function(t){var e=this.$el.find(".thumbnail-wrapper .scrollDetect");e.height();_.each(t,function(t){var n=$("<li>").addClass("thumbnail grid").insertBefore(e);new o({el:n,size:this.size,format:this.callFormat,data:t,numberOfPhotos:this.numberOfPhotos})},this)}})},{"../../../factory/formats":65,"../components/thumbnail/grid":197,"./templates-base":299}],301:[function(t,e,n){var i=t("../components/accordion-list/categories-director"),a=t("../../../factory/formats"),o=t("./sub-categories");e.exports=i.extend({"class":"sub-category template",CategoriesView:o,initialize:function(){i.prototype.initialize.call(this),this.tool=INKIVE.Tool.getInstance()},loadListContent:function(t){i.prototype.loadListContent.call(this,t),this.format&&_.delay(_.bind(function(){_.each(this.$el.find(".thumbnail"),function(t){$(t).data("key")==this.format.id&&$(t).trigger("click")},this),this.format=null},this),600)},loadButtons:function(){var t=$.Deferred();return a.getGroups().then(function(e){t.resolve(_.map(e,function(t){return{key:t.key,tag:t.name,icon:"fa fa-ellipsis-v"}}))}),t.promise()},closeAccordion:function(){var t=this.$el.find("dt");_.each(this.views,function(e,n){t.find('a[data-key="'+n+'"] .category').remove()}),i.prototype.closeAccordion.call(this)},_render:function(t){INKIVE.Modal.loaderClose(this.$el),this.$el.html(this.template({"class":this["class"],buttons:t,add_button:this.addButtonText}))},getCategoryName:function(t){return t.format.name}})},{"../../../factory/formats":65,"../components/accordion-list/categories-director":168,"./sub-categories":298}],302:[function(t,e,n){var i=t("./view-base"),a=t("../components/accordion-list/director"),o=t("../../../factory/formats"),r=t("../../../facade/design/design"),s=t("../../../facade/editor/editor"),l=t("./sub-categories"),c=t("../../../analytics/decorate");e.exports=c(t("./analytics/view"),i.extend({"class":"sub-category template",CategoriesView:l,views:{},Views:{custom:t("./templates")},loadListContent:function(t){var e="custom"==t;e||i.prototype.loadListContent.call(this,t),e&&a.prototype.loadListContent.call(this,t)},initialize:function(){_.bindAll(this,"refresh","goToFormat","goToCustom"),i.prototype.initialize.call(this),this.debouncedRefresh=_.debounce(this.refresh,600),s.on("page.move_to",this.debouncedRefresh),r.on("template.update.size",this.debouncedRefresh)},refresh:function(){var t=this.$el.find(".tab-content."+this["class"]).length;t&&o.getCurrentFormat().then(_.bind(function(t){var e=this.$el.find("dt.active .image-list:not(.out)").data("key");t&&e===t.string_id||(_.each(this.views,function(t){for(;!t.closeView(););t.remove()}),this.views={},this.render())},this))},render:function(){INKIVE.Modal.loader(this.$el),o.getCurrentFormat().then(_.bind(function(t){var e=this.$el.is(".tab.active")||this.$el.closest(".tab-content").is(".active");this.format=t,i.prototype.render.call(this),this.updateCustomFormatCategory(),e&&(this.format&&_.defer(this.goToFormat),this.format||_.defer(this.goToCustom))},this))},goToFormat:function(){var t=this.format;o.getGroups().then(_.bind(function(e){var n=_.find(e,function(e){return _.findWhere(e.data,{id:t.id})});this.$el.find('dt > a.btn[data-key="'+n.key+'"]').trigger("click")},this))},goToCustom:function(){this.$el.find('dt > a.btn[data-key="custom"]').trigger("click")},loadButtons:function(){var t=$.Deferred();return o.getGroups().then(function(e){var n=_.map(e,function(t){return{key:t.key,tag:t.name,icon:"fa fa-ellipsis-v"}}),i="Custom";n.push({key:"custom",tag:i,icon:"fa fa-ellipsis-v"}),t.resolve(n)}),t.promise()},updateCustomFormatCategory:function(){this.format&&this.$el.find('dt > a.btn[data-key="custom"]').hide(),this.format||this.$el.find('dt > a.btn[data-key="custom"]').show()}}))},{"../../../analytics/decorate":4,"../../../facade/design/design":19,"../../../facade/editor/editor":45,"../../../factory/formats":65,"../components/accordion-list/director":172,"./analytics/view":296,"./sub-categories":298,"./templates":300,"./view-base":301}],303:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | text banners",loadData:{eventAction:"load_more"}}},{}],304:[function(t,e,n){e.exports={eventCategory:"Editor UI | Tool Menu | text",show:{eventAction:"show"}}},{}],305:[function(t,e,n){var i=t("../components/accordion-list/content"),a=t("../../../analytics/decorate"),o=t("../components/thumbnail/text-banner");e.exports=a(t("./analytics/banners"),i.extend({apiCall:"search/stickers",callbackName:"callbackStickers",initialize:function(){INKIVE.C.IS_MOBILE&&this.show(),this.debouncedMasonryReload=_.debounce(_.bind(this.masonryReload,this),800)},show:function(){this.isAlreadyThere||i.prototype.initialize.call(this),this.isAlreadyThere=!0},render:function(){i.prototype.render.call(this),this.$el.find(".thumbnailWrapper").masonry()},getParams:function(){var t={from:this.from,limit:this.limit,where:{active:INKIVE.C.USER.IS_SUPER?0:1,isText:1}};return this.from+=this.limit,t},getScrollHeight:function(t){var e=t.closest(".tab-content"),n=e.height(),i=e.children(".text").outerHeight(!0),a=e.children(".margin").outerHeight(!0);return n-i-a},appendThumbnails:function(t){var e=this.$el.find(".thumbnailWrapper"),n=e.find(".scrollDetect");_.each(t,function(t){if(t.url){var i=$("<div>").addClass("thumbnail svg").data("key",t.id).insertBefore(n),a=new o({el:i,svg:t});e.masonry("appended",i),a.on("resize",this.debouncedMasonryReload)}},this)}}))},{"../../../analytics/decorate":4,"../components/accordion-list/content":170,"../components/thumbnail/text-banner":213,"./analytics/banners":303}],306:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){return'  <div class="margin"><span class="shadow"></span></div>\n  <div class="banners"></div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s,l='<div class="tab-content text accordion active">\n  <div class="text">\n    <div class="thumbnail-wrapper"></div>\n  </div>\n\n';return r=null!=(r=n.contains_text_banners||(null!=e?e.contains_text_banners:e))?r:n.helperMissing,s={name:"contains_text_banners",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a},o="function"==typeof r?r.call(null!=e?e:{},s):r,n.contains_text_banners||(o=n.blockHelperMissing.call(e,o,s)),null!=o&&(l+=o),l+"</div>\n"},useData:!0})},{"hbsfy/runtime":375}],307:[function(t,e,n){var i=t("./template.hbs"),a=t("./banners"),o=t("../components/thumbnail/text"),r=t("../../../utils/humps"),s=t("../../../analytics/decorate");e.exports=s(t("./analytics/view"),Backbone.View.extend({initialize:function(){INKIVE.C.IS_MOBILE&&INKIVE.TranslateHelper.load().then(_.bind(this.show,this))},show:function(){var t=this.$el.find(".tab-content.text").length;t||this.render()},render:function(){var t=!INKIVE.C.IS_MOBILE,e=i({contains_text_banners:t});this.$el.html(e),this.renderDefaultText(),_.delay(_.bind(this.initDefaultText,this),1e3),t&&this.initBannersView()},renderDefaultText:function(){var t=this.$el.find(".text .thumbnail-wrapper");this.defaultTextViews=_.map(INKIVE.C.TextDefault,function(e,n){var i=$("<div>").addClass("thumbnail").appendTo(t),a=localStorage.getItem("default_text_"+n);return new o({el:i,data:_.extend({},r.decamelizeKeys(e),JSON.parse(a))})},this)},initDefaultText:function(){function t(){_.each(n,function(t){t.type().then(function(){t.$el.find("a.toggle-options").addClass("show"),t.endTyping()})})}function e(){_.each(n,function(t){var e=_.bind(this.textChangeEvent,this,t);t.on("change",e)},this)}var n=this.defaultTextViews,i=_.last(this.defaultTextViews),a=INKIVE.TranslateHelper.translate("tool.text.click"),o=!localStorage.getItem("text_hint");localStorage.setItem("text_hint",!0),e.call(this),o||t(),o&&i.type(a).then(function(){i.erase().then(t)})},textChangeEvent:function(t){var e=t.getTextData("_"),n=_.findIndex(this.defaultTextViews,t);localStorage.setItem("default_text_"+n,JSON.stringify(e))},initBannersView:function(){var t=$("<div></div>").addClass("image-list");this.$el.find(".tab-content > .banners").append(t),this.bannersView=new a({el:t}),this.bannersView.show()}}))},{"../../../analytics/decorate":4,"../../../utils/humps":323,"../components/thumbnail/text":214,"./analytics/view":304,"./banners":305,"./template.hbs":306}],308:[function(t,e,n){e.exports={eventCategory:"Editor UI | Top Menu",eventAction:"share",shareProjectByEmbedEvent:{eventLabel:"project_embed"},shareProjectByEmailEvent:{eventLabel:"project_email"},shareDesignEvent:function(t){var e=$(t.currentTarget).attr("class");this.trackEvent({eventLabel:"design_"+e})},shareProjectEvent:function(t){var e=$(t.currentTarget).attr("class");this.trackEvent({eventLabel:"project_"+e})},changeTabEvent:function(t){var e=$(t.currentTarget),n=e.data("target");this.trackEvent({eventLabel:"show_"+n+"_tab"})}}},{}],309:[function(t,e,n){e.exports={eventCategory:"Editor UI | Top Menu",saveEvent:{eventAction:"save"},shareEvent:{eventAction:"share",eventLabel:"show"},downloadEvent:{eventAction:"download",eventLabel:"show"},printEvent:{eventAction:"print"},closeEvent:{eventAction:"close"},redoEvent:function(t){var e=this.editor.canvas.undoMgr.getStackInfo();this.trackEvent({eventAction:"redo",eventLabel:e.type})},undoEvent:function(t){var e=this.editor.canvas.undoMgr.getStackInfo(-1);this.trackEvent({eventAction:"undo",eventLabel:e.type})}}},{}],310:[function(t,e,n){function i(t,e,n){INKIVE.Modal.togglePageLoader(!0),n&&o(e,_.findWhere(t,{id:n})),n||FB.api("/me/albums",function(t){t&&!t.error?_.any(t.data,function(t){return t.name===u?(r(e,t.id),!0):void 0})||a():s()})}function a(){var t={name:u,message:INKIVE.TranslateHelper.translate("top_submenu.share.album_title")};FB.api("/me/albums","post",t,function(t){r(t.id)})}function o(t,e){var n={message:t,url:c,access_token:e.access_token};FB.api("/"+e.id+"/photos","post",n,function(t){!t||t.error?s():(l.call("advice.show","share-success"),INKIVE.Modal.togglePageLoader(!1))})}function r(t,e){var n={message:t,url:c};FB.api("/"+e+"/photos","post",n,function(t){!t||t.error?s():(l.call("advice.show","share-success"),INKIVE.Modal.togglePageLoader(!1))})}function s(){l.call("advice.show","share-error"),INKIVE.Modal.togglePageLoader(!1)}var l,c,u="Desygner",h=t("./modal.hbs");e.exports=function(t){function e(t){return _.contains(t.perms,"CREATE_CONTENT")}FB.login(function(n){n.authResponse||s(),n.authResponse&&FB.api("/me/accounts",function(n){var a=_.map(_.filter(n.data,e),function(t){var e=INKIVE.TranslateHelper.translate("modal.share_design.facebook_options.page",{page_name:t.name});return{value:t.id,name:e}});a.unshift({name:INKIVE.TranslateHelper.translate("modal.share_design.facebook_options.timeline")}),c=t,l=INKIVE.Tool.getInstance().editor.canvas;var o=h({default_text:"modal.share_design.default_facebook",options:a.length>1&&a}),r=INKIVE.Modal.modalWindow(o,{width:500,headerIcon:"fa fa-facebook",headerTitle:"modal.title.share_facebook",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.share"),onClick:function(){i(n.data,$(r.getWrapper).find('[name="share-text"]').val(),$(r.getWrapper).find('select[name="share-option"]').val()),r.close()}}]})})},{scope:"publish_actions, user_photos, manage_pages, publish_pages"})}},{"./modal.hbs":312}],311:[function(t,e,n){e.exports=function(t){window.open("https://plus.google.com/share?url=?url="+encodeURI(t),"_blank","top=0,right=0,width=750,height=320")}},{}],312:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({1:function(t,e,n,i,a){var o;return'    <select name="share-option">\n      '+(null!=(o=n.each.call(null!=e?e:{},null!=e?e.options:e,{name:"each",hash:{},fn:t.program(2,a,0),inverse:t.noop,data:a}))?o:"")+"\n    </select>\n"},2:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l="function",c=t.escapeExpression;return'<option value="'+c((o=null!=(o=n.value||(null!=e?e.value:e))?o:s,typeof o===l?o.call(r,{name:"value",hash:{},data:a}):o))+'">'+c((o=null!=(o=n.name||(null!=e?e.name:e))?o:s,typeof o===l?o.call(r,{name:"name",hash:{},data:a}):o))+"</option>"},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r=null!=e?e:{},s=n.helperMissing,l=t.escapeExpression;return'<div class="tool-content">\n  <section>\n    <label for="share-text">'+l((n.t||e&&e.t||s).call(r,"modal.share_design.message_label",{name:"t",hash:{},data:a}))+'</label>\n    <textarea name="share-text" class="form-control" placeholder="'+l((n.t||e&&e.t||s).call(r,"modal.share_design.message_placeholder",{name:"t",hash:{},data:a}))+'">'+l((n.t||e&&e.t||s).call(r,null!=e?e.default_text:e,{name:"t",hash:{},data:a}))+"</textarea>\n"+(null!=(o=n["if"].call(r,null!=e?e.options:e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?o:"")+"  </section>\n</div>\n"},useData:!0})},{"hbsfy/runtime":375}],313:[function(t,e,n){e.exports=function(t){window.open("//www.pinterest.com/pin/create/button/?url="+encodeURI(INKIVE.C.BASE_URL)+"&media="+encodeURI(t)+"&description="+Base64.decode(INKIVE.C.BOOK.name),"_blank","top=0,right=0,width=750,height=320")}},{}],314:[function(t,e,n){var i=t("hbsfy/runtime");e.exports=i.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,a){var o,r,s=null!=e?e:{},l=n.helperMissing,c=t.escapeExpression,u="function";return'<div class="tabs ui-widget">\n    <ul class="ui-tabs-nav">\n        <li class="ui-state-default ui-tabs-active ui-state-active" style="width: 45%;" data-target="shr-design">\n            <a href="#"><i class="icon-filter"></i><span>This Design</span></a>\n        </li>\n\n        <li class="ui-state-default" style="width: 45%;" data-target="shr-project">\n            <a href="#"><i class="icon-photo_library"></i><span>The Project</span></a>\n        </li>\n    </ul>\n\n  <div class="ui-tabs-panel shr-project hidden">\n    <h3>'+(null!=(o=(n.t||e&&e.t||l).call(s,"top_submenu.share.share_project",null!=e?e.project_name:e,{name:"t",hash:{},data:a}))?o:"")+'</h3>\n\n    <section>\n      <div class="buttons row">\n        <a class="facebook"><i class="fa fa-facebook"></i></a>\n        <a class="linkedin"><i class="icon-lin"></i></a>\n        <a class="twitter"><i class="icon-twr"></i></a>\n        <a class="google"><i class="icon-gp"></i></a>\n        <a class="email"><i class="fa fa-envelope"></i></a>\n        <a class="embed"><i class="icon-code"></i></a>\n      </div>\n\n      <div class="link row">\n        <span class="link-label">'+c((n.t||e&&e.t||l).call(s,"top_submenu.share.project_link",{name:"t",hash:{},data:a}))+'</span>\n        <input type="text" class="project-link" value="'+c((r=null!=(r=n.view_link||(null!=e?e.view_link:e))?r:l,typeof r===u?r.call(s,{name:"view_link",hash:{},data:a}):r))+'" />\n      </div>\n    </section>\n  </div>\n\n  <div class="ui-tabs-panel shr-design">\n    <h3>'+c((n.t||e&&e.t||l).call(s,"top_submenu.share.share_design",{name:"t",hash:{},data:a}))+'</h3>\n\n    <div class="image-container"><img/></div>\n\n    <section>\n      <div class="buttons row">\n        <a class="facebook"><i class="fa fa-facebook"></i></a>\n        <a class="twitter"><i class="icon-twr"></i></a>\n        <a class="pinterest"><i class="fa fa-pinterest"></i></a>\n        <a class="google"><i class="icon-gp"></i></a>\n      </div>\n\n      <div class="link row">\n        <span class="link-label">'+c((n.t||e&&e.t||l).call(s,"top_submenu.share.design_link",{name:"t",hash:{},data:a}))+'</span>\n        <input type="text" class="design-link" value="'+c((r=null!=(r=n.image_link||(null!=e?e.image_link:e))?r:l,typeof r===u?r.call(s,{name:"image_link",hash:{},data:a}):r))+'" />\n      </div>\n    </section>\n  </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":375}],315:[function(t,e,n){function i(){window.open(INKIVE.C.BASE_URL+"share/uploadtosocialnetwork?project_id="+INKIVE.C.BOOK.id+"&design_number="+INKIVE.Tool._current_page_id+"&text="+encodeURIComponent(a)+"&social_network=twitter","_blank","top=0,right=0,width=750,height=320")}var a,o=t("./modal.hbs");e.exports=function(t){var e=o({default_text:"modal.share_design.default_twitter"}),n=INKIVE.Modal.modalWindow(e,{width:500,headerIcon:"fa fa-twitter",headerTitle:"modal.title.share_twitter",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.share"),onClick:function(){a=$(n.getWrapper).find('[name="share-text"]').val(),n.close(),i()}}]})}},{"./modal.hbs":312}],316:[function(t,e,n){var i=t("./template.hbs"),a=t("../../../../utils/md5"),o=t("../../../../factory/settings"),r=t("../../../editor-mode-manager"),s=t("../../../../analytics/decorate"),l=t("../../../../factory/page-thumbnail"),c={twitter:t("./twitter"),facebook:t("./facebook"),pinterest:t("./pinterest"),google:t("./google-plus")};e.exports=s(t("../../analytics/share"),Backbone.View.extend({events:{"click input[type=text]":"selectEvent","click ul.ui-tabs-nav li":"changeTabEvent","click .shr-design .buttons > a":"shareDesignEvent","click .shr-project .buttons > a.embed":"shareProjectByEmbedEvent","click .shr-project .buttons > a.email":"shareProjectByEmailEvent","click .shr-project .buttons > a:not(.email):not(.embed)":"shareProjectEvent"},selectEvent:function(t){$(t.currentTarget).select()},changeTabEvent:function(t){var e=$(t.currentTarget),n=e.siblings("li"),i=e.data("target");n.removeClass("ui-tabs-active ui-state-active"),e.addClass("ui-tabs-active ui-state-active"),this.$el.find(".ui-tabs-panel."+i).removeClass("hidden").siblings(".ui-tabs-panel").addClass("hidden")},shareDesignEvent:function(t){var e=$(t.currentTarget).attr("class");c[e](this.link),this.trackShare({content_format:"design",network:e})},shareProjectEvent:function(t){var e=$(t.currentTarget),n=INKIVE.Helpers.getShareNetworkUrl(e.attr("class")),i=$(t.currentTarget).attr("class");this.makePublic(function(){var t=window.open(n,"Share","height=500,width=500,location=0");window.focus&&t.focus()}),this.trackShare({content_format:"project",network:i,link:n})},trackShare:function(t){t=$.extend({project_id:INKIVE.C.BOOK.id,design_number:INKIVE.Tool._current_page_id},t),$.api(INKIVE.C.BASE_URL+"inkive/trackShare","POST",t,function(e){INKIVE.C.IS_DEV&&console.log(t,e)})},shareProjectByEmbedEvent:function(t){var e=new INKIVE.ModalShareEmbed({}),n=INKIVE.Modal.modalWindow(e.getFormHtml(),{width:600,headerIcon:"icon-code",headerTitle:"modal.title.embed",buttons:[{title:INKIVE.TranslateHelper.translate("common.close"),onClick:function(){this.makePublic(function(){e.saveForm(function(){n.close()})})}}]})},shareProjectByEmailEvent:function(t){var e=this,n=new INKIVE.ModalShareEmail,i=INKIVE.Modal.modalWindow(n.getFormHtml(),{width:500,headerIcon:"icon-mail-forward",headerTitle:"modal.title.share_email",buttons:[{title:INKIVE.TranslateHelper.translate("modal.buttons.send"),onClick:function(){e.makePublic(function(){n.saveForm(function(){i.close()})})}}]})},initialize:function(){_.bindAll(this,"makePublic"),this.tool=INKIVE.Tool.getInstance()},makePublic:function(t){function e(){t(),INKIVE.Modal.togglePageLoader(!1)}var n=90==INKIVE.C.BOOK.security;n?t():(e=_.after(2,e),_.delay(e,3e3),INKIVE.Modal.togglePageLoader(!0,"modal.wait_public"),o.set({security:90}).then(e))},show:function(){var t=!this.$el.is(":empty");t||this.render(),this.thumbnailRefresh(),this.$el.find('ul.ui-tabs-nav [data-target="shr-project"]').toggle(!r.isMode("logo"))},render:function(){this.linkRefresh(),this.$el.html(i({project_name:Base64.decode(INKIVE.C.BOOK.name),view_link:INKIVE.C.VIEWER_URL,image_link:this.link}))},linkRefresh:function(){this.link=INKIVE.C.BASE_URL+"design/displaypage/"+INKIVE.C.BOOK.id+"/"+INKIVE.Tool._current_page_id+"/"+a(INKIVE.Tool._current_page_id)+"/1754"},thumbnailRefresh:function(){var t=this.tool.editor.canvas.contentW/this.tool.editor.canvas.contentH,e=this.$el.find(".image-container img");this.linkRefresh(),e.height(e.width()*(1/t)).attr("src",""),INKIVE.Modal.loader(e.parent());var n=new Image;n.src=l.get(),n.onload=function(){e.attr("src",this.src),INKIVE.Modal.loaderClose(e.parent())}}}))},{"../../../../analytics/decorate":4,"../../../../factory/page-thumbnail":74,"../../../../factory/settings":79,"../../../../utils/md5":325,"../../../editor-mode-manager":102,"../../analytics/share":308,"./facebook":310,"./google-plus":311,"./pinterest":313,"./template.hbs":314,"./twitter":315}],317:[function(t,e,n){var i=t("./contents/share/view"),a=t("../../facade/editor/editor"),o=t("../../analytics/decorate");e.exports=o(t("./analytics/view"),Backbone.View.extend({events:{"click a.btn.save":"saveEvent","click a.btn.shr":"shareEvent","click a.btn.download":"downloadEvent","click a.btn.print":"printEvent","click a.btn.close":"closeEvent",'click a[data-action="on_undo"]':"undoEvent",'click a[data-action="on_redo"]':"redoEvent"},downloadEvent:function(t){},undoEvent:function(t){a.handle("history","undo")},redoEvent:function(t){a.handle("history","redo")},saveEvent:function(t){a.handle("page","save")},closeEvent:function(t){a.handle("close")},shareEvent:function(t){this.shareView.show()},printEvent:function(t){function e(){s=window.open(INKIVE.C.BASE_URL+"design/print?id="+INKIVE.C.BOOK.id+"&page_number="+INKIVE.Tool._current_page_id),INKIVE.Modal.togglePageLoader(!0),_.delay(n,1e3)}function n(){r()?(l--,l>0&&_.delay(n,1e3),l>0||i()):o()}function i(){INKIVE.Modal.togglePageLoader(!1),INKIVE.Modal.alertMessage(INKIVE.TemplatesHelper("alert_default",{message:"modal.alert.popup_blocker"}))}function o(){INKIVE.Modal.togglePageLoader(!1),INKIVE.Modal.togglePageLoader(!0,"modal.wait_printing"),localStorage.setItem("printing",!0),$(window).one("storage",function(t){"printing"===t.originalEvent.key&&INKIVE.Modal.togglePageLoader(!1)})}function r(){try{return"undefined"==typeof s?!0:s&&s.closed?!1:s&&s.tryLoad?!1:!0}catch(t){}return!1}var s,l=20,c=this.editor.getSvgString(),u=!INKIVE.Helpers.areEqual(c,INKIVE.EditorFacade.handle("cache","get"));u||e(),u&&a.handle("page","save").then(e)},initialize:function(){this.tool=INKIVE.Tool.getInstance(),this.editor=this.tool.editor,this.initShareView()},initShareView:function(){this.shareView=new i({el:this.$el.find('.ui-dropdown-content[data-id="share"]')})}}))},{"../../analytics/decorate":4,"../../facade/editor/editor":45,"./analytics/view":309,"./contents/share/view":316}],318:[function(t,e,n){function i(){this.shown=[]}var a=t("../app/decorate"),o=INKIVE.C.IS_MOBILE?"Tap":"Click",r=t("../facade/design/design"),s=t("../facade/editor/editor"),l=t("../../../bower_components/tinycolor/tinycolor");i.prototype=_.extend({messages:[{id:"share-error",type:"error"},{id:"upload-error",type:"error"},{id:"pick-template",type:"info"},{id:"template-back",type:"info"},{id:"upload-cancel",type:"info"},{id:"share-success",type:"success"},{id:"thumb-not-load",type:"warning"},{id:"project-name",type:"warning"},{id:"nothing-to-save",type:"success"},{id:"crop",type:"warning",once:!0},{id:"convert-to-layout-box",type:"success"},{id:"text-partial-edit",type:"warning",once:!0},{id:"source-restriction-applied",type:"warning"},{id:"dropbox-view",type:"warning",once:!0},{id:"long-time-no-save",type:"warning"},{id:"clipper-rotation-limit",type:"info"},{id:"spacing-and-underline",type:"warning"},{id:"uploading-images-save",type:"warning"},{id:"undo-unlocked-layout-image",type:"info"},{id:"already-saved",type:"success"},{id:"long-text",type:"info",onShow:function(){this.blinkingHint($('a.btn.btn-onmenu[data-action="on_textTyping"]'))}},{id:"locked-layout-image",type:"warning",onShow:function(){this.blinkingHint($('a.btn.btn-onmenu[data-action="on_unlockImage"]'))}},{id:"locked-element",type:"error",onShow:function(){this.blinkingHint($('a.btn.btn-onmenu[data-action="on_unlockElement"]'))}},{id:"template-placeholders",type:"info",onShow:function(){this.blinkingHint($('.tool-menu li a[href="#tabImages"]').parent())}},{id:"text-edit",type:"info",onShow:function(){this.blinkingHint($('a.btn.btn-onmenu[data-action="on_textBeginEdit"]'))}},{id:"saved",type:"success",content:function(t){var e=new Date,n=e.getHours(),i=e.getMinutes();return t("advice.saved.content",{H:10>n?"0"+n:n,i:10>i?"0"+i:i})}},{id:"template-backgound",type:"info",onShow:function(){this.blinkingHint($('.tool-menu li a[href="#tabExtra"]').parent())},content:function(t){return t("advice.template_backgound.content",{event_name:INKIVE.C.IS_MOBILE?"tapping":"clicking"})}}],blinkingHint:function(t){function e(){t.removeClass("blink")}var n=5e3;t.addClass("blink"),t.one("click",e),_.delay(e,n)},initialize:function(t){this.initialized||(this.initialized=!0,this.initEventListeners(t),toastr.options={debug:!1,timeOut:5e3,showEasing:"easeOutBack",hideEasing:"easeInBack",showMethod:"slideDown",hideMethod:"slideUp",closeButton:!1,newestOnTop:!0,showDuration:300,hideDuration:300,extendedTimeOut:1e3,preventDuplicates:!0,positionClass:INKIVE.C.IS_MOBILE?window.innerHeight>window.innerWidth?"mobile portrait toast-top-right":"mobile landscape toast-bottom-left":"desktop toast-top-left"})},initEventListeners:function(t){function e(){var t=r.get("background"),e=t.color&&!l.equals(t.color,"#FFF")&&!l.equals(t.color,"#000");(t.source||e)&&this.show("template-backgound")}t.bind("advice.show",_.bind(function(t,e){this.show(e)},this)),s.on("page.move_to",_.bind(e,this)),r.on("template.update.designed",_.bind(e,this))},show:function(t){var e=_.find(this.messages,{id:t});if(e){var n=_.contains(this.shown,t);(!n||!e.once)&&this.showMessage(e),n||this.shown.push(t)}e||console.warn("Message "+t+" is not defined")},showMessage:function(t){var e,n=toastr[t.type];t=this.translateFullMessage(t),_.isFunction(n)&&(t.more?(toastr.options.onclick=this.showMoreInfo(t),e=INKIVE.TranslateHelper.translate("advice.more_info",{event_name:o})):(toastr.options.onclick=null,e=""),t.content&&(n(t.content+e),t.onShow&&t.onShow.call(this)),toastr.options.onclick=null);
},translateFullMessage:function(t){function e(){var e="advice."+t.id.split("-").join("_");return{title:e+".title",more:e+".more",content:e+".content"}}function n(t){r[t]=r[t](a)}function i(t,e){var n=a(e,{event_name:o});n!==e&&(r[t]=n)}var a=INKIVE.TranslateHelper.translate,r=_.clone(t),s=e();return _.each(s,function(t,e){r[e]&&n(e),r[e]||i(e,t)}),r},showMoreInfo:function(t){var e='<p class="advice">'+t.more+"</p>",n=INKIVE.Modal.modalWindow(e,{headerIcon:"icon-info",headerTitle:t.title,buttons:[{title:"Got it!",onClick:function(){n.close()}}]})}},Backbone.Events),e.exports=a(t("./app/advice"),new i)},{"../../../bower_components/tinycolor/tinycolor":2,"../app/decorate":7,"../facade/design/design":19,"../facade/editor/editor":45,"./app/advice":319}],319:[function(t,e,n){e.exports={showMessageCheckOnce:function(){return!window.Android&&this.appBridge.version.isGreaterThan("1.2")},showMessage:function(t){t=this.translateFullMessage(t),this.trigger("show",t)},messages:[{id:"text-edit",type:"info"},{id:"share-error",type:"error"},{id:"upload-error",type:"error"},{id:"template-back",type:"info"},{id:"upload-cancel",type:"info"},{id:"locked-element",type:"error"},{id:"share-success",type:"success"},{id:"convert-to-layout-box",type:"success"},{id:"thumb-not-load",type:"warning"},{id:"already-saved",type:"success"},{id:"nothing-to-save",type:"success"},{id:"crop",type:"warning",once:!0},{id:"long-time-no-save",type:"warning"},{id:"locked-layout-image",type:"warning"},{id:"clipper-rotation-limit",type:"info"},{id:"uploading-images-save",type:"warning"},{id:"spacing-and-underline",type:"warning"},{id:"undo-unlocked-layout-image",type:"info"},{id:"saved",type:"success",content:function(t){var e=new Date,n=e.getHours(),i=e.getMinutes();return t("advice.saved.content",{H:10>n?"0"+n:n,i:10>i?"0"+i:i})}},{id:"template-backgound",type:"info",content:function(t){return t("advice.template_backgound.content",{event_name:INKIVE.C.IS_MOBILE?"tapping":"clicking"})}}]}},{}],320:[function(t,e,n){Backbone.mixin=function(t,e){return _.defaults(t.prototype,e),_.defaults(t.prototype.events,e.events),t}},{}],321:[function(t,e,n){e.exports={set:function(t,e,n){if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var a="; expires="+i.toGMTString()}else var a="";document.cookie=t+"="+e+a+"; path=/"},get:function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},"delete":function(t){this.set(t,"",-1)}}},{}],322:[function(t,e,n){function i(t,e){function n(){var e=t.attr("tag");return e&&e.trim()}function i(){var n=a.substring(0,e-s)+r;return t.attr("tag",n),!0}var a=n();return a&&a.length>e&&i()&&o(t,a),""!=a}function a(t,e){function n(){var e=t.contents().last().text();return e&&e.trim()}function i(){var n=a.substring(0,e-s)+r;return t.contents().last().replaceWith(n),!0}var a=n();return a&&a.length>e&&i()&&o(t,a),""!=a}function o(t,e){t.attr("title")||t.attr("title",e)}var r="...",s=r.length;e.exports=function(t){t=t||$("body"),t.find("[data-charlimit]").each(function(){var t=$(this),e=!1,n=t.data("charlimit");e|=i(t,n),e|=a(t,n),e||console.warn("Can't trim",this)})}},{}],323:[function(t,e,n){!function(t){var n=function(t,e,i){if(!l(e)||u(e)||h(e)||d(e))return e;var a,o=0,r=0;if(c(e))for(a=[],r=e.length;r>o;o++)a.push(n(t,e[o],i));else{a={};for(var s in e)e.hasOwnProperty(s)&&(a[t(s,i)]=n(t,e[s],i))}return a},i=function(t,e){e=e||{};var n=e.separator||"_",i=e.split||/(?=[A-Z])/;return t.split(i).join(n)},a=function(t){return p(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(t,e){return e?e.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))},o=function(t){var e=a(t);return e.substr(0,1).toUpperCase()+e.substr(1)},r=function(t,e){return i(t,e).toLowerCase()},s=Object.prototype.toString,l=function(t){return t===Object(t)},c=function(t){return"[object Array]"==s.call(t)},u=function(t){return"[object Date]"==s.call(t)},h=function(t){return"[object RegExp]"==s.call(t)},d=function(t){return"[object Boolean]"==s.call(t)},p=function(t){return t-=0,t===t},f={camelize:a,decamelize:r,pascalize:o,depascalize:r,camelizeKeys:function(t){return n(a,t)},decamelizeKeys:function(t,e){return n(r,t,e)},pascalizeKeys:function(t){return n(o,t)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};"function"==typeof define&&define.amd?define(f):"undefined"!=typeof e&&e.exports?e.exports=f:t.humps=f}(this)},{}],324:[function(t,e,n){var i=t("../factory/images"),a=(t("../facade/editor/editor"),t("../facade/design/design"));e.exports={preLoadImagesSanitize:function(t){var e=/<image([^>]*)xlink:href="([^"]*)"([^>]*)>([^<]*)<\/image>/g,n=/<image([^>]*)xlink:href="([^"]*)"([^>]*)\/>/g;return t=t.replace(e,function(t,e,n,i,a){return e.indexOf("data-url=")>-1||i.indexOf("data-url=")>-1?t:"<image"+e+'data-url="'+n+'"'+i+">"+a+"</image>"}),t.replace(n,function(t,e,n,i){return e.indexOf("data-url=")>-1||i.indexOf("data-url=")>-1?t:"<image"+e+'data-url="'+n+'"'+i+"/>"})},postLoadImagesSanitize:function(t){var e=INKIVE.Tool.getInstance(),n=e.editor.canvas;return $(t).find("image").each(function(){function t(){s.src=c.shift()}var e=$(this),o=this,r=e.data("url");if(r){var s=new Image,l=n.getBBox(o);l&&(l.width||l.height)||(l={width:o.getAttribute("width"),height:o.getAttribute("height")});var c=_.uniq([i.getRightSizeUrl(r,l),r,i.getOriginalUrl(r)]);e.removeAttr("data-url"),t(),s.onload=function(){a.set(o.getAttribute("id"),{source:{url:s.src,smart_load:!1}})},s.onerror=function(){c.length&&t()}}}),t}}},{"../facade/design/design":19,"../facade/editor/editor":45,"../factory/images":66}],325:[function(t,e,n){e.exports=function(){function t(t,e){var r=t[0],s=t[1],l=t[2],c=t[3];r=n(r,s,l,c,e[0],7,-680876936),c=n(c,r,s,l,e[1],12,-389564586),l=n(l,c,r,s,e[2],17,606105819),s=n(s,l,c,r,e[3],22,-1044525330),r=n(r,s,l,c,e[4],7,-176418897),c=n(c,r,s,l,e[5],12,1200080426),l=n(l,c,r,s,e[6],17,-1473231341),s=n(s,l,c,r,e[7],22,-45705983),r=n(r,s,l,c,e[8],7,1770035416),c=n(c,r,s,l,e[9],12,-1958414417),l=n(l,c,r,s,e[10],17,-42063),s=n(s,l,c,r,e[11],22,-1990404162),r=n(r,s,l,c,e[12],7,1804603682),c=n(c,r,s,l,e[13],12,-40341101),l=n(l,c,r,s,e[14],17,-1502002290),s=n(s,l,c,r,e[15],22,1236535329),r=i(r,s,l,c,e[1],5,-165796510),c=i(c,r,s,l,e[6],9,-1069501632),l=i(l,c,r,s,e[11],14,643717713),s=i(s,l,c,r,e[0],20,-373897302),r=i(r,s,l,c,e[5],5,-701558691),c=i(c,r,s,l,e[10],9,38016083),l=i(l,c,r,s,e[15],14,-660478335),s=i(s,l,c,r,e[4],20,-405537848),r=i(r,s,l,c,e[9],5,568446438),c=i(c,r,s,l,e[14],9,-1019803690),l=i(l,c,r,s,e[3],14,-187363961),s=i(s,l,c,r,e[8],20,1163531501),r=i(r,s,l,c,e[13],5,-1444681467),c=i(c,r,s,l,e[2],9,-51403784),l=i(l,c,r,s,e[7],14,1735328473),s=i(s,l,c,r,e[12],20,-1926607734),r=a(r,s,l,c,e[5],4,-378558),c=a(c,r,s,l,e[8],11,-2022574463),l=a(l,c,r,s,e[11],16,1839030562),s=a(s,l,c,r,e[14],23,-35309556),r=a(r,s,l,c,e[1],4,-1530992060),c=a(c,r,s,l,e[4],11,1272893353),l=a(l,c,r,s,e[7],16,-155497632),s=a(s,l,c,r,e[10],23,-1094730640),r=a(r,s,l,c,e[13],4,681279174),c=a(c,r,s,l,e[0],11,-358537222),l=a(l,c,r,s,e[3],16,-722521979),s=a(s,l,c,r,e[6],23,76029189),r=a(r,s,l,c,e[9],4,-640364487),c=a(c,r,s,l,e[12],11,-421815835),l=a(l,c,r,s,e[15],16,530742520),s=a(s,l,c,r,e[2],23,-995338651),r=o(r,s,l,c,e[0],6,-198630844),c=o(c,r,s,l,e[7],10,1126891415),l=o(l,c,r,s,e[14],15,-1416354905),s=o(s,l,c,r,e[5],21,-57434055),r=o(r,s,l,c,e[12],6,1700485571),c=o(c,r,s,l,e[3],10,-1894986606),l=o(l,c,r,s,e[10],15,-1051523),s=o(s,l,c,r,e[1],21,-2054922799),r=o(r,s,l,c,e[8],6,1873313359),c=o(c,r,s,l,e[15],10,-30611744),l=o(l,c,r,s,e[6],15,-1560198380),s=o(s,l,c,r,e[13],21,1309151649),r=o(r,s,l,c,e[4],6,-145523070),c=o(c,r,s,l,e[11],10,-1120210379),l=o(l,c,r,s,e[2],15,718787259),s=o(s,l,c,r,e[9],21,-343485551),t[0]=h(r,t[0]),t[1]=h(s,t[1]),t[2]=h(l,t[2]),t[3]=h(c,t[3])}function e(t,e,n,i,a,o){return e=h(h(e,t),h(i,o)),h(e<<a|e>>>32-a,n)}function n(t,n,i,a,o,r,s){return e(n&i|~n&a,t,n,o,r,s)}function i(t,n,i,a,o,r,s){return e(n&a|i&~a,t,n,o,r,s)}function a(t,n,i,a,o,r,s){return e(n^i^a,t,n,o,r,s)}function o(t,n,i,a,o,r,s){return e(i^(n|~a),t,n,o,r,s)}function r(e){var n,i=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)t(a,s(e.substring(n-64,n)));e=e.substring(n-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)o[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(t(a,o),n=0;16>n;n++)o[n]=0;return o[14]=8*i,t(a,o),a}function s(t){var e,n=[];for(e=0;64>e;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function l(t){for(var e="",n=0;4>n;n++)e+=d[t>>8*n+4&15]+d[t>>8*n&15];return e}function c(t){for(var e=0;e<t.length;e++)t[e]=l(t[e]);return t.join("")}function u(t){return c(r(unescape(encodeURIComponent(t))))}function h(t,e){return t+e&4294967295}var d="0123456789abcdef".split("");return u}()},{}],326:[function(t,e,n){e.exports=function(t){INKIVE.C.DEFAULT_FINEUPLOADER.messages.typeError="{file} has an invalid extension. Valid extension(s): {extensions}.",INKIVE.C.TextDefault=[{text:t("text.option_title"),fontFamily:"Lato",fontSize:"45",size:.18},{text:t("text.option_subtitle"),fontFamily:"Lato",fontSize:"30",size:.1},{text:t("text.option_body"),fontFamily:"Lato",fontSize:"20",size:.04}],INKIVE.C.HTML={breadcrumbWrapper:'<ul class="breadcrumb"><li></li></ul>',breadcrumbElement:function(t,e,n){return'<a data-toggle="tab" href="#'+t+'" class="'+e+'">'+n+" </a>&gt "},progressBar:function(t){return t||console.error("INKIVE.C.HTML.progressBar: id is not defined"),$.parseHTML('<div class="progress-wrapper" id="'+t+'"><div class="progress"><div class="progress-bar" role="progressbar" style="width: 0%;">0%</div></div><a class="btn progress-cancel"><i class="icon-remove"></i></a></div>')}}}},{}],327:[function(t,e,n){function i(){_.each(h,u.appendUser),_.defer(o)}function a(){function t(){function t(t){var e=$.parseJSON(t);e.result&&_.each(_.filter(e.result,r),l),i()}$.post(u.baseUrl+"friends/list",u.friendsListParameters,t)}function e(){var t="/me/friends?fields=id,name,installed,picture.redirect(false).type(square)";t+="&access_token="+u.facebookToken,FB.api(t,function(t){t&&!t.error&&_.each(t.data,function(t){var e={username:t.name,social_user_id:t.id,profile_picture:t.picture.data.url};r(e)&&l(e,"Facebook")}),i()})}var n=[{load:t},{load:e}],i=_.after(n.length,o);_.invoke(n,"load")}function o(){u.updateFriendScroll(),c()}function r(t){return!h[s(t)]}function s(t){return t.social_user_id>0?t.social_user_id:t.user_id}function l(t,e){var n=s(t),i=t.profile_picture?t.profile_picture.replace("344x344","42x42"):u.noProfilePicture;h[n]={user_id:n,user_name:t.username,profile_pic:i},"string"==typeof e&&(h[n].source=e),u.appendUser(h[n])}function c(){function t(){var t=u.$searchInput.tagsinput("input").val().trim();t.length>2&&i({q:t},function(n){var i=_.filter(n,r);_.each(i,l),e(!1,t)})}function e(t,e){e="undefined"==typeof e?u.$searchInput.tagsinput("input").val().trim():e,u.filter(e,t)}var n=_.debounce(t,800),i=_.partial(u.api,"search/user","GET");u.$searchInput.tagsinput({itemValue:"id",itemText:"name"}),u.$searchInput.tagsinput("input").keyup(function(t){var i=(u.$searchInput.tagsinput("input").val().trim(),t.keyCode?t.keyCode:t.which);13==i?u.enter():(n(),e(!0))})}var u,h={};e.exports=function(t){u=_.extend({$searchInput:$("<input>"),api:$.noop,baseUrl:"",friendsListParameters:{},facebookToken:FB.getAccessToken(),noProfilePicture:"",enter:$.noop,filter:$.noop,appendUser:$.noop,updateFriendScroll:$.noop},t);var e=!_.isEmpty(h);e&&i(),e||a()}},{}],328:[function(t,e,n){function i(t,e,n){this.namespace=t,this.build=n?"?"+n:"",this.translationsPath=e,this.setLocale(o.get("locale")||"en"),this.initHandlebarsHelper()}var a,o=t("../js/editor/utils/cookie-storage");i.prototype.load=function(t){return a?a.promise():(a=$.Deferred(),t&&this.setLocale(t),$.get(this.translationsPath+this.namespace+"."+this.locale+".json"+this.build).done(_.bind(function(t){this.data=t,a.resolve()},this)).fail(function(){a.reject()}),a.promise())},i.prototype.setLocale=function(t){this.locale=t,o.set("locale",t)},i.prototype.translate=function(e,n){function i(e,n){var i=t("handlebars"),o=t("hbsfy/runtime");i.helpers=o.helpers;var r=i.compile(e);return n=_.isArray(n)?a(n,e):n,r(n)}function a(t,e){function n(t,e){for(var n,i=1,a=[];n=e.exec(t);)a.push(n[i]);return a}for(var i={},a=/{{{?[\s]*([^#|}|\/|\s]+)[\s]*}?}}/g,o=n(e,a);o.length&&t.length;)i[o.pop()]=t.pop();return i}if(e){for(var o,r=e.split("."),s=this.data;r.length&&s;)o=r.shift(),s=s[o];return s?n||s.indexOf("{{#")>-1?i(s,n):s:e}},i.prototype.initHandlebarsHelper=function(){var e=this,n=t("hbsfy/runtime");n.registerHelper("t",function(t){var n=_.rest(_.initial(arguments));return e.translate(t,n.length&&n)})},e.exports=i},{"../js/editor/utils/cookie-storage":321,handlebars:361,"hbsfy/runtime":375}],329:[function(t,e,n){},{}],330:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var a=t[i];"."===a?t.splice(i,1):".."===a?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return a.exec(t).slice(1)};n.resolve=function(){for(var n="",a=!1,o=arguments.length-1;o>=-1&&!a;o--){var r=o>=0?arguments[o]:t.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(n=r+"/"+n,a="/"===r.charAt(0))}return n=e(i(n.split("/"),function(t){return!!t}),!a).join("/"),(a?"/":"")+n||"."},n.normalize=function(t){var a=n.isAbsolute(t),o="/"===r(t,-1);return t=e(i(t.split("/"),function(t){return!!t}),!a).join("/"),t||a||(t="."),t&&o&&(t+="/"),(a?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var a=i(t.split("/")),o=i(e.split("/")),r=Math.min(a.length,o.length),s=r,l=0;r>l;l++)if(a[l]!==o[l]){s=l;break}for(var c=[],l=s;l<a.length;l++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=o(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},n.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return o(t)[3]};var r="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:331}],331:[function(t,e,n){function i(){u=!1,s.length?c=s.concat(c):h=-1,c.length&&a()}function a(){if(!u){var t=setTimeout(i);u=!0;for(var e=c.length;e;){for(s=c,c=[];++h<e;)s&&s[h].run();h=-1,e=c.length}s=null,u=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function r(){}var s,l=e.exports={},c=[],u=!1,h=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new o(t,e)),1!==c.length||u||setTimeout(a,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=r,l.addListener=r,l.once=r,l.off=r,l.removeListener=r,l.removeAllListeners=r,l.emit=r,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],332:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(){var t=v();return t.compile=function(e,n){return u.compile(e,n,t)},t.precompile=function(e,n){return u.precompile(e,n,t)},t.AST=l["default"],t.Compiler=u.Compiler,t.JavaScriptCompiler=d["default"],t.Parser=c.parser,t.parse=c.parse,t}n.__esModule=!0;var o=t("./handlebars.runtime"),r=i(o),s=t("./handlebars/compiler/ast"),l=i(s),c=t("./handlebars/compiler/base"),u=t("./handlebars/compiler/compiler"),h=t("./handlebars/compiler/javascript-compiler"),d=i(h),p=t("./handlebars/compiler/visitor"),f=i(p),m=t("./handlebars/no-conflict"),g=i(m),v=r["default"].create,b=a();b.create=a,g["default"](b),b.Visitor=f["default"],b["default"]=b,n["default"]=b,e.exports=n["default"]},{"./handlebars.runtime":333,"./handlebars/compiler/ast":335,"./handlebars/compiler/base":336,"./handlebars/compiler/compiler":338,"./handlebars/compiler/javascript-compiler":340,"./handlebars/compiler/visitor":343,"./handlebars/no-conflict":357}],333:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(){var t=new s.HandlebarsEnvironment;return p.extend(t,s),t.SafeString=c["default"],t.Exception=h["default"],t.Utils=p,t.escapeExpression=p.escapeExpression,t.VM=m,t.template=function(e){return m.template(e,t)},t}n.__esModule=!0;var r=t("./handlebars/base"),s=a(r),l=t("./handlebars/safe-string"),c=i(l),u=t("./handlebars/exception"),h=i(u),d=t("./handlebars/utils"),p=a(d),f=t("./handlebars/runtime"),m=a(f),g=t("./handlebars/no-conflict"),v=i(g),b=o();b.create=o,v["default"](b),b["default"]=b,n["default"]=b,e.exports=n["default"]},{"./handlebars/base":334,"./handlebars/exception":347,"./handlebars/no-conflict":357,"./handlebars/runtime":358,"./handlebars/safe-string":359,"./handlebars/utils":360}],334:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t,e,n){this.helpers=t||{},this.partials=e||{},this.decorators=n||{},l.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}n.__esModule=!0,n.HandlebarsEnvironment=a;var o=t("./utils"),r=t("./exception"),s=i(r),l=t("./helpers"),c=t("./decorators"),u=t("./logger"),h=i(u),d="4.0.5";n.VERSION=d;var p=7;n.COMPILER_REVISION=p;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};n.REVISION_CHANGES=f;var m="[object Object]";a.prototype={constructor:a,logger:h["default"],log:h["default"].log,registerHelper:function(t,e){if(o.toString.call(t)===m){if(e)throw new s["default"]("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===m)o.extend(this.partials,t);else{if("undefined"==typeof e)throw new s["default"]('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===m){if(e)throw new s["default"]("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var g=h["default"].log;n.log=g,n.createFrame=o.createFrame,n.logger=h["default"]},{"./decorators":345,"./exception":347,"./helpers":348,"./logger":356,"./utils":360}],335:[function(t,e,n){"use strict";n.__esModule=!0;var i={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!i.helpers.scopedId(t)&&!t.depth}}};n["default"]=i,e.exports=n["default"]},{}],336:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if("Program"===t.type)return t;s["default"].yy=p,p.locInfo=function(t){return new p.SourceLocation(e&&e.srcName,t)};var n=new c["default"](e);return n.accept(s["default"].parse(t))}n.__esModule=!0,n.parse=o;var r=t("./parser"),s=a(r),l=t("./whitespace-control"),c=a(l),u=t("./helpers"),h=i(u),d=t("../utils");n.parser=s["default"];var p={};d.extend(p,h)},{"../utils":360,"./helpers":339,"./parser":341,"./whitespace-control":344}],337:[function(t,e,n){"use strict";function i(t,e,n){if(o.isArray(t)){for(var i=[],a=0,r=t.length;r>a;a++)i.push(e.wrap(t[a],n));return i}return"boolean"==typeof t||"number"==typeof t?t+"":t}function a(t){this.srcFile=t,this.source=[]}n.__esModule=!0;var o=t("../utils"),r=void 0;try{if("function"!=typeof define||!define.amd){var s=t("source-map");r=s.SourceNode}}catch(l){}r||(r=function(t,e,n,i){this.src="",i&&this.add(i)},r.prototype={add:function(t){o.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){o.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),a.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(t){for(var e=0,n=this.source.length;n>e;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new r(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof r?t:(t=i(t,this,e),new r(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,n){return n=this.generateList(n),this.wrap([t,e?"."+e+"(":"(",n,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){var a=i(t[n],this);"undefined"!==a&&e.push([this.quotedString(n),":",a])}var o=this.generateList(e);return o.prepend("{"),o.add("}"),o},generateList:function(t){for(var e=this.empty(),n=0,a=t.length;a>n;n++)n&&e.add(","),e.add(i(t[n],this));return e},generateArray:function(t){var e=this.generateList(t);return e.prepend("["),e.add("]"),e}},n["default"]=a,e.exports=n["default"]},{"../utils":360,"source-map":362}],338:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(){}function o(t,e,n){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new u["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var i=n.parse(t,e),a=(new n.Compiler).compile(i,e);return(new n.JavaScriptCompiler).compile(a,e)}function r(t,e,n){function i(){var i=n.parse(t,e),a=(new n.Compiler).compile(i,e),o=(new n.JavaScriptCompiler).compile(a,e,void 0,!0);return n.template(o)}function a(t,e){return o||(o=i()),o.call(this,t,e)}if(void 0===e&&(e={}),null==t||"string"!=typeof t&&"Program"!==t.type)throw new u["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var o=void 0;return a._setup=function(t){return o||(o=i()),o._setup(t)},a._child=function(t,e,n,a){return o||(o=i()),o._child(t,e,n,a)},a}function s(t,e){if(t===e)return!0;if(h.isArray(t)&&h.isArray(e)&&t.length===e.length){for(var n=0;n<t.length;n++)if(!s(t[n],e[n]))return!1;return!0}}function l(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}n.__esModule=!0,n.Compiler=a,n.precompile=o,n.compile=r;var c=t("../exception"),u=i(c),h=t("../utils"),d=t("./ast"),p=i(d),f=[].slice;a.prototype={compiler:a,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var n=0;e>n;n++){var i=this.opcodes[n],a=t.opcodes[n];if(i.opcode!==a.opcode||!s(i.args,a.args))return!1}e=this.children.length;for(var n=0;e>n;n++)if(!this.children[n].equals(t.children[n]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var n=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},n)for(var i in n)i in n&&(e.knownHelpers[i]=n[i]);return this.accept(t)},compileProgram:function(t){var e=new this.compiler,n=e.compile(t,this.options),i=this.guid++;return this.usePartial=this.usePartial||n.usePartial,this.children[i]=n,this.useDepths=this.useDepths||n.useDepths,i},accept:function(t){if(!this[t.type])throw new u["default"]("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,n=e.length,i=0;n>i;i++)this.accept(e[i]);return this.options.blockParams.shift(),this.isSimple=1===n,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){l(t);var e=t.program,n=t.inverse;e=e&&this.compileProgram(e),n=n&&this.compileProgram(n);var i=this.classifySexpr(t);"helper"===i?this.helperSexpr(t,e,n):"simple"===i?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,n),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),n=this.setupFullMustacheParams(t,e,void 0),i=t.path;this.useDecorators=!0,this.opcode("registerDecorator",n.length,i.original)},PartialStatement:function(t){this.usePartial=!0;var e=t.program;e&&(e=this.compileProgram(t.program));var n=t.params;if(n.length>1)throw new u["default"]("Unsupported number of partial arguments: "+n.length,t);n.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):n.push({type:"PathExpression",parts:[],depth:0}));var i=t.name.original,a="SubExpression"===t.name.type;a&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);var o=t.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",a,i,o),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){l(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,n){var i=t.path,a=i.parts[0],o=null!=e||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),i.strict=!0,this.accept(i),this.opcode("invokeAmbiguous",a,o)},simpleSexpr:function(t){var e=t.path;e.strict=!0,this.accept(e),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,n){var i=this.setupFullMustacheParams(t,e,n),a=t.path,o=a.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",i.length,o);else{if(this.options.knownHelpersOnly)throw new u["default"]("You specified knownHelpersOnly, but used the unknown helper "+o,t);a.strict=!0,a.falsy=!0,this.accept(a),this.opcode("invokeHelper",i.length,a.original,p["default"].helpers.simpleId(a))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],n=p["default"].helpers.scopedId(t),i=!t.depth&&!n&&this.blockParamIndex(e);i?this.opcode("lookupBlockParam",i,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,n):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,n=0,i=e.length;for(this.opcode("pushHash");i>n;n++)this.pushParam(e[n].value);for(;n--;)this.opcode("assignToHash",e[n].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=p["default"].helpers.simpleId(t.path),n=e&&!!this.blockParamIndex(t.path.parts[0]),i=!n&&p["default"].helpers.helperExpression(t),a=!n&&(i||e);if(a&&!i){var o=t.path.parts[0],r=this.options;r.knownHelpers[o]?i=!0:r.knownHelpersOnly&&(a=!1)}return i?"helper":a?"ambiguous":"simple"},pushParams:function(t){for(var e=0,n=t.length;n>e;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var n=void 0;if(!t.parts||p["default"].helpers.scopedId(t)||t.depth||(n=this.blockParamIndex(t.parts[0])),n){var i=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,i)}else e=t.original||e,e.replace&&(e=e.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,n,i){var a=t.params;return this.pushParams(a),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.accept(t.hash):this.opcode("emptyHash",i),a},blockParamIndex:function(t){for(var e=0,n=this.options.blockParams.length;n>e;e++){var i=this.options.blockParams[e],a=i&&h.indexOf(i,t);if(i&&a>=0)return[e,a]}}}},{"../exception":347,"../utils":360,"./ast":335}],339:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var n={loc:t.path.loc};throw new g["default"](t.path.original+" doesn't match "+e,n)}}function o(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function r(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t}function s(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function l(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function c(t,e,n){n=this.locInfo(n);for(var i=t?"@":"",a=[],o=0,r="",s=0,l=e.length;l>s;s++){var c=e[s].part,u=e[s].original!==c;if(i+=(e[s].separator||"")+c,u||".."!==c&&"."!==c&&"this"!==c)a.push(c);else{if(a.length>0)throw new g["default"]("Invalid path: "+i,{loc:n});".."===c&&(o++,r+="../")}}return{type:"PathExpression",data:t,depth:o,parts:a,original:i,loc:n}}function u(t,e,n,i,a,o){var r=i.charAt(3)||i.charAt(2),s="{"!==r&&"&"!==r,l=/\*/.test(i);return{type:l?"Decorator":"MustacheStatement",path:t,params:e,hash:n,escaped:s,strip:a,loc:this.locInfo(o)}}function h(t,e,n,i){a(t,n),i=this.locInfo(i);var o={type:"Program",body:e,strip:{},loc:i};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:o,openStrip:{},inverseStrip:{},closeStrip:{},loc:i}}function d(t,e,n,i,o,r){i&&i.path&&a(t,i);var s=/\*/.test(t.open);e.blockParams=t.blockParams;
var l=void 0,c=void 0;if(n){if(s)throw new g["default"]("Unexpected inverse block on decorator",n);n.chain&&(n.program.body[0].closeStrip=i.strip),c=n.strip,l=n.program}return o&&(o=l,l=e,e=o),{type:s?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:l,openStrip:t.strip,inverseStrip:c,closeStrip:i&&i.strip,loc:this.locInfo(r)}}function p(t,e){if(!e&&t.length){var n=t[0].loc,i=t[t.length-1].loc;n&&i&&(e={source:n.source,start:{line:n.start.line,column:n.start.column},end:{line:i.end.line,column:i.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function f(t,e,n,i){return a(t,n),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:n&&n.strip,loc:this.locInfo(i)}}n.__esModule=!0,n.SourceLocation=o,n.id=r,n.stripFlags=s,n.stripComment=l,n.preparePath=c,n.prepareMustache=u,n.prepareRawBlock=h,n.prepareBlock=d,n.prepareProgram=p,n.preparePartialBlock=f;var m=t("../exception"),g=i(m)},{"../exception":347}],340:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){this.value=t}function o(){}function r(t,e,n,i){var a=e.popStack(),o=0,r=n.length;for(t&&r--;r>o;o++)a=e.nameLookup(a,n[o],i);return t?[e.aliasable("container.strict"),"(",a,", ",e.quotedString(n[o]),")"]:a}n.__esModule=!0;var s=t("../base"),l=t("../exception"),c=i(l),u=t("../utils"),h=t("./code-gen"),d=i(h);o.prototype={nameLookup:function(t,e){return o.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"[",JSON.stringify(e),"]"]},depthedLookup:function(t){return[this.aliasable("container.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=s.COMPILER_REVISION,e=s.REVISION_CHANGES[t];return[t,e]},appendToBuffer:function(t,e,n){return u.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:n?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,n,i){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var a=t.opcodes,o=void 0,r=void 0,s=void 0,l=void 0;for(s=0,l=a.length;l>s;s++)o=a[s],this.source.currentLocation=o.loc,r=r||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=r,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new c["default"]("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),i?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var u=this.createFunctionContext(i);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var d=this.context,p=d.programs,f=d.decorators;for(s=0,l=p.length;l>s;s++)p[s]&&(h[s]=p[s],f[s]&&(h[s+"_d"]=f[s],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),i?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new d["default"](this.options.srcName),this.decorators=new d["default"](this.options.srcName)},createFunctionContext:function(t){var e="",n=this.stackVars.concat(this.registers.list);n.length>0&&(e+=", "+n.join(", "));var i=0;for(var a in this.aliases){var o=this.aliases[a];this.aliases.hasOwnProperty(a)&&o.children&&o.referenceCount>1&&(e+=", alias"+ ++i+"="+a,o.children[0]="alias"+i)}var r=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&r.push("blockParams"),this.useDepths&&r.push("depths");var s=this.mergeSource(e);return t?(r.push(s),Function.apply(this,r)):this.source.wrap(["function(",r.join(","),") {\n  ",s,"}"])},mergeSource:function(t){var e=this.environment.isSimple,n=!this.forceBuffer,i=void 0,a=void 0,o=void 0,r=void 0;return this.source.each(function(t){t.appendToBuffer?(o?t.prepend("  + "):o=t,r=t):(o&&(a?o.prepend("buffer += "):i=!0,r.add(";"),o=r=void 0),a=!0,e||(n=!1))}),n?o?(o.prepend("return "),r.add(";")):a||this.source.push('return "";'):(t+=", buffer = "+(i?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),r.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(i?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(t,0,n);var i=this.popStack();n.splice(1,0,i),this.push(this.source.functionCall(e,"call",n))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var n=this.topStack();e.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,n,i){var a=0;i||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[a++])),this.resolvePath("context",t,a,e,n)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,n){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,n)},resolvePath:function(t,e,n,i,a){var o=this;if(this.options.strict||this.options.assumeObjects)return void this.push(r(this.options.strict&&a,this,e,t));for(var s=e.length;s>n;n++)this.replaceStack(function(a){var r=o.nameLookup(a,e[n],t);return i?[" && ",r]:[" != null ? ",r," : ",a]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var n=this.nameLookup("decorators",e,"decorator"),i=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(n,"",["fn","props","container",i])," || fn;"])},invokeHelper:function(t,e,n){var i=this.popStack(),a=this.setupHelper(t,e),o=n?[a.name," || "]:"",r=["("].concat(o,i);this.options.strict||r.push(" || ",this.aliasable("helpers.helperMissing")),r.push(")"),this.push(this.source.functionCall(r,"call",a.callParams))},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,t,e),a=this.lastHelper=this.nameLookup("helpers",t,"helper"),o=["(","(helper = ",a," || ",n,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",o,i.paramsInit?["),(",i.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",i.callParams)," : helper))"])},invokePartial:function(t,e,n){var i=[],a=this.setupParams(e,1,i);t&&(e=this.popStack(),delete a.name),n&&(a.indent=JSON.stringify(n)),a.helpers="helpers",a.partials="partials",a.decorators="container.decorators",t?i.unshift(e):i.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(a.depths="depths"),a=this.objectLiteral(a),i.push(a),this.push(this.source.functionCall("container.invokePartial","",i))},assignToHash:function(t){var e=this.popStack(),n=void 0,i=void 0,a=void 0;this.trackIds&&(a=this.popStack()),this.stringParams&&(i=this.popStack(),n=this.popStack());var o=this.hash;n&&(o.contexts[t]=n),i&&(o.types[t]=i),a&&(o.ids[t]=a),o.values[t]=e},pushId:function(t,e,n){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:o,compileChildren:function(t,e){for(var n=t.children,i=void 0,a=void 0,o=0,r=n.length;r>o;o++){i=n[o],a=new this.compiler;var s=this.matchExistingProgram(i);null==s?(this.context.programs.push(""),s=this.context.programs.length,i.index=s,i.name="program"+s,this.context.programs[s]=a.compile(i,e,this.context,!this.precompile),this.context.decorators[s]=a.decorators,this.context.environments[s]=i,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams):(i.index=s,i.name="program"+s,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams)}},matchExistingProgram:function(t){for(var e=0,n=this.context.environments.length;n>e;e++){var i=this.context.environments[e];if(i&&i.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],n=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"container.program("+n.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof a||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new a(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],n=void 0,i=void 0,o=void 0;if(!this.isInline())throw new c["default"]("replaceStack on non-inline");var r=this.popStack(!0);if(r instanceof a)n=[r.value],e=["(",n],o=!0;else{i=!0;var s=this.incrStack();e=["((",this.push(s)," = ",r,")"],n=this.topStack()}var l=t.call(this,n);o||this.popStack(),i&&this.stackSlot--,this.push(e.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,n=t.length;n>e;e++){var i=t[e];if(i instanceof a)this.compileStack.push(i);else{var o=this.incrStack();this.pushSource([o," = ",i,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),n=(e?this.inlineStack:this.compileStack).pop();if(!t&&n instanceof a)return n.value;if(!e){if(!this.stackSlot)throw new c["default"]("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof a?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):(e=this.aliases[t]=this.source.wrap(t),e.aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,n){var i=[],a=this.setupHelperArgs(e,t,i,n),o=this.nameLookup("helpers",e,"helper"),r=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}");return{params:i,paramsInit:a,name:o,callParams:[r].concat(i)}},setupParams:function(t,e,n){var i={},a=[],o=[],r=[],s=!n,l=void 0;s&&(n=[]),i.name=this.quotedString(t),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(i.fn=u||"container.noop",i.inverse=c||"container.noop");for(var h=e;h--;)l=this.popStack(),n[h]=l,this.trackIds&&(r[h]=this.popStack()),this.stringParams&&(o[h]=this.popStack(),a[h]=this.popStack());return s&&(i.args=this.source.generateArray(n)),this.trackIds&&(i.ids=this.source.generateArray(r)),this.stringParams&&(i.types=this.source.generateArray(o),i.contexts=this.source.generateArray(a)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(t,e,n,i){var a=this.setupParams(t,e,n);return a=this.objectLiteral(a),i?(this.useRegister("options"),n.push("options"),["options=",a]):n?(n.push(a),""):a}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=o.RESERVED_WORDS={},n=0,i=t.length;i>n;n++)e[t[n]]=!0}(),o.isValidJavaScriptVariableName=function(t){return!o.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},n["default"]=o,e.exports=n["default"]},{"../base":334,"../exception":347,"../utils":360,"./code-gen":337}],341:[function(t,e,n){"use strict";var i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,n,i,a,o,r){var s=o.length-1;switch(a){case 1:return o[s-1];case 2:this.$=i.prepareProgram(o[s]);break;case 3:this.$=o[s];break;case 4:this.$=o[s];break;case 5:this.$=o[s];break;case 6:this.$=o[s];break;case 7:this.$=o[s];break;case 8:this.$=o[s];break;case 9:this.$={type:"CommentStatement",value:i.stripComment(o[s]),strip:i.stripFlags(o[s],o[s]),loc:i.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:o[s],value:o[s],loc:i.locInfo(this._$)};break;case 11:this.$=i.prepareRawBlock(o[s-2],o[s-1],o[s],this._$);break;case 12:this.$={path:o[s-3],params:o[s-2],hash:o[s-1]};break;case 13:this.$=i.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!1,this._$);break;case 14:this.$=i.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!0,this._$);break;case 15:this.$={open:o[s-5],path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:i.stripFlags(o[s-5],o[s])};break;case 16:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:i.stripFlags(o[s-5],o[s])};break;case 17:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:i.stripFlags(o[s-5],o[s])};break;case 18:this.$={strip:i.stripFlags(o[s-1],o[s-1]),program:o[s]};break;case 19:var l=i.prepareBlock(o[s-2],o[s-1],o[s],o[s],!1,this._$),c=i.prepareProgram([l],o[s-1].loc);c.chained=!0,this.$={strip:o[s-2].strip,program:c,chain:!0};break;case 20:this.$=o[s];break;case 21:this.$={path:o[s-1],strip:i.stripFlags(o[s-2],o[s])};break;case 22:this.$=i.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],i.stripFlags(o[s-4],o[s]),this._$);break;case 23:this.$=i.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],i.stripFlags(o[s-4],o[s]),this._$);break;case 24:this.$={type:"PartialStatement",name:o[s-3],params:o[s-2],hash:o[s-1],indent:"",strip:i.stripFlags(o[s-4],o[s]),loc:i.locInfo(this._$)};break;case 25:this.$=i.preparePartialBlock(o[s-2],o[s-1],o[s],this._$);break;case 26:this.$={path:o[s-3],params:o[s-2],hash:o[s-1],strip:i.stripFlags(o[s-4],o[s])};break;case 27:this.$=o[s];break;case 28:this.$=o[s];break;case 29:this.$={type:"SubExpression",path:o[s-3],params:o[s-2],hash:o[s-1],loc:i.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:o[s],loc:i.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:i.id(o[s-2]),value:o[s],loc:i.locInfo(this._$)};break;case 32:this.$=i.id(o[s-1]);break;case 33:this.$=o[s];break;case 34:this.$=o[s];break;case 35:this.$={type:"StringLiteral",value:o[s],original:o[s],loc:i.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(o[s]),original:Number(o[s]),loc:i.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===o[s],original:"true"===o[s],loc:i.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:i.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:i.locInfo(this._$)};break;case 40:this.$=o[s];break;case 41:this.$=o[s];break;case 42:this.$=i.preparePath(!0,o[s],this._$);break;case 43:this.$=i.preparePath(!1,o[s],this._$);break;case 44:o[s-2].push({part:i.id(o[s]),original:o[s],separator:o[s-1]}),this.$=o[s-2];break;case 45:this.$=[{part:i.id(o[s]),original:o[s]}];break;case 46:this.$=[];break;case 47:o[s-1].push(o[s]);break;case 48:this.$=[o[s]];break;case 49:o[s-1].push(o[s]);break;case 50:this.$=[];break;case 51:o[s-1].push(o[s]);break;case 58:this.$=[];break;case 59:o[s-1].push(o[s]);break;case 64:this.$=[];break;case 65:o[s-1].push(o[s]);break;case 70:this.$=[];break;case 71:o[s-1].push(o[s]);break;case 78:this.$=[];break;case 79:o[s-1].push(o[s]);break;case 82:this.$=[];break;case 83:o[s-1].push(o[s]);break;case 86:this.$=[];break;case 87:o[s-1].push(o[s]);break;case 90:this.$=[];break;case 91:o[s-1].push(o[s]);break;case 94:this.$=[];break;case 95:o[s-1].push(o[s]);break;case 98:this.$=[o[s]];break;case 99:o[s-1].push(o[s]);break;case 100:this.$=[o[s]];break;case 101:o[s-1].push(o[s])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],
75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,i=[0],a=[null],o=[],r=this.table,s="",l=0,c=0,u=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,b,y,_,w,x={};;){if(m=i[i.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=e()),g=r[m]&&r[m][p]),"undefined"==typeof g||!g.length||!g[0]){var k="";if(!u){w=[];for(b in r[m])this.terminals_[b]&&b>2&&w.push("'"+this.terminals_[b]+"'");k=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:w})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:i.push(p),a.push(this.lexer.yytext),o.push(this.lexer.yylloc),i.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,s=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,u>0&&u--);break;case 2:if(y=this.productions_[g[1]][1],x.$=a[a.length-y],x._$={first_line:o[o.length-(y||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(y||1)].first_column,last_column:o[o.length-1].last_column},d&&(x._$.range=[o[o.length-(y||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.call(x,s,c,l,this.yy,g[1],a,o),"undefined"!=typeof v)return v;y&&(i=i.slice(0,-1*y*2),a=a.slice(0,-1*y),o=o.slice(0,-1*y)),i.push(this.productions_[g[1]][0]),a.push(x.$),o.push(x._$),_=r[i[i.length-2]][i[i.length-1]],i.push(_);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var a=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,a;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),r=0;r<o.length&&(n=this._input.match(this.rules[o[r]]),!n||e&&!(n[0].length>e[0].length)||(e=n,i=r,this.options.flex));r++);return e?(a=e[0].match(/(?:\r\n?|\n).*/g),a&&(this.yylineno+=a.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:a?a[a.length-1].length-a[a.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,i){function a(t,n){return e.yytext=e.yytext.substr(t,e.yyleng-n)}switch(n){case 0:if("\\\\"===e.yytext.slice(-2)?(a(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(a(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(e.yytext=e.yytext.substr(5,e.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(e.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return e.yytext=a(1,2).replace(/\\"/g,'"'),80;case 32:return e.yytext=a(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return e.yytext=e.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},t}();return e.lexer=n,t.prototype=e,e.Parser=t,new t}();n.__esModule=!0,n["default"]=i},{}],342:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){return(new o).accept(t)}function o(){this.padding=0}n.__esModule=!0,n.print=a,n.PrintVisitor=o;var r=t("./visitor"),s=i(r);o.prototype=new s["default"],o.prototype.pad=function(t){for(var e="",n=0,i=this.padding;i>n;n++)e+="  ";return e+=t+"\n"},o.prototype.Program=function(t){var e="",n=t.body,i=void 0,a=void 0;if(t.blockParams){var o="BLOCK PARAMS: [";for(i=0,a=t.blockParams.length;a>i;i++)o+=" "+t.blockParams[i];o+=" ]",e+=this.pad(o)}for(i=0,a=n.length;a>i;i++)e+=this.accept(n[i]);return this.padding--,e},o.prototype.MustacheStatement=function(t){return this.pad("{{ "+this.SubExpression(t)+" }}")},o.prototype.Decorator=function(t){return this.pad("{{ DIRECTIVE "+this.SubExpression(t)+" }}")},o.prototype.BlockStatement=o.prototype.DecoratorBlock=function(t){var e="";return e+=this.pad(("DecoratorBlock"===t.type?"DIRECTIVE ":"")+"BLOCK:"),this.padding++,e+=this.pad(this.SubExpression(t)),t.program&&(e+=this.pad("PROGRAM:"),this.padding++,e+=this.accept(t.program),this.padding--),t.inverse&&(t.program&&this.padding++,e+=this.pad("{{^}}"),this.padding++,e+=this.accept(t.inverse),this.padding--,t.program&&this.padding--),this.padding--,e},o.prototype.PartialStatement=function(t){var e="PARTIAL:"+t.name.original;return t.params[0]&&(e+=" "+this.accept(t.params[0])),t.hash&&(e+=" "+this.accept(t.hash)),this.pad("{{> "+e+" }}")},o.prototype.PartialBlockStatement=function(t){var e="PARTIAL BLOCK:"+t.name.original;return t.params[0]&&(e+=" "+this.accept(t.params[0])),t.hash&&(e+=" "+this.accept(t.hash)),e+=" "+this.pad("PROGRAM:"),this.padding++,e+=this.accept(t.program),this.padding--,this.pad("{{> "+e+" }}")},o.prototype.ContentStatement=function(t){return this.pad("CONTENT[ '"+t.value+"' ]")},o.prototype.CommentStatement=function(t){return this.pad("{{! '"+t.value+"' }}")},o.prototype.SubExpression=function(t){for(var e=t.params,n=[],i=void 0,a=0,o=e.length;o>a;a++)n.push(this.accept(e[a]));return e="["+n.join(", ")+"]",i=t.hash?" "+this.accept(t.hash):"",this.accept(t.path)+" "+e+i},o.prototype.PathExpression=function(t){var e=t.parts.join("/");return(t.data?"@":"")+"PATH:"+e},o.prototype.StringLiteral=function(t){return'"'+t.value+'"'},o.prototype.NumberLiteral=function(t){return"NUMBER{"+t.value+"}"},o.prototype.BooleanLiteral=function(t){return"BOOLEAN{"+t.value+"}"},o.prototype.UndefinedLiteral=function(){return"UNDEFINED"},o.prototype.NullLiteral=function(){return"NULL"},o.prototype.Hash=function(t){for(var e=t.pairs,n=[],i=0,a=e.length;a>i;i++)n.push(this.accept(e[i]));return"HASH{"+n.join(", ")+"}"},o.prototype.HashPair=function(t){return t.key+"="+this.accept(t.value)}},{"./visitor":343}],343:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(){this.parents=[]}function o(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function r(t){o.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function s(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}n.__esModule=!0;var l=t("../exception"),c=i(l);a.prototype={constructor:a,mutating:!1,acceptKey:function(t,e){var n=this.accept(t[e]);if(this.mutating){if(n&&!a.prototype[n.type])throw new c["default"]('Unexpected node type "'+n.type+'" found when accepting '+e+" on "+t.type);t[e]=n}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new c["default"](t.type+" requires "+e)},acceptArray:function(t){for(var e=0,n=t.length;n>e;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,n--)},accept:function(t){if(t){if(!this[t.type])throw new c["default"]("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:e!==!1?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:o,Decorator:o,BlockStatement:r,DecoratorBlock:r,PartialStatement:s,PartialBlockStatement:function(t){s.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:o,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},n["default"]=a,e.exports=n["default"]},{"../exception":347}],344:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function o(t,e,n){void 0===e&&(e=t.length);var i=t[e-1],a=t[e-2];return i?"ContentStatement"===i.type?(a||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original):void 0:n}function r(t,e,n){void 0===e&&(e=-1);var i=t[e+1],a=t[e+2];return i?"ContentStatement"===i.type?(a||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original):void 0:n}function s(t,e,n){var i=t[null==e?0:e+1];if(i&&"ContentStatement"===i.type&&(n||!i.rightStripped)){var a=i.value;i.value=i.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.value!==a}}function l(t,e,n){var i=t[null==e?t.length-1:e-1];if(i&&"ContentStatement"===i.type&&(n||!i.leftStripped)){var a=i.value;return i.value=i.value.replace(n?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.value!==a,i.leftStripped}}n.__esModule=!0;var c=t("./visitor"),u=i(c);a.prototype=new u["default"],a.prototype.Program=function(t){var e=!this.options.ignoreStandalone,n=!this.isRootSeen;this.isRootSeen=!0;for(var i=t.body,a=0,c=i.length;c>a;a++){var u=i[a],h=this.accept(u);if(h){var d=o(i,a,n),p=r(i,a,n),f=h.openStandalone&&d,m=h.closeStandalone&&p,g=h.inlineStandalone&&d&&p;h.close&&s(i,a,!0),h.open&&l(i,a,!0),e&&g&&(s(i,a),l(i,a)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(i[a-1].original)[1])),e&&f&&(s((u.program||u.inverse).body),l(i,a)),e&&m&&(s(i,a),l((u.inverse||u.program).body))}}return t},a.prototype.BlockStatement=a.prototype.DecoratorBlock=a.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,n=t.program&&t.inverse,i=n,a=n;if(n&&n.chained)for(i=n.body[0].program;a.chained;)a=a.body[a.body.length-1].program;var c={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:r(e.body),closeStandalone:o((i||e).body)};if(t.openStrip.close&&s(e.body,null,!0),n){var u=t.inverseStrip;u.open&&l(e.body,null,!0),u.close&&s(i.body,null,!0),t.closeStrip.open&&l(a.body,null,!0),!this.options.ignoreStandalone&&o(e.body)&&r(i.body)&&(l(e.body),s(i.body))}else t.closeStrip.open&&l(e.body,null,!0);return c},a.prototype.Decorator=a.prototype.MustacheStatement=function(t){return t.strip},a.prototype.PartialStatement=a.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},n["default"]=a,e.exports=n["default"]},{"./visitor":343}],345:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){r["default"](t)}n.__esModule=!0,n.registerDefaultDecorators=a;var o=t("./decorators/inline"),r=i(o)},{"./decorators/inline":346}],346:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../utils");n["default"]=function(t){t.registerDecorator("inline",function(t,e,n,a){var o=t;return e.partials||(e.partials={},o=function(a,o){var r=n.partials;n.partials=i.extend({},r,e.partials);var s=t(a,o);return n.partials=r,s}),e.partials[a.args[0]]=a.fn,o})},e.exports=n["default"]},{"../utils":360}],347:[function(t,e,n){"use strict";function i(t,e){var n=e&&e.loc,o=void 0,r=void 0;n&&(o=n.start.line,r=n.start.column,t+=" - "+o+":"+r);for(var s=Error.prototype.constructor.call(this,t),l=0;l<a.length;l++)this[a[l]]=s[a[l]];Error.captureStackTrace&&Error.captureStackTrace(this,i),n&&(this.lineNumber=o,this.column=r)}n.__esModule=!0;var a=["description","fileName","lineNumber","message","name","number","stack"];i.prototype=new Error,n["default"]=i,e.exports=n["default"]},{}],348:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){r["default"](t),l["default"](t),u["default"](t),d["default"](t),f["default"](t),g["default"](t),b["default"](t)}n.__esModule=!0,n.registerDefaultHelpers=a;var o=t("./helpers/block-helper-missing"),r=i(o),s=t("./helpers/each"),l=i(s),c=t("./helpers/helper-missing"),u=i(c),h=t("./helpers/if"),d=i(h),p=t("./helpers/log"),f=i(p),m=t("./helpers/lookup"),g=i(m),v=t("./helpers/with"),b=i(v)},{"./helpers/block-helper-missing":349,"./helpers/each":350,"./helpers/helper-missing":351,"./helpers/if":352,"./helpers/log":353,"./helpers/lookup":354,"./helpers/with":355}],349:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../utils");n["default"]=function(t){t.registerHelper("blockHelperMissing",function(e,n){var a=n.inverse,o=n.fn;if(e===!0)return o(this);if(e===!1||null==e)return a(this);if(i.isArray(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):a(this);if(n.data&&n.ids){var r=i.createFrame(n.data);r.contextPath=i.appendContextPath(n.data.contextPath,n.name),n={data:r}}return o(e,n)})},e.exports=n["default"]},{"../utils":360}],350:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0;var a=t("../utils"),o=t("../exception"),r=i(o);n["default"]=function(t){t.registerHelper("each",function(t,e){function n(e,n,o){c&&(c.key=e,c.index=n,c.first=0===n,c.last=!!o,u&&(c.contextPath=u+e)),l+=i(t[e],{data:c,blockParams:a.blockParams([t[e],e],[u+e,null])})}if(!e)throw new r["default"]("Must pass iterator to #each");var i=e.fn,o=e.inverse,s=0,l="",c=void 0,u=void 0;if(e.data&&e.ids&&(u=a.appendContextPath(e.data.contextPath,e.ids[0])+"."),a.isFunction(t)&&(t=t.call(this)),e.data&&(c=a.createFrame(e.data)),t&&"object"==typeof t)if(a.isArray(t))for(var h=t.length;h>s;s++)s in t&&n(s,s,s===t.length-1);else{var d=void 0;for(var p in t)t.hasOwnProperty(p)&&(void 0!==d&&n(d,s-1),d=p,s++);void 0!==d&&n(d,s-1,!0)}return 0===s&&(l=o(this)),l})},e.exports=n["default"]},{"../exception":347,"../utils":360}],351:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0;var a=t("../exception"),o=i(a);n["default"]=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=n["default"]},{"../exception":347}],352:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../utils");n["default"]=function(t){t.registerHelper("if",function(t,e){return i.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||i.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})})},e.exports=n["default"]},{"../utils":360}],353:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]=function(t){t.registerHelper("log",function(){for(var e=[void 0],n=arguments[arguments.length-1],i=0;i<arguments.length-1;i++)e.push(arguments[i]);var a=1;null!=n.hash.level?a=n.hash.level:n.data&&null!=n.data.level&&(a=n.data.level),e[0]=a,t.log.apply(t,e)})},e.exports=n["default"]},{}],354:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},e.exports=n["default"]},{}],355:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../utils");n["default"]=function(t){t.registerHelper("with",function(t,e){i.isFunction(t)&&(t=t.call(this));var n=e.fn;if(i.isEmpty(t))return e.inverse(this);var a=e.data;return e.data&&e.ids&&(a=i.createFrame(e.data),a.contextPath=i.appendContextPath(e.data.contextPath,e.ids[0])),n(t,{data:a,blockParams:i.blockParams([t],[a&&a.contextPath])})})},e.exports=n["default"]},{"../utils":360}],356:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./utils"),a={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=i.indexOf(a.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=a.lookupLevel(t),"undefined"!=typeof console&&a.lookupLevel(a.level)<=t){var e=a.methodMap[t];console[e]||(e="log");for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;n>o;o++)i[o-1]=arguments[o];console[e].apply(console,i)}}};n["default"]=a,e.exports=n["default"]},{"./utils":360}],357:[function(t,e,n){(function(t){"use strict";n.__esModule=!0,n["default"]=function(e){var n="undefined"!=typeof t?t:window,i=n.Handlebars;e.noConflict=function(){return n.Handlebars===e&&(n.Handlebars=i),e}},e.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],358:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){var e=t&&t[0]||1,n=v.COMPILER_REVISION;if(e!==n){if(n>e){var i=v.REVISION_CHANGES[n],a=v.REVISION_CHANGES[e];throw new g["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+a+").")}throw new g["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){function n(n,i,a){a.hash&&(i=f.extend({},i,a.hash),a.ids&&(a.ids[0]=!0)),n=e.VM.resolvePartial.call(this,n,i,a);var o=e.VM.invokePartial.call(this,n,i,a);if(null==o&&e.compile&&(a.partials[a.name]=e.compile(n,t.compilerOptions,e),o=a.partials[a.name](i,a)),null!=o){if(a.indent){for(var r=o.split("\n"),s=0,l=r.length;l>s&&(r[s]||s+1!==l);s++)r[s]=a.indent+r[s];o=r.join("\n")}return o}throw new g["default"]("The partial "+a.name+" could not be compiled when running in runtime-only mode")}function i(e){function n(e){return""+t.main(a,e,a.helpers,a.partials,r,l,s)}var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=o.data;i._setup(o),!o.partial&&t.useData&&(r=h(e,r));var s=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(s=o.depths?e!==o.depths[0]?[e].concat(o.depths):o.depths:[e]),(n=d(t.main,n,a,o.depths||[],r,l))(e,o)}if(!e)throw new g["default"]("No environment passed to template");if(!t||!t.main)throw new g["default"]("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var a={strict:function(t,e){if(!(e in t))throw new g["default"]('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,i=0;n>i;i++)if(t[i]&&null!=t[i][e])return t[i][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,invokePartial:n,fn:function(e){var n=t[e];return n.decorator=t[e+"_d"],n},programs:[],program:function(t,e,n,i,a){var o=this.programs[t],r=this.fn(t);return e||a||i||n?o=s(this,t,r,e,n,i,a):o||(o=this.programs[t]=s(this,t,r)),o},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=f.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler};return i.isTop=!0,i._setup=function(n){n.partial?(a.helpers=n.helpers,a.partials=n.partials,a.decorators=n.decorators):(a.helpers=a.merge(n.helpers,e.helpers),t.usePartial&&(a.partials=a.merge(n.partials,e.partials)),(t.usePartial||t.useDecorators)&&(a.decorators=a.merge(n.decorators,e.decorators)))},i._child=function(e,n,i,o){if(t.useBlockParams&&!i)throw new g["default"]("must pass block params");if(t.useDepths&&!o)throw new g["default"]("must pass parent depths");return s(a,e,t[e],n,0,i,o)},i}function s(t,e,n,i,a,o,r){function s(e){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=r;return r&&e!==r[0]&&(s=[e].concat(r)),n(t,e,t.helpers,t.partials,a.data||i,o&&[a.blockParams].concat(o),s)}return s=d(n,s,t,r,i,o),s.program=e,s.depth=r?r.length:0,s.blockParams=a||0,s}function l(t,e,n){return t?t.call||n.name||(n.name=t,t=n.partials[t]):t="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name],t}function c(t,e,n){n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;if(n.fn&&n.fn!==u&&(n.data=v.createFrame(n.data),i=n.data["partial-block"]=n.fn,i.partials&&(n.partials=f.extend({},n.partials,i.partials))),void 0===t&&i&&(t=i),void 0===t)throw new g["default"]("The partial "+n.name+" could not be found");return t instanceof Function?t(e,n):void 0}function u(){return""}function h(t,e){return e&&"root"in e||(e=e?v.createFrame(e):{},e.root=t),e}function d(t,e,n,i,a,o){if(t.decorator){var r={};e=t.decorator(e,r,n,i&&i[0],a,o,i),f.extend(e,r)}return e}n.__esModule=!0,n.checkRevision=o,n.template=r,n.wrapProgram=s,n.resolvePartial=l,n.invokePartial=c,n.noop=u;var p=t("./utils"),f=a(p),m=t("./exception"),g=i(m),v=t("./base")},{"./base":334,"./exception":347,"./utils":360}],359:[function(t,e,n){"use strict";function i(t){this.string=t}n.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},n["default"]=i,e.exports=n["default"]},{}],360:[function(t,e,n){"use strict";function i(t){return h[t]}function a(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function o(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1}function r(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return p.test(t)?t.replace(d,i):t}function s(t){return t||0===t?g(t)&&0===t.length?!0:!1:!0}function l(t){var e=a({},t);return e._parent=t,e}function c(t,e){return t.path=e,t}function u(t,e){return(t?t+".":"")+e}n.__esModule=!0,n.extend=a,n.indexOf=o,n.escapeExpression=r,n.isEmpty=s,n.createFrame=l,n.blockParams=c,n.appendContextPath=u;var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},d=/[&<>"'`=]/g,p=/[&<>"'`=]/,f=Object.prototype.toString;n.toString=f;var m=function(t){return"function"==typeof t};m(/x/)&&(n.isFunction=m=function(t){return"function"==typeof t&&"[object Function]"===f.call(t)}),n.isFunction=m;var g=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===f.call(t):!1};n.isArray=g},{}],361:[function(t,e,n){function i(e,n){var i=t("fs"),o=i.readFileSync(n,"utf8");e.exports=a.compile(o)}var a=t("../dist/cjs/handlebars")["default"],o=t("../dist/cjs/handlebars/compiler/printer");a.PrintVisitor=o.PrintVisitor,a.print=o.print,e.exports=a,"undefined"!=typeof t&&t.extensions&&(t.extensions[".handlebars"]=i,t.extensions[".hbs"]=i)},{"../dist/cjs/handlebars":332,"../dist/cjs/handlebars/compiler/printer":342,fs:329}],362:[function(t,e,n){n.SourceMapGenerator=t("./source-map/source-map-generator").SourceMapGenerator,n.SourceMapConsumer=t("./source-map/source-map-consumer").SourceMapConsumer,n.SourceNode=t("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":369,"./source-map/source-map-generator":370,"./source-map/source-node":371}],363:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(){this._array=[],this._set={}}var a=t("./util");i.fromArray=function(t,e){for(var n=new i,a=0,o=t.length;o>a;a++)n.add(t[a],e);return n},i.prototype.size=function(){return Object.getOwnPropertyNames(this._set).length},i.prototype.add=function(t,e){var n=this.has(t),i=this._array.length;(!n||e)&&this._array.push(t),n||(this._set[a.toSetString(t)]=i)},i.prototype.has=function(t){return Object.prototype.hasOwnProperty.call(this._set,a.toSetString(t))},i.prototype.indexOf=function(t){if(this.has(t))return this._set[a.toSetString(t)];throw new Error('"'+t+'" is not in the set.')},i.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)},i.prototype.toArray=function(){return this._array.slice()},e.ArraySet=i})},{"./util":372,amdefine:373}],364:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t){return 0>t?(-t<<1)+1:(t<<1)+0}function a(t){var e=1===(1&t),n=t>>1;return e?-n:n}var o=t("./base64"),r=5,s=1<<r,l=s-1,c=s;e.encode=function(t){var e,n="",a=i(t);do e=a&l,a>>>=r,a>0&&(e|=c),n+=o.encode(e);while(a>0);return n},e.decode=function(t,e,n){var i,s,u=t.length,h=0,d=0;do{if(e>=u)throw new Error("Expected more digits in base 64 VLQ value.");if(s=o.decode(t.charCodeAt(e++)),-1===s)throw new Error("Invalid base64 digit: "+t.charAt(e-1));i=!!(s&c),s&=l,h+=s<<d,d+=r}while(i);n.value=a(h),n.rest=e}})},{"./base64":365,amdefine:373}],365:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");e.encode=function(t){if(t>=0&&t<i.length)return i[t];throw new TypeError("Must be between 0 and 63: "+aNumber)},e.decode=function(t){var e=65,n=90,i=97,a=122,o=48,r=57,s=43,l=47,c=26,u=52;return t>=e&&n>=t?t-e:t>=i&&a>=t?t-i+c:t>=o&&r>=t?t-o+u:t==s?62:t==l?63:-1}})},{amdefine:373}],366:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t,n,a,o,r,s){var l=Math.floor((n-t)/2)+t,c=r(a,o[l],!0);return 0===c?l:c>0?n-l>1?i(l,n,a,o,r,s):s==e.LEAST_UPPER_BOUND?n<o.length?n:-1:l:l-t>1?i(t,l,a,o,r,s):s==e.LEAST_UPPER_BOUND?l:0>t?-1:t}e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2,e.search=function(t,n,a,o){if(0===n.length)return-1;var r=i(-1,n.length,t,n,a,o||e.GREATEST_LOWER_BOUND);if(0>r)return-1;for(;r-1>=0&&0===a(n[r],n[r-1],!0);)--r;return r}})},{amdefine:373}],367:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t,e){
var n=t.generatedLine,i=e.generatedLine,a=t.generatedColumn,r=e.generatedColumn;return i>n||i==n&&r>=a||o.compareByGeneratedPositionsInflated(t,e)<=0}function a(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}var o=t("./util");a.prototype.unsortedForEach=function(t,e){this._array.forEach(t,e)},a.prototype.add=function(t){i(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))},a.prototype.toArray=function(){return this._sorted||(this._array.sort(o.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},e.MappingList=a})},{"./util":372,amdefine:373}],368:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function a(t,e){return Math.round(t+Math.random()*(e-t))}function o(t,e,n,r){if(r>n){var s=a(n,r),l=n-1;i(t,s,r);for(var c=t[r],u=n;r>u;u++)e(t[u],c)<=0&&(l+=1,i(t,l,u));i(t,l+1,u);var h=l+1;o(t,e,n,h-1),o(t,e,h+1,r)}}e.quickSort=function(t,e){o(t,e,0,t.length-1)}})},{amdefine:373}],369:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t){var e=t;return"string"==typeof t&&(e=JSON.parse(t.replace(/^\)\]\}'/,""))),null!=e.sections?new r(e):new a(e)}function a(t){var e=t;"string"==typeof t&&(e=JSON.parse(t.replace(/^\)\]\}'/,"")));var n=s.getArg(e,"version"),i=s.getArg(e,"sources"),a=s.getArg(e,"names",[]),o=s.getArg(e,"sourceRoot",null),r=s.getArg(e,"sourcesContent",null),l=s.getArg(e,"mappings"),u=s.getArg(e,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);i=i.map(s.normalize),this._names=c.fromArray(a,!0),this._sources=c.fromArray(i,!0),this.sourceRoot=o,this.sourcesContent=r,this._mappings=l,this.file=u}function o(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function r(t){var e=t;"string"==typeof t&&(e=JSON.parse(t.replace(/^\)\]\}'/,"")));var n=s.getArg(e,"version"),a=s.getArg(e,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new c,this._names=new c;var o={line:-1,column:0};this._sections=a.map(function(t){if(t.url)throw new Error("Support for url field in sections not implemented.");var e=s.getArg(t,"offset"),n=s.getArg(e,"line"),a=s.getArg(e,"column");if(n<o.line||n===o.line&&a<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=e,{generatedOffset:{generatedLine:n+1,generatedColumn:a+1},consumer:new i(s.getArg(t,"map"))}})}var s=t("./util"),l=t("./binary-search"),c=t("./array-set").ArraySet,u=t("./base64-vlq"),h=t("./quick-sort").quickSort;i.fromSourceMap=function(t){return a.fromSourceMap(t)},i.prototype._version=3,i.prototype.__generatedMappings=null,Object.defineProperty(i.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),i.prototype.__originalMappings=null,Object.defineProperty(i.prototype,"_originalMappings",{get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),i.prototype._charIsMappingSeparator=function(t,e){var n=t.charAt(e);return";"===n||","===n},i.prototype._parseMappings=function(t,e){throw new Error("Subclasses must implement _parseMappings")},i.GENERATED_ORDER=1,i.ORIGINAL_ORDER=2,i.GREATEST_LOWER_BOUND=1,i.LEAST_UPPER_BOUND=2,i.prototype.eachMapping=function(t,e,n){var a,o=e||null,r=n||i.GENERATED_ORDER;switch(r){case i.GENERATED_ORDER:a=this._generatedMappings;break;case i.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var l=this.sourceRoot;a.map(function(t){var e=null===t.source?null:this._sources.at(t.source);return null!=e&&null!=l&&(e=s.join(l,e)),{source:e,generatedLine:t.generatedLine,generatedColumn:t.generatedColumn,originalLine:t.originalLine,originalColumn:t.originalColumn,name:null===t.name?null:this._names.at(t.name)}},this).forEach(t,o)},i.prototype.allGeneratedPositionsFor=function(t){var e=s.getArg(t,"line"),n={source:s.getArg(t,"source"),originalLine:e,originalColumn:s.getArg(t,"column",0)};if(null!=this.sourceRoot&&(n.source=s.relative(this.sourceRoot,n.source)),!this._sources.has(n.source))return[];n.source=this._sources.indexOf(n.source);var i=[],a=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",s.compareByOriginalPositions,l.LEAST_UPPER_BOUND);if(a>=0){var o=this._originalMappings[a];if(void 0===t.column)for(var r=o.originalLine;o&&o.originalLine===r;)i.push({line:s.getArg(o,"generatedLine",null),column:s.getArg(o,"generatedColumn",null),lastColumn:s.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++a];else for(var c=o.originalColumn;o&&o.originalLine===e&&o.originalColumn==c;)i.push({line:s.getArg(o,"generatedLine",null),column:s.getArg(o,"generatedColumn",null),lastColumn:s.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++a]}return i},e.SourceMapConsumer=i,a.prototype=Object.create(i.prototype),a.prototype.consumer=i,a.fromSourceMap=function(t){var e=Object.create(a.prototype),n=e._names=c.fromArray(t._names.toArray(),!0),i=e._sources=c.fromArray(t._sources.toArray(),!0);e.sourceRoot=t._sourceRoot,e.sourcesContent=t._generateSourcesContent(e._sources.toArray(),e.sourceRoot),e.file=t._file;for(var r=t._mappings.toArray().slice(),l=e.__generatedMappings=[],u=e.__originalMappings=[],d=0,p=r.length;p>d;d++){var f=r[d],m=new o;m.generatedLine=f.generatedLine,m.generatedColumn=f.generatedColumn,f.source&&(m.source=i.indexOf(f.source),m.originalLine=f.originalLine,m.originalColumn=f.originalColumn,f.name&&(m.name=n.indexOf(f.name)),u.push(m)),l.push(m)}return h(e.__originalMappings,s.compareByOriginalPositions),e},a.prototype._version=3,Object.defineProperty(a.prototype,"sources",{get:function(){return this._sources.toArray().map(function(t){return null!=this.sourceRoot?s.join(this.sourceRoot,t):t},this)}}),a.prototype._parseMappings=function(t,e){for(var n,i,a,r,l,c=1,d=0,p=0,f=0,m=0,g=0,v=t.length,b=0,y={},_={},w=[],x=[];v>b;)if(";"===t.charAt(b))c++,b++,d=0;else if(","===t.charAt(b))b++;else{for(n=new o,n.generatedLine=c,r=b;v>r&&!this._charIsMappingSeparator(t,r);r++);if(i=t.slice(b,r),a=y[i])b+=i.length;else{for(a=[];r>b;)u.decode(t,b,_),l=_.value,b=_.rest,a.push(l);if(2===a.length)throw new Error("Found a source, but no line and column");if(3===a.length)throw new Error("Found a source and line, but no column");y[i]=a}n.generatedColumn=d+a[0],d=n.generatedColumn,a.length>1&&(n.source=m+a[1],m+=a[1],n.originalLine=p+a[2],p=n.originalLine,n.originalLine+=1,n.originalColumn=f+a[3],f=n.originalColumn,a.length>4&&(n.name=g+a[4],g+=a[4])),x.push(n),"number"==typeof n.originalLine&&w.push(n)}h(x,s.compareByGeneratedPositionsDeflated),this.__generatedMappings=x,h(w,s.compareByOriginalPositions),this.__originalMappings=w},a.prototype._findMapping=function(t,e,n,i,a,o){if(t[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[n]);if(t[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[i]);return l.search(t,e,a,o)},a.prototype.computeColumnSpans=function(){for(var t=0;t<this._generatedMappings.length;++t){var e=this._generatedMappings[t];if(t+1<this._generatedMappings.length){var n=this._generatedMappings[t+1];if(e.generatedLine===n.generatedLine){e.lastGeneratedColumn=n.generatedColumn-1;continue}}e.lastGeneratedColumn=1/0}},a.prototype.originalPositionFor=function(t){var e={generatedLine:s.getArg(t,"line"),generatedColumn:s.getArg(t,"column")},n=this._findMapping(e,this._generatedMappings,"generatedLine","generatedColumn",s.compareByGeneratedPositionsDeflated,s.getArg(t,"bias",i.GREATEST_LOWER_BOUND));if(n>=0){var a=this._generatedMappings[n];if(a.generatedLine===e.generatedLine){var o=s.getArg(a,"source",null);null!==o&&(o=this._sources.at(o),null!=this.sourceRoot&&(o=s.join(this.sourceRoot,o)));var r=s.getArg(a,"name",null);return null!==r&&(r=this._names.at(r)),{source:o,line:s.getArg(a,"originalLine",null),column:s.getArg(a,"originalColumn",null),name:r}}}return{source:null,line:null,column:null,name:null}},a.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return null==t}):!1},a.prototype.sourceContentFor=function(t,e){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(t=s.relative(this.sourceRoot,t)),this._sources.has(t))return this.sourcesContent[this._sources.indexOf(t)];var n;if(null!=this.sourceRoot&&(n=s.urlParse(this.sourceRoot))){var i=t.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!n.path||"/"==n.path)&&this._sources.has("/"+t))return this.sourcesContent[this._sources.indexOf("/"+t)]}if(e)return null;throw new Error('"'+t+'" is not in the SourceMap.')},a.prototype.generatedPositionFor=function(t){var e=s.getArg(t,"source");if(null!=this.sourceRoot&&(e=s.relative(this.sourceRoot,e)),!this._sources.has(e))return{line:null,column:null,lastColumn:null};e=this._sources.indexOf(e);var n={source:e,originalLine:s.getArg(t,"line"),originalColumn:s.getArg(t,"column")},a=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",s.compareByOriginalPositions,s.getArg(t,"bias",i.GREATEST_LOWER_BOUND));if(a>=0){var o=this._originalMappings[a];if(o.source===n.source)return{line:s.getArg(o,"generatedLine",null),column:s.getArg(o,"generatedColumn",null),lastColumn:s.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},e.BasicSourceMapConsumer=a,r.prototype=Object.create(i.prototype),r.prototype.constructor=i,r.prototype._version=3,Object.defineProperty(r.prototype,"sources",{get:function(){for(var t=[],e=0;e<this._sections.length;e++)for(var n=0;n<this._sections[e].consumer.sources.length;n++)t.push(this._sections[e].consumer.sources[n]);return t}}),r.prototype.originalPositionFor=function(t){var e={generatedLine:s.getArg(t,"line"),generatedColumn:s.getArg(t,"column")},n=l.search(e,this._sections,function(t,e){var n=t.generatedLine-e.generatedOffset.generatedLine;return n?n:t.generatedColumn-e.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:e.generatedLine-(i.generatedOffset.generatedLine-1),column:e.generatedColumn-(i.generatedOffset.generatedLine===e.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}},r.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})},r.prototype.sourceContentFor=function(t,e){for(var n=0;n<this._sections.length;n++){var i=this._sections[n],a=i.consumer.sourceContentFor(t,!0);if(a)return a}if(e)return null;throw new Error('"'+t+'" is not in the SourceMap.')},r.prototype.generatedPositionFor=function(t){for(var e=0;e<this._sections.length;e++){var n=this._sections[e];if(-1!==n.consumer.sources.indexOf(s.getArg(t,"source"))){var i=n.consumer.generatedPositionFor(t);if(i){var a={line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)};return a}}}return{line:null,column:null}},r.prototype._parseMappings=function(t,e){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],a=i.consumer._generatedMappings,o=0;o<a.length;o++){var r=a[n],l=i.consumer._sources.at(r.source);null!==i.consumer.sourceRoot&&(l=s.join(i.consumer.sourceRoot,l)),this._sources.add(l),l=this._sources.indexOf(l);var c=i.consumer._names.at(r.name);this._names.add(c),c=this._names.indexOf(c);var u={source:l,generatedLine:r.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:r.column+(i.generatedOffset.generatedLine===r.generatedLine)?i.generatedOffset.generatedColumn-1:0,originalLine:r.originalLine,originalColumn:r.originalColumn,name:c};this.__generatedMappings.push(u),"number"==typeof u.originalLine&&this.__originalMappings.push(u)}h(this.__generatedMappings,s.compareByGeneratedPositionsDeflated),h(this.__originalMappings,s.compareByOriginalPositions)},e.IndexedSourceMapConsumer=r})},{"./array-set":363,"./base64-vlq":364,"./binary-search":366,"./quick-sort":368,"./util":372,amdefine:373}],370:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t){t||(t={}),this._file=o.getArg(t,"file",null),this._sourceRoot=o.getArg(t,"sourceRoot",null),this._skipValidation=o.getArg(t,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new s,this._sourcesContents=null}var a=t("./base64-vlq"),o=t("./util"),r=t("./array-set").ArraySet,s=t("./mapping-list").MappingList;i.prototype._version=3,i.fromSourceMap=function(t){var e=t.sourceRoot,n=new i({file:t.file,sourceRoot:e});return t.eachMapping(function(t){var i={generated:{line:t.generatedLine,column:t.generatedColumn}};null!=t.source&&(i.source=t.source,null!=e&&(i.source=o.relative(e,i.source)),i.original={line:t.originalLine,column:t.originalColumn},null!=t.name&&(i.name=t.name)),n.addMapping(i)}),t.sources.forEach(function(e){var i=t.sourceContentFor(e);null!=i&&n.setSourceContent(e,i)}),n},i.prototype.addMapping=function(t){var e=o.getArg(t,"generated"),n=o.getArg(t,"original",null),i=o.getArg(t,"source",null),a=o.getArg(t,"name",null);this._skipValidation||this._validateMapping(e,n,i,a),null==i||this._sources.has(i)||this._sources.add(i),null==a||this._names.has(a)||this._names.add(a),this._mappings.add({generatedLine:e.line,generatedColumn:e.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:i,name:a})},i.prototype.setSourceContent=function(t,e){var n=t;null!=this._sourceRoot&&(n=o.relative(this._sourceRoot,n)),null!=e?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[o.toSetString(n)]=e):this._sourcesContents&&(delete this._sourcesContents[o.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},i.prototype.applySourceMap=function(t,e,n){var i=e;if(null==e){if(null==t.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');i=t.file}var a=this._sourceRoot;null!=a&&(i=o.relative(a,i));var s=new r,l=new r;this._mappings.unsortedForEach(function(e){if(e.source===i&&null!=e.originalLine){var r=t.originalPositionFor({line:e.originalLine,column:e.originalColumn});null!=r.source&&(e.source=r.source,null!=n&&(e.source=o.join(n,e.source)),null!=a&&(e.source=o.relative(a,e.source)),e.originalLine=r.line,e.originalColumn=r.column,null!=r.name&&(e.name=r.name))}var c=e.source;null==c||s.has(c)||s.add(c);var u=e.name;null==u||l.has(u)||l.add(u)},this),this._sources=s,this._names=l,t.sources.forEach(function(e){var i=t.sourceContentFor(e);null!=i&&(null!=n&&(e=o.join(n,e)),null!=a&&(e=o.relative(a,e)),this.setSourceContent(e,i))},this)},i.prototype._validateMapping=function(t,e,n,i){if((!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0)||e||n||i)&&!(t&&"line"in t&&"column"in t&&e&&"line"in e&&"column"in e&&t.line>0&&t.column>=0&&e.line>0&&e.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:t,source:n,original:e,name:i}))},i.prototype._serializeMappings=function(){for(var t,e=0,n=1,i=0,r=0,s=0,l=0,c="",u=this._mappings.toArray(),h=0,d=u.length;d>h;h++){if(t=u[h],t.generatedLine!==n)for(e=0;t.generatedLine!==n;)c+=";",n++;else if(h>0){if(!o.compareByGeneratedPositionsInflated(t,u[h-1]))continue;c+=","}c+=a.encode(t.generatedColumn-e),e=t.generatedColumn,null!=t.source&&(c+=a.encode(this._sources.indexOf(t.source)-l),l=this._sources.indexOf(t.source),c+=a.encode(t.originalLine-1-r),r=t.originalLine-1,c+=a.encode(t.originalColumn-i),i=t.originalColumn,null!=t.name&&(c+=a.encode(this._names.indexOf(t.name)-s),s=this._names.indexOf(t.name)))}return c},i.prototype._generateSourcesContent=function(t,e){return t.map(function(t){if(!this._sourcesContents)return null;null!=e&&(t=o.relative(e,t));var n=o.toSetString(t);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)},i.prototype.toJSON=function(){var t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(t.file=this._file),null!=this._sourceRoot&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t},i.prototype.toString=function(){return JSON.stringify(this.toJSON())},e.SourceMapGenerator=i})},{"./array-set":363,"./base64-vlq":364,"./mapping-list":367,"./util":372,amdefine:373}],371:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t,e,n,i,a){this.children=[],this.sourceContents={},this.line=null==t?null:t,this.column=null==e?null:e,this.source=null==n?null:n,this.name=null==a?null:a,this[l]=!0,null!=i&&this.add(i)}var a=t("./source-map-generator").SourceMapGenerator,o=t("./util"),r=/(\r?\n)/,s=10,l="$$$isSourceNode$$$";i.fromStringWithSourceMap=function(t,e,n){function a(t,e){if(null===t||void 0===t.source)s.add(e);else{var a=n?o.join(n,t.source):t.source;s.add(new i(t.originalLine,t.originalColumn,a,e,t.name))}}var s=new i,l=t.split(r),c=function(){var t=l.shift(),e=l.shift()||"";return t+e},u=1,h=0,d=null;return e.eachMapping(function(t){if(null!==d){if(!(u<t.generatedLine)){var e=l[0],n=e.substr(0,t.generatedColumn-h);return l[0]=e.substr(t.generatedColumn-h),h=t.generatedColumn,a(d,n),void(d=t)}var n="";a(d,c()),u++,h=0}for(;u<t.generatedLine;)s.add(c()),u++;if(h<t.generatedColumn){var e=l[0];s.add(e.substr(0,t.generatedColumn)),l[0]=e.substr(t.generatedColumn),h=t.generatedColumn}d=t},this),l.length>0&&(d&&a(d,c()),s.add(l.join(""))),e.sources.forEach(function(t){var i=e.sourceContentFor(t);null!=i&&(null!=n&&(t=o.join(n,t)),s.setSourceContent(t,i))}),s},i.prototype.add=function(t){if(Array.isArray(t))t.forEach(function(t){this.add(t)},this);else{if(!t[l]&&"string"!=typeof t)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);t&&this.children.push(t)}return this},i.prototype.prepend=function(t){if(Array.isArray(t))for(var e=t.length-1;e>=0;e--)this.prepend(t[e]);else{if(!t[l]&&"string"!=typeof t)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);this.children.unshift(t)}return this},i.prototype.walk=function(t){for(var e,n=0,i=this.children.length;i>n;n++)e=this.children[n],e[l]?e.walk(t):""!==e&&t(e,{source:this.source,line:this.line,column:this.column,name:this.name})},i.prototype.join=function(t){var e,n,i=this.children.length;if(i>0){for(e=[],n=0;i-1>n;n++)e.push(this.children[n]),e.push(t);e.push(this.children[n]),this.children=e}return this},i.prototype.replaceRight=function(t,e){var n=this.children[this.children.length-1];return n[l]?n.replaceRight(t,e):"string"==typeof n?this.children[this.children.length-1]=n.replace(t,e):this.children.push("".replace(t,e)),this},i.prototype.setSourceContent=function(t,e){this.sourceContents[o.toSetString(t)]=e},i.prototype.walkSourceContents=function(t){for(var e=0,n=this.children.length;n>e;e++)this.children[e][l]&&this.children[e].walkSourceContents(t);for(var i=Object.keys(this.sourceContents),e=0,n=i.length;n>e;e++)t(o.fromSetString(i[e]),this.sourceContents[i[e]])},i.prototype.toString=function(){var t="";return this.walk(function(e){t+=e}),t},i.prototype.toStringWithSourceMap=function(t){var e={code:"",line:1,column:0},n=new a(t),i=!1,o=null,r=null,l=null,c=null;return this.walk(function(t,a){e.code+=t,null!==a.source&&null!==a.line&&null!==a.column?((o!==a.source||r!==a.line||l!==a.column||c!==a.name)&&n.addMapping({source:a.source,original:{line:a.line,column:a.column},generated:{line:e.line,column:e.column},name:a.name}),o=a.source,r=a.line,l=a.column,c=a.name,i=!0):i&&(n.addMapping({generated:{line:e.line,column:e.column}}),o=null,i=!1);for(var u=0,h=t.length;h>u;u++)t.charCodeAt(u)===s?(e.line++,e.column=0,u+1===h?(o=null,i=!1):i&&n.addMapping({source:a.source,original:{line:a.line,column:a.column},generated:{line:e.line,column:e.column},name:a.name})):e.column++}),this.walkSourceContents(function(t,e){n.setSourceContent(t,e)}),{code:e.code,map:n}},e.SourceNode=i})},{"./source-map-generator":370,"./util":372,amdefine:373}],372:[function(t,e,n){if("function"!=typeof i)var i=t("amdefine")(e,t);i(function(t,e,n){function i(t,e,n){if(e in t)return t[e];if(3===arguments.length)return n;throw new Error('"'+e+'" is a required argument.')}function a(t){var e=t.match(m);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}function o(t){var e="";return t.scheme&&(e+=t.scheme+":"),e+="//",t.auth&&(e+=t.auth+"@"),t.host&&(e+=t.host),t.port&&(e+=":"+t.port),t.path&&(e+=t.path),e}function r(t){var e=t,n=a(t);if(n){if(!n.path)return t;e=n.path}for(var i,r="/"===e.charAt(0),s=e.split(/\/+/),l=0,c=s.length-1;c>=0;c--)i=s[c],"."===i?s.splice(c,1):".."===i?l++:l>0&&(""===i?(s.splice(c+1,l),l=0):(s.splice(c,2),l--));return e=s.join("/"),""===e&&(e=r?"/":"."),n?(n.path=e,o(n)):e}function s(t,e){""===t&&(t="."),""===e&&(e=".");var n=a(e),i=a(t);if(i&&(t=i.path||"/"),n&&!n.scheme)return i&&(n.scheme=i.scheme),o(n);if(n||e.match(g))return e;if(i&&!i.host&&!i.path)return i.host=e,o(i);var s="/"===e.charAt(0)?e:r(t.replace(/\/+$/,"")+"/"+e);return i?(i.path=s,o(i)):s}function l(t,e){""===t&&(t="."),t=t.replace(/\/$/,"");for(var n=0;0!==e.indexOf(t+"/");){var i=t.lastIndexOf("/");if(0>i)return e;if(t=t.slice(0,i),t.match(/^([^\/]+:\/)?\/*$/))return e;++n}return Array(n+1).join("../")+e.substr(t.length+1)}function c(t){return"$"+t}function u(t){return t.substr(1)}function h(t,e,n){var i=t.source-e.source;return 0!==i?i:(i=t.originalLine-e.originalLine,0!==i?i:(i=t.originalColumn-e.originalColumn,0!==i||n?i:(i=t.generatedColumn-e.generatedColumn,0!==i?i:(i=t.generatedLine-e.generatedLine,0!==i?i:t.name-e.name))))}function d(t,e,n){var i=t.generatedLine-e.generatedLine;return 0!==i?i:(i=t.generatedColumn-e.generatedColumn,0!==i||n?i:(i=t.source-e.source,0!==i?i:(i=t.originalLine-e.originalLine,0!==i?i:(i=t.originalColumn-e.originalColumn,0!==i?i:t.name-e.name))))}function p(t,e){return t===e?0:t>e?1:-1}function f(t,e){var n=t.generatedLine-e.generatedLine;return 0!==n?n:(n=t.generatedColumn-e.generatedColumn,0!==n?n:(n=p(t.source,e.source),0!==n?n:(n=t.originalLine-e.originalLine,0!==n?n:(n=t.originalColumn-e.originalColumn,0!==n?n:p(t.name,e.name)))))}e.getArg=i;var m=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,g=/^data:.+\,.+$/;e.urlParse=a,e.urlGenerate=o,e.normalize=r,e.join=s,e.relative=l,e.toSetString=c,e.fromSetString=u,e.compareByOriginalPositions=h,e.compareByGeneratedPositionsDeflated=d,e.compareByGeneratedPositionsInflated=f})},{amdefine:373}],373:[function(t,e,n){(function(n,i){"use strict";function a(e,a){function o(t){var e,n;for(e=0;t[e];e+=1)if(n=t[e],"."===n)t.splice(e,1),e-=1;else if(".."===n){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function r(t,e){var n;return t&&"."===t.charAt(0)&&e&&(n=e.split("/"),n=n.slice(0,n.length-1),n=n.concat(t.split("/")),o(n),t=n.join("/")),t}function s(t){return function(e){return r(e,t)}}function l(t){function e(e){f[t]=e}return e.fromText=function(t,e){throw new Error("amdefine does not implement load.fromText")},e}function c(t,n,o){var r,s,l,c;if(t)s=f[t]={},l={id:t,uri:i,exports:s},r=h(a,s,l,t);else{if(m)throw new Error("amdefine with no module ID cannot be called more than once per file.");m=!0,s=e.exports,l=e,r=h(a,s,l,e.id)}n&&(n=n.map(function(t){return r(t)})),c="function"==typeof o?o.apply(l.exports,n):o,void 0!==c&&(l.exports=c,t&&(f[t]=l.exports))}function u(t,e,n){Array.isArray(t)?(n=e,e=t,t=void 0):"string"!=typeof t&&(n=t,t=e=void 0),e&&!Array.isArray(e)&&(n=e,e=void 0),e||(e=["require","exports","module"]),t?p[t]=[t,e,n]:c(t,e,n)}var h,d,p={},f={},m=!1,g=t("path");return h=function(t,e,i,a){function o(o,r){return"string"==typeof o?d(t,e,i,o,a):(o=o.map(function(n){return d(t,e,i,n,a)}),void(r&&n.nextTick(function(){r.apply(null,o)})))}return o.toUrl=function(t){return 0===t.indexOf(".")?r(t,g.dirname(i.filename)):t},o},a=a||function(){return e.require.apply(e,arguments)},d=function(t,e,n,i,a){var o,u,m=i.indexOf("!"),g=i;if(-1===m){if(i=r(i,a),"require"===i)return h(t,e,n,a);if("exports"===i)return e;if("module"===i)return n;if(f.hasOwnProperty(i))return f[i];if(p[i])return c.apply(null,p[i]),f[i];if(t)return t(g);throw new Error("No module with ID: "+i)}return o=i.substring(0,m),i=i.substring(m+1,i.length),u=d(t,e,n,o,a),i=u.normalize?u.normalize(i,s(a)):r(i,a),f[i]?f[i]:(u.load(i,h(t,e,n,a),l(i),{}),f[i])},u.require=function(t){return f[t]?f[t]:p[t]?(c.apply(null,p[t]),f[t]):void 0},u.amd={},u}e.exports=a}).call(this,t("_process"),"/../../node_modules/handlebars/node_modules/source-map/node_modules/amdefine/amdefine.js")},{_process:331,path:330}],374:[function(t,e,n){e.exports=t("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":333}],375:[function(t,e,n){e.exports=t("handlebars/runtime")["default"]},{"handlebars/runtime":374}]},{},[82]);